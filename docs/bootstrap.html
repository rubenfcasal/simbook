<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.5 Remuestreo Bootstrap | Simulación Estadística</title>
  <meta name="description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="8.5 Remuestreo Bootstrap | Simulación Estadística" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rubenfcasal/simbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.5 Remuestreo Bootstrap | Simulación Estadística" />
  
  <meta name="twitter:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén Fernández Casal (ruben.fcasal@udc.es), Ricardo Cao (rcao@udc.es)" />


<meta name="date" content="2022-09-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="comparación-de-estimadores.html"/>
<link rel="next" href="monte-carlo.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simulación Estadística</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a>
<ul>
<li class="chapter" data-level="1.1" data-path="conceptos-básicos.html"><a href="conceptos-básicos.html"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="conceptos-básicos.html"><a href="conceptos-básicos.html#ventajas-e-inconvenientes-de-la-simulación"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas e inconvenientes de la simulación</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="aplicaciones-de-la-simulación.html"><a href="aplicaciones-de-la-simulación.html"><i class="fa fa-check"></i><b>1.2</b> Aplicaciones de la simulación</a></li>
<li class="chapter" data-level="1.3" data-path="números-aleatorios-puros.html"><a href="números-aleatorios-puros.html"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a></li>
<li class="chapter" data-level="1.4" data-path="generación-de-números-aleatorios-mediante-software.html"><a href="generación-de-números-aleatorios-mediante-software.html"><i class="fa fa-check"></i><b>1.4</b> Generación de números “aleatorios” mediante software</a></li>
<li class="chapter" data-level="1.5" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>1.5</b> Números pseudoaleatorios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rrng.html"><a href="rrng.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="oprrng.html"><a href="oprrng.html"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="paquetes-de-r.html"><a href="paquetes-de-r.html"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gen-pseudo.html"><a href="gen-pseudo.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gen-cong.html"><a href="gen-cong.html"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales lineales</a></li>
<li class="chapter" data-level="3.2" data-path="extensiones.html"><a href="extensiones.html"><i class="fa fa-check"></i><b>3.2</b> Extensiones</a></li>
<li class="chapter" data-level="3.3" data-path="calgen.html"><a href="calgen.html"><i class="fa fa-check"></i><b>3.3</b> Análisis de la calidad de un generador</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="calgen.html"><a href="calgen.html#repetición-de-contrastes"><i class="fa fa-check"></i><b>3.3.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.3.2" data-path="calgen.html"><a href="calgen.html#baterias"><i class="fa fa-check"></i><b>3.3.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>3.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="resultados.html"><a href="resultados.html"><i class="fa fa-check"></i><b>4</b> Análisis de resultados de simulación</a>
<ul>
<li class="chapter" data-level="4.1" data-path="convergencia.html"><a href="convergencia.html"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="convergencia.html"><a href="convergencia.html#detección-de-problemas-de-convergencia"><i class="fa fa-check"></i><b>4.1.1</b> Detección de problemas de convergencia</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="estimación-de-la-precisión.html"><a href="estimación-de-la-precisión.html"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="teorema-central-del-límite.html"><a href="teorema-central-del-límite.html"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="determinación-del-número-de-generaciones.html"><a href="determinación-del-número-de-generaciones.html"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="observaciones.html"><a href="observaciones.html"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sim-con.html"><a href="sim-con.html"><i class="fa fa-check"></i><b>5</b> Simulación de variables continuas</a>
<ul>
<li class="chapter" data-level="5.1" data-path="método-de-inversión.html"><a href="método-de-inversión.html"><i class="fa fa-check"></i><b>5.1</b> Método de inversión</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="método-de-inversión.html"><a href="método-de-inversión.html#algunas-distribuciones-que-pueden-simularse-por-el-método-de-inversión"><i class="fa fa-check"></i><b>5.1.1</b> Algunas distribuciones que pueden simularse por el método de inversión</a></li>
<li class="chapter" data-level="5.1.2" data-path="método-de-inversión.html"><a href="método-de-inversión.html#ventajas-e-inconvenientes"><i class="fa fa-check"></i><b>5.1.2</b> Ventajas e inconvenientes</a></li>
<li class="chapter" data-level="5.1.3" data-path="método-de-inversión.html"><a href="método-de-inversión.html#inversión-aproximada"><i class="fa fa-check"></i><b>5.1.3</b> Inversión aproximada</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>5.2</b> Método de aceptación rechazo</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="AR.html"><a href="AR.html#algoritmo"><i class="fa fa-check"></i><b>5.2.1</b> Algoritmo</a></li>
<li class="chapter" data-level="5.2.2" data-path="AR.html"><a href="AR.html#densidades-acotadas-en-un-intervalo-cerrado"><i class="fa fa-check"></i><b>5.2.2</b> Densidades acotadas en un intervalo cerrado</a></li>
<li class="chapter" data-level="5.2.3" data-path="AR.html"><a href="AR.html#eficiencia-del-algoritmo"><i class="fa fa-check"></i><b>5.2.3</b> Eficiencia del algoritmo</a></li>
<li class="chapter" data-level="5.2.4" data-path="AR.html"><a href="AR.html#elección-de-la-densidad-auxiliar"><i class="fa fa-check"></i><b>5.2.4</b> Elección de la densidad auxiliar</a></li>
<li class="chapter" data-level="5.2.5" data-path="AR.html"><a href="AR.html#bayes-ar"><i class="fa fa-check"></i><b>5.2.5</b> Ejemplo: inferencia bayesiana</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html"><i class="fa fa-check"></i><b>5.3</b> Modificaciones del método de aceptación-rechazo</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html#ars"><i class="fa fa-check"></i><b>5.3.1</b> Muestreo por rechazo adaptativo (ARS)</a></li>
<li class="chapter" data-level="5.3.2" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html#método-del-cociente-de-uniformes"><i class="fa fa-check"></i><b>5.3.2</b> Método del cociente de uniformes</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="composicion.html"><a href="composicion.html"><i class="fa fa-check"></i><b>5.4</b> Método de composición (o de simulación condicional)</a></li>
<li class="chapter" data-level="5.5" data-path="notables-cont.html"><a href="notables-cont.html"><i class="fa fa-check"></i><b>5.5</b> Métodos específicos para la generación de algunas distribuciones notables</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="notables-cont.html"><a href="notables-cont.html#método-de-box-müller"><i class="fa fa-check"></i><b>5.5.1</b> Método de Box-Müller</a></li>
<li class="chapter" data-level="5.5.2" data-path="notables-cont.html"><a href="notables-cont.html#simulación-de-la-distribución-beta"><i class="fa fa-check"></i><b>5.5.2</b> Simulación de la distribución beta</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="discretas.html"><a href="discretas.html"><i class="fa fa-check"></i><b>6</b> Simulación de variables discretas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="transcuant.html"><a href="transcuant.html"><i class="fa fa-check"></i><b>6.1</b> Método de la transformación cuantil</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="transcuant.html"><a href="transcuant.html#eficiencia-del-algoritmo-1"><i class="fa fa-check"></i><b>6.1.1</b> Eficiencia del algoritmo</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="método-de-la-tabla-guía.html"><a href="método-de-la-tabla-guía.html"><i class="fa fa-check"></i><b>6.2</b> Método de la tabla guía</a></li>
<li class="chapter" data-level="6.3" data-path="alias.html"><a href="alias.html"><i class="fa fa-check"></i><b>6.3</b> Método de Alias</a></li>
<li class="chapter" data-level="6.4" data-path="simulación-de-una-variable-discreta-con-dominio-infinito.html"><a href="simulación-de-una-variable-discreta-con-dominio-infinito.html"><i class="fa fa-check"></i><b>6.4</b> Simulación de una variable discreta con dominio infinito</a></li>
<li class="chapter" data-level="6.5" data-path="cálculo-directo-de-la-función-cuantil.html"><a href="cálculo-directo-de-la-función-cuantil.html"><i class="fa fa-check"></i><b>6.5</b> Cálculo directo de la función cuantil</a></li>
<li class="chapter" data-level="6.6" data-path="otros-métodos.html"><a href="otros-métodos.html"><i class="fa fa-check"></i><b>6.6</b> Otros métodos</a></li>
<li class="chapter" data-level="6.7" data-path="notables-disc.html"><a href="notables-disc.html"><i class="fa fa-check"></i><b>6.7</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulación-de-distribuciones-multivariantes.html"><a href="simulación-de-distribuciones-multivariantes.html"><i class="fa fa-check"></i><b>7</b> Simulación de distribuciones multivariantes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulación-de-componentes-independientes.html"><a href="simulación-de-componentes-independientes.html"><i class="fa fa-check"></i><b>7.1</b> Simulación de componentes independientes</a></li>
<li class="chapter" data-level="7.2" data-path="el-método-de-aceptaciónrechazo.html"><a href="el-método-de-aceptaciónrechazo.html"><i class="fa fa-check"></i><b>7.2</b> El método de aceptación/rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="fact-cov.html"><a href="fact-cov.html"><i class="fa fa-check"></i><b>7.3</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="7.4" data-path="distrcond.html"><a href="distrcond.html"><i class="fa fa-check"></i><b>7.4</b> Método de las distribuciones condicionadas</a></li>
<li class="chapter" data-level="7.5" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html"><i class="fa fa-check"></i><b>7.5</b> Simulación condicional e incondicional</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#condnormal"><i class="fa fa-check"></i><b>7.5.1</b> Simulación condicional de una normal multivariante</a></li>
<li class="chapter" data-level="7.5.2" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#simulación-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>7.5.2</b> Simulación condicional a partir de un modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html"><i class="fa fa-check"></i><b>7.6</b> Simulación basada en cópulas</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#cópulas-arquimedianas"><i class="fa fa-check"></i><b>7.6.1</b> Cópulas Arquimedianas</a></li>
<li class="chapter" data-level="7.6.2" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#simulación"><i class="fa fa-check"></i><b>7.6.2</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="mult-discr.html"><a href="mult-discr.html"><i class="fa fa-check"></i><b>7.7</b> Simulación de distribuciones multivariantes discretas</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="mult-discr.html"><a href="mult-discr.html#métodos-de-codificación-o-etiquetado-para-variables-discretas"><i class="fa fa-check"></i><b>7.7.1</b> Métodos de codificación o etiquetado para variables discretas</a></li>
<li class="chapter" data-level="7.7.2" data-path="mult-discr.html"><a href="mult-discr.html#simulación-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>7.7.2</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="7.7.3" data-path="mult-discr.html"><a href="mult-discr.html#simconting"><i class="fa fa-check"></i><b>7.7.3</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="aplic-inf.html"><a href="aplic-inf.html"><i class="fa fa-check"></i><b>8</b> Aplicaciones en Inferencia Estadística</a>
<ul>
<li class="chapter" data-level="8.1" data-path="distribución-en-el-muestreo.html"><a href="distribución-en-el-muestreo.html"><i class="fa fa-check"></i><b>8.1</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="8.2" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>8.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="8.3" data-path="contrastes.html"><a href="contrastes.html"><i class="fa fa-check"></i><b>8.3</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="8.4" data-path="comparación-de-estimadores.html"><a href="comparación-de-estimadores.html"><i class="fa fa-check"></i><b>8.4</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="8.5" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>8.5</b> Remuestreo Bootstrap</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="bootstrap.html"><a href="bootstrap.html#idea"><i class="fa fa-check"></i><b>8.5.1</b> Idea:</a></li>
<li class="chapter" data-level="8.5.2" data-path="bootstrap.html"><a href="bootstrap.html#métodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>8.5.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="8.5.3" data-path="bootstrap.html"><a href="bootstrap.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>8.5.3</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="8.5.4" data-path="bootstrap.html"><a href="bootstrap.html#gráficos"><i class="fa fa-check"></i><b>8.5.4</b> Gráficos</a></li>
<li class="chapter" data-level="8.5.5" data-path="bootstrap.html"><a href="bootstrap.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>8.5.5</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="monte-carlo.html"><a href="monte-carlo.html"><i class="fa fa-check"></i><b>9</b> Integración y Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="integración-monte-carlo-clásica.html"><a href="integración-monte-carlo-clásica.html"><i class="fa fa-check"></i><b>9.1</b> Integración Monte Carlo (clásica)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="integración-monte-carlo-clásica.html"><a href="integración-monte-carlo-clásica.html#caso-general"><i class="fa fa-check"></i><b>9.1.1</b> Caso general</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html"><i class="fa fa-check"></i><b>9.2</b> Muestreo por importancia</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>9.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="optimización-monte-carlo.html"><a href="optimización-monte-carlo.html"><i class="fa fa-check"></i><b>9.3</b> Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="optimización-monte-carlo.html"><a href="optimización-monte-carlo.html#algoritmos-de-optimización-monte-carlo"><i class="fa fa-check"></i><b>9.3.1</b> Algoritmos de optimización Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="temple-simulado.html"><a href="temple-simulado.html"><i class="fa fa-check"></i><b>9.4</b> Temple simulado</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="temple-simulado.html"><a href="temple-simulado.html#algoritmo-1"><i class="fa fa-check"></i><b>9.4.1</b> Algoritmo:</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="algoritmos-genéticos.html"><a href="algoritmos-genéticos.html"><i class="fa fa-check"></i><b>9.5</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="técnicas-de-reducción-de-la-varianza.html"><a href="técnicas-de-reducción-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a>
<ul>
<li class="chapter" data-level="10.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html"><i class="fa fa-check"></i><b>10.1</b> Variables antitéticas</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#ejemplo-integración-monte-carlo"><i class="fa fa-check"></i><b>10.1.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.1.2" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#generación-de-variables-antitéticas"><i class="fa fa-check"></i><b>10.1.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="estratificación.html"><a href="estratificación.html"><i class="fa fa-check"></i><b>10.2</b> Estratificación</a></li>
<li class="chapter" data-level="10.3" data-path="variables-de-control.html"><a href="variables-de-control.html"><i class="fa fa-check"></i><b>10.3</b> Variables de control</a></li>
<li class="chapter" data-level="10.4" data-path="números-aleatorios-comunes.html"><a href="números-aleatorios-comunes.html"><i class="fa fa-check"></i><b>10.4</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.5" data-path="ejercicios-2.html"><a href="ejercicios-2.html"><i class="fa fa-check"></i><b>10.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-básica.html"><a href="bibliografía-básica.html"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html"><i class="fa fa-check"></i>Bibliografía complementaria</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html#libros"><i class="fa fa-check"></i>Libros</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html#artículos"><i class="fa fa-check"></i>Artículos</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>A</b> Enlaces</a></li>
<li class="chapter" data-level="B" data-path="gof-aleat.html"><a href="gof-aleat.html"><i class="fa fa-check"></i><b>B</b> Bondad de Ajuste y Aleatoriedad</a>
<ul>
<li class="chapter" data-level="B.1" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i><b>B.1</b> Métodos de bondad de ajuste</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="gof.html"><a href="gof.html#histograma"><i class="fa fa-check"></i><b>B.1.1</b> Histograma</a></li>
<li class="chapter" data-level="B.1.2" data-path="gof.html"><a href="gof.html#empdistr"><i class="fa fa-check"></i><b>B.1.2</b> Función de distribución empírica</a></li>
<li class="chapter" data-level="B.1.3" data-path="gof.html"><a href="gof.html#gráficos-p-p-y-q-q"><i class="fa fa-check"></i><b>B.1.3</b> Gráficos P-P y Q-Q</a></li>
<li class="chapter" data-level="B.1.4" data-path="gof.html"><a href="gof.html#chi2test"><i class="fa fa-check"></i><b>B.1.4</b> Contraste chi-cuadrado de Pearson</a></li>
<li class="chapter" data-level="B.1.5" data-path="gof.html"><a href="gof.html#ks-test"><i class="fa fa-check"></i><b>B.1.5</b> Contraste de Kolmogorov-Smirnov</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="diag-aleat.html"><a href="diag-aleat.html"><i class="fa fa-check"></i><b>B.2</b> Diagnosis de la independencia</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="diag-aleat.html"><a href="diag-aleat.html#métodos-para-detectar-dependencia"><i class="fa fa-check"></i><b>B.2.1</b> Métodos para detectar dependencia</a></li>
<li class="chapter" data-level="B.2.2" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-secuencial"><i class="fa fa-check"></i><b>B.2.2</b> Gráfico secuencial</a></li>
<li class="chapter" data-level="B.2.3" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-de-dispersion-retardado"><i class="fa fa-check"></i><b>B.2.3</b> Gráfico de dispersion retardado</a></li>
<li class="chapter" data-level="B.2.4" data-path="diag-aleat.html"><a href="diag-aleat.html#el-correlograma"><i class="fa fa-check"></i><b>B.2.4</b> El correlograma</a></li>
<li class="chapter" data-level="B.2.5" data-path="diag-aleat.html"><a href="diag-aleat.html#test-de-rachas"><i class="fa fa-check"></i><b>B.2.5</b> Test de rachas</a></li>
<li class="chapter" data-level="B.2.6" data-path="diag-aleat.html"><a href="diag-aleat.html#el-contraste-de-ljung-box"><i class="fa fa-check"></i><b>B.2.6</b> El contraste de Ljung-Box</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html"><i class="fa fa-check"></i><b>B.3</b> Contrastes específicos para generadores aleatorios</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-frecuencias"><i class="fa fa-check"></i><b>B.3.1</b> Contraste de frecuencias</a></li>
<li class="chapter" data-level="B.3.2" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-series"><i class="fa fa-check"></i><b>B.3.2</b> Contraste de series</a></li>
<li class="chapter" data-level="B.3.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-poker"><i class="fa fa-check"></i><b>B.3.3</b> El contraste del poker</a></li>
<li class="chapter" data-level="B.3.4" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-coleccionista"><i class="fa fa-check"></i><b>B.3.4</b> El contraste del coleccionista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="int-num.html"><a href="int-num.html"><i class="fa fa-check"></i><b>C</b> Integración numérica</a>
<ul>
<li class="chapter" data-level="C.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html"><i class="fa fa-check"></i><b>C.1</b> Integración numérica unidimensional</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#método-del-trapezoide"><i class="fa fa-check"></i><b>C.1.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="C.1.2" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#regla-de-simpson"><i class="fa fa-check"></i><b>C.1.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="C.1.3" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>C.1.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="C.1.4" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#comandos-de-r"><i class="fa fa-check"></i><b>C.1.4</b> Comandos de R</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html"><i class="fa fa-check"></i><b>C.2</b> Integración numérica bidimensional</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#representación-gráfica"><i class="fa fa-check"></i><b>C.2.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="C.2.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#método-del-trapezoide-1"><i class="fa fa-check"></i><b>C.2.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="C.2.3" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#comandos-de-r-1"><i class="fa fa-check"></i><b>C.2.3</b> Comandos de R</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulación Estadística</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bootstrap" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Remuestreo Bootstrap</h2>
<p>El bootstrap es un procedimiento estadístico que sirve para aproximar características de la distribución en el muestreo de un estadístico.
Para ello se emplea (normalmente) simulación, generando un gran número de muestras mediante algún tipo de remuestreo de la muestra original.
Su ventaja principal es que no requiere hipótesis sobre el mecanismo generador de los datos.</p>
<p>En esta sección se incluye una breve introducción al bootstrap.
Para información adicional ver por ejemplo Davison y Hinkley (1997) o <a href="https://rubenfcasal.github.io/book_remuestreo">Cao y Fernández-Casal (2020)</a>.</p>
<div id="idea" class="section level3" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Idea:</h3>
<p>Consideramos un conjunto de datos simulado:</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="bootstrap.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb426-2"><a href="bootstrap.html#cb426-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">50</span>)</span></code></pre></div>
<p>La idea es aproximar características poblacionales por las correspondientes de la distribución empírica de los datos observados:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="bootstrap.html#cb427-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Distribución bootstrap</span></span>
<span id="cb427-2"><a href="bootstrap.html#cb427-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ecdf</span>(data)(x), <span class="at">ylab =</span> <span class="st">&quot;FD&quot;</span>, <span class="at">type =</span> <span class="st">&quot;s&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb427-3"><a href="bootstrap.html#cb427-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución teórica</span></span>
<span id="cb427-4"><a href="bootstrap.html#cb427-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-48-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Las características de la distribución empírica se pueden aproximar mediante simulación.
En el caso i.i.d. esto puede ser implementado mediante remuestreo,
realizando repetidamente muestreo aleatorio con reemplazamiento
del conjunto de datos original (manteniendo el tamaño muestral):</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="bootstrap.html#cb428-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Muestra bootstrap</span></span>
<span id="cb428-2"><a href="bootstrap.html#cb428-2" aria-hidden="true" tabindex="-1"></a>xboot <span class="ot">&lt;-</span> <span class="fu">sample</span>(data, <span class="at">replace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="métodos-de-remuestreo-bootstrap" class="section level3" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> Métodos de remuestreo Bootstrap</h3>
<p>Método de remuestreo (Efron, 1979) utilizado para aproximar
características de la distribución en el muestreo de un estadístico:</p>
<ul>
<li><p>Aproximación del sesgo y de la varianza.</p></li>
<li><p>Construcción de intervalos de confianza</p></li>
<li><p>Realizar contrastes de hipótesis.</p></li>
</ul>
<p>De utilidad cuando no se dispone la distribución exacta, no es
adecuado emplear la distribución asintótica, etc.
La idea es aproximar características poblacionales por las
correspondientes de la distribución empírica de los
datos observados.
En el caso i.i.d. esto puede ser implementado mediante remuestreo,
realizando repetidamente <strong>muestreo aleatorio con reemplazamiento
del conjunto de datos original</strong> (manteniendo el tamaño muestral).</p>
<p>Si <span class="math inline">\(\mathbf{x} = \left( x_{1},x_{2},\cdots ,x_{n}\right) ^{t}\)</span> es una
muestra i.i.d. <span class="math inline">\(F_{\theta }\)</span> y
<span class="math inline">\(\hat{\theta} = T\left( \mathbf{x} \right)\)</span>
es un estimador de <span class="math inline">\(\theta\)</span>.
Para <span class="math inline">\(b = 1,\ldots ,B:\)</span></p>
<ul>
<li><p><span class="math inline">\(\mathbf{x}_{b}^{\ast } = \left( x_{b1}^{\ast },x_{b2}^{\ast },\cdots ,x_{bn}^{\ast }\right) ^{t}\)</span> muestra bootstrap obtenida mediante
muestreo con reemplazamiento de
<span class="math inline">\(\left\{ x_{1},x_{2},\cdots ,x_{n}\right\}\)</span>.</p></li>
<li><p><span class="math inline">\(\hat{\theta}_{b}^{\ast } = T\left( \mathbf{x}_{b}^{\ast }\right)\)</span>
valor del estadístico en la muestra bootstrap.</p></li>
</ul>
<p>La idea original (bootstrap natural, Efron) es que la variabilidad
de <span class="math inline">\(\hat{\theta}_{b}^{\ast }\)</span> en torno a <span class="math inline">\(\hat{\theta}\)</span> aproxima la
variabilidad de <span class="math inline">\(\hat{\theta}\)</span> en torno a <span class="math inline">\(\theta\)</span>:</p>
<ul>
<li><strong>La distribución de</strong> <span class="math inline">\(\hat{\theta}_{b}^{\ast }-\hat{\theta}\)</span>
<strong>aproxima la distribución de</strong> <span class="math inline">\(\hat{\theta}-\theta\)</span>.</li>
</ul>
<p>En general podríamos decir que:</p>
<ul>
<li><strong>la muestra es a la población</strong>
<strong>lo que la muestra bootstrap es a la muestra</strong>.</li>
</ul>
<p><img src="images/bootstrap.png" width="70%" style="display: block; margin: auto;" /></p>

<div class="example">
<span id="exm:mean-median-boot" class="example"><strong>Ejemplo 8.1  (aproximación del sesgo y del error estándar mediante bootstrap)  </strong></span>
</div>
<p>Como ejemplo consideraremos una muestra de tamaño <span class="math inline">\(n=100\)</span> de una normal estándar para tratar de aproximar el sesgo y error estándar de la media y la mediana mediante bootstrap.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="bootstrap.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dat &lt;- dat.sim[, 1]</span></span>
<span id="cb429-2"><a href="bootstrap.html#cb429-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb429-3"><a href="bootstrap.html#cb429-3" aria-hidden="true" tabindex="-1"></a>ndat <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb429-4"><a href="bootstrap.html#cb429-4" aria-hidden="true" tabindex="-1"></a>datmed <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb429-5"><a href="bootstrap.html#cb429-5" aria-hidden="true" tabindex="-1"></a>datsd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb429-6"><a href="bootstrap.html#cb429-6" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(ndat, <span class="at">mean=</span>datmed, <span class="at">sd=</span>datsd)</span></code></pre></div>
<p>Consideramos 1000 réplicas bootstrap:</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="bootstrap.html#cb430-1" aria-hidden="true" tabindex="-1"></a>nboot <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span></code></pre></div>
<p>Es habitual tomar <code>nboot + 1</code> entero múltiplo de 100 e.g. <code>nboot = 999</code> ó <code>1999</code>
(facilita el cálculo de percentiles, orden <code>(nboot + 1)*p</code>)</p>
<p>El valor del estadístico en la muestra es:</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="bootstrap.html#cb431-1" aria-hidden="true" tabindex="-1"></a>stat.dat <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat)</span></code></pre></div>
<p>Generamos las réplicas bootstrap:</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="bootstrap.html#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb432-2"><a href="bootstrap.html#cb432-2" aria-hidden="true" tabindex="-1"></a>stat.boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nboot)</span>
<span id="cb432-3"><a href="bootstrap.html#cb432-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nboot) {</span>
<span id="cb432-4"><a href="bootstrap.html#cb432-4" aria-hidden="true" tabindex="-1"></a>  dat.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(dat, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb432-5"><a href="bootstrap.html#cb432-5" aria-hidden="true" tabindex="-1"></a>  stat.boot[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat.boot)</span>
<span id="cb432-6"><a href="bootstrap.html#cb432-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb432-7"><a href="bootstrap.html#cb432-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor esperado bootstrap del estadístico</span></span>
<span id="cb432-8"><a href="bootstrap.html#cb432-8" aria-hidden="true" tabindex="-1"></a>mean.boot <span class="ot">&lt;-</span> <span class="fu">mean</span>(stat.boot)  </span>
<span id="cb432-9"><a href="bootstrap.html#cb432-9" aria-hidden="true" tabindex="-1"></a>mean.boot</span></code></pre></div>
<pre><code>## [1] -0.09274131</code></pre>
<p>Bootstrap percentil:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="bootstrap.html#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(stat.boot, <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb434-2"><a href="bootstrap.html#cb434-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>mean.boot, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb434-3"><a href="bootstrap.html#cb434-3" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(v=stat.dat)</span></span>
<span id="cb434-4"><a href="bootstrap.html#cb434-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-5"><a href="bootstrap.html#cb434-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución poblacional</span></span>
<span id="cb434-6"><a href="bootstrap.html#cb434-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, datmed, datsd<span class="sc">/</span><span class="fu">sqrt</span>(ndat)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb434-7"><a href="bootstrap.html#cb434-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>datmed, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-54-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Bootstrap natural/básico:</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="bootstrap.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(stat.boot<span class="sc">-</span>stat.dat, <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb435-2"><a href="bootstrap.html#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>mean.boot<span class="sc">-</span>stat.dat, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb435-3"><a href="bootstrap.html#cb435-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-4"><a href="bootstrap.html#cb435-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución poblacional</span></span>
<span id="cb435-5"><a href="bootstrap.html#cb435-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución teórica de stat.dat - stat.teor</span></span>
<span id="cb435-6"><a href="bootstrap.html#cb435-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">0</span>, datsd<span class="sc">/</span><span class="fu">sqrt</span>(ndat)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">add=</span><span class="cn">TRUE</span>)   </span>
<span id="cb435-7"><a href="bootstrap.html#cb435-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-55-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Sesgo y error estándar bootstrap:</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="bootstrap.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sesgo (teor=0)</span></span>
<span id="cb436-2"><a href="bootstrap.html#cb436-2" aria-hidden="true" tabindex="-1"></a>mean.boot <span class="sc">-</span> stat.dat </span></code></pre></div>
<pre><code>## [1] 0.0006390906</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="bootstrap.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># error estándar</span></span>
<span id="cb438-2"><a href="bootstrap.html#cb438-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(stat.boot) </span></code></pre></div>
<pre><code>## [1] 0.1044501</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="bootstrap.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># error estándar teórico</span></span>
<span id="cb440-2"><a href="bootstrap.html#cb440-2" aria-hidden="true" tabindex="-1"></a>datsd<span class="sc">/</span><span class="fu">sqrt</span>(ndat) </span></code></pre></div>
<pre><code>## [1] 0.1</code></pre>
<p>Versión “optimizada” para R:</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="bootstrap.html#cb442-1" aria-hidden="true" tabindex="-1"></a>boot.strap <span class="ot">&lt;-</span> <span class="cf">function</span>(dat, <span class="at">nboot=</span><span class="dv">1000</span>, <span class="at">statistic=</span>mean)</span>
<span id="cb442-2"><a href="bootstrap.html#cb442-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb442-3"><a href="bootstrap.html#cb442-3" aria-hidden="true" tabindex="-1"></a>  ndat <span class="ot">&lt;-</span> <span class="fu">length</span>(dat)</span>
<span id="cb442-4"><a href="bootstrap.html#cb442-4" aria-hidden="true" tabindex="-1"></a>  dat.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(dat, ndat<span class="sc">*</span>nboot, <span class="at">replace=</span>T)</span>
<span id="cb442-5"><a href="bootstrap.html#cb442-5" aria-hidden="true" tabindex="-1"></a>  dat.boot <span class="ot">&lt;-</span> <span class="fu">matrix</span>(dat.boot, <span class="at">ncol=</span>nboot, <span class="at">nrow=</span>ndat)</span>
<span id="cb442-6"><a href="bootstrap.html#cb442-6" aria-hidden="true" tabindex="-1"></a>  stat.boot <span class="ot">&lt;-</span> <span class="fu">apply</span>(dat.boot, <span class="dv">2</span>, statistic)</span>
<span id="cb442-7"><a href="bootstrap.html#cb442-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb442-8"><a href="bootstrap.html#cb442-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-9"><a href="bootstrap.html#cb442-9" aria-hidden="true" tabindex="-1"></a>fstatistic <span class="ot">&lt;-</span> <span class="cf">function</span>(dat){</span>
<span id="cb442-10"><a href="bootstrap.html#cb442-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  mean(dat)</span></span>
<span id="cb442-11"><a href="bootstrap.html#cb442-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(dat, <span class="at">trim=</span><span class="fl">0.2</span>)</span>
<span id="cb442-12"><a href="bootstrap.html#cb442-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  median(dat)</span></span>
<span id="cb442-13"><a href="bootstrap.html#cb442-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  max(dat)</span></span>
<span id="cb442-14"><a href="bootstrap.html#cb442-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb442-15"><a href="bootstrap.html#cb442-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-16"><a href="bootstrap.html#cb442-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb442-17"><a href="bootstrap.html#cb442-17" aria-hidden="true" tabindex="-1"></a>stat.dat <span class="ot">&lt;-</span> <span class="fu">fstatistic</span>(dat)</span>
<span id="cb442-18"><a href="bootstrap.html#cb442-18" aria-hidden="true" tabindex="-1"></a>stat.boot <span class="ot">&lt;-</span> <span class="fu">boot.strap</span>(dat, nboot, fstatistic)</span>
<span id="cb442-19"><a href="bootstrap.html#cb442-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-20"><a href="bootstrap.html#cb442-20" aria-hidden="true" tabindex="-1"></a>res.boot <span class="ot">&lt;-</span> <span class="fu">c</span>(stat.dat, <span class="fu">mean</span>(stat.boot)<span class="sc">-</span>stat.dat, <span class="fu">sd</span>(stat.boot))</span>
<span id="cb442-21"><a href="bootstrap.html#cb442-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(res.boot) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Estadístico&quot;</span>, <span class="st">&quot;Sesgo&quot;</span>, <span class="st">&quot;Err.Std&quot;</span>)</span>
<span id="cb442-22"><a href="bootstrap.html#cb442-22" aria-hidden="true" tabindex="-1"></a>res.boot</span></code></pre></div>
<pre><code>##  Estadístico        Sesgo      Err.Std 
## -0.144801929  0.005968729  0.119231743</code></pre>
</div>
<div id="paquetes-r-bootstrap-boot" class="section level3" number="8.5.3">
<h3><span class="header-section-number">8.5.3</span> Paquetes R: bootstrap, boot</h3>
<p>Ver <a href="https://rubenfcasal.github.io/book_remuestreo/cap1-paquetes.html">Sección 1.4</a> de Cao y Fernández-Casal (2019).</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="bootstrap.html#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb444-2"><a href="bootstrap.html#cb444-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?boot</span></span></code></pre></div>
<p>Función estadístico:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="bootstrap.html#cb445-1" aria-hidden="true" tabindex="-1"></a>boot.f <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices){</span>
<span id="cb445-2"><a href="bootstrap.html#cb445-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data[indices] será la muestra bootstrap</span></span>
<span id="cb445-3"><a href="bootstrap.html#cb445-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(data[indices])</span>
<span id="cb445-4"><a href="bootstrap.html#cb445-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Generación de las muestras</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="bootstrap.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb446-2"><a href="bootstrap.html#cb446-2" aria-hidden="true" tabindex="-1"></a>stat.boot <span class="ot">&lt;-</span> <span class="fu">boot</span>(dat, boot.f, nboot)</span>
<span id="cb446-3"><a href="bootstrap.html#cb446-3" aria-hidden="true" tabindex="-1"></a>stat.boot</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = dat, statistic = boot.f, R = nboot)
## 
## 
## Bootstrap Statistics :
##       original       bias    std. error
## t1* -0.0933804 0.0006390906   0.1049474</code></pre>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="bootstrap.html#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stat.boot)</span></code></pre></div>
<pre><code>##  [1] &quot;t0&quot;        &quot;t&quot;         &quot;R&quot;         &quot;data&quot;      &quot;seed&quot;      &quot;statistic&quot;
##  [7] &quot;sim&quot;       &quot;call&quot;      &quot;stype&quot;     &quot;strata&quot;    &quot;weights&quot;</code></pre>
</div>
<div id="gráficos" class="section level3" number="8.5.4">
<h3><span class="header-section-number">8.5.4</span> Gráficos</h3>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="bootstrap.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(stat.boot<span class="sc">$</span>t, <span class="at">freq=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-60-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="bootstrap.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stat.boot)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-60-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="bootstrap.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jack.after.boot</span>(stat.boot)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-60-3.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="intervalos-de-confianza-bootstrap" class="section level3" number="8.5.5">
<h3><span class="header-section-number">8.5.5</span> Intervalos de confianza bootstrap</h3>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="bootstrap.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(stat.boot, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = stat.boot, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   (-0.2997,  0.1117 )   (-0.3028,  0.1147 )  
## 
## Level     Percentile            BCa          
## 95%   (-0.3015,  0.1161 )   (-0.2993,  0.1180 )  
## Calculations and Intervals on Original Scale</code></pre>

<div class="exercise">
<span id="exr:mean-trim-boot" class="exercise"><strong>Ejercicio 8.7  </strong></span>
</div>
<p>Repetir el Ejemplo <a href="bootstrap.html#exm:mean-median-boot">8.1</a> anterior considerando la media recortada al 10%
(con parámetros adicionales).</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="bootstrap.html#cb455-1" aria-hidden="true" tabindex="-1"></a>boot.f <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices, <span class="at">trim =</span> <span class="fl">0.1</span>){</span>
<span id="cb455-2"><a href="bootstrap.html#cb455-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(data[indices], trim)</span>
<span id="cb455-3"><a href="bootstrap.html#cb455-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb455-4"><a href="bootstrap.html#cb455-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-5"><a href="bootstrap.html#cb455-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb455-6"><a href="bootstrap.html#cb455-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boot</span>(dat, boot.f, nboot, <span class="at">trim =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = dat, statistic = boot.f, R = nboot, trim = 0.2)
## 
## 
## Bootstrap Statistics :
##       original      bias    std. error
## t1* -0.1448019 0.006095294    0.119021</code></pre>
<!--- Los siguientes comandos añaden una línea en html, word y un salto vertical en pdf -->
<p><br> </p>

<div class="exercise">
<span id="exr:rachas-sim" class="exercise"><strong>Ejercicio 8.8  (propuesto)  </strong></span>
</div>
<p>En el tema 2 se propuso el análisis de la aleatoriedad de un
generador de números pseudo-aleatorios mediante el test de rachas,
que se podría implementar repetidamente. Sin embargo, la
aproximación asintótica empleada por la rutina <code>runs.test</code> de la
librería <code>tseries</code> no es adecuada para tamaños muéstrales pequeños
(<span class="math inline">\(n&lt;40\)</span>) y sería preferible utilizar la distribución exacta (o
por lo menos utilizar una corrección por continuidad).</p>
<ol style="list-style-type: lower-alpha">
<li><p>Analizar el comportamiento del contraste empleando repetidamente
el test de rachas, considerando 500 pruebas con muestras de
tamaño 10 de una <span class="math inline">\(Bernoulli(0.5)\)</span>. ¿Se observa algo extraño?</p></li>
<li><p>Realiza un programa que permita aproximar por simulación la
función de masa de probabilidad del estadístico número de rachas
(a partir de valores de una <span class="math inline">\(Bernoulli(0.5)\)</span>). Representarla
gráficamente y compararla con la densidad normal. Obtener los
puntos críticos para contrastar la hipótesis nula de
aleatoriedad para <span class="math inline">\(\alpha=0.01,0.05\)</span> y <span class="math inline">\(0.1\)</span>. ¿Es esta
dístribución adecuada para el contraste de aleatoriedad de
variables continuas?¿Cual debería ser la probabilidad de obtener
una única racha al aplicar el test a una variable continua?</p></li>
<li><p>Diseñar una rutina que permita realizar el contraste de
aleatoriedad de una variable continua aproximando el <span class="math inline">\(p\)</span>-valor
por simulación. Asumir que la distribución del estadístico puede
ser asimétrica, en cuyo caso el <span class="math inline">\(p\)</span>-valor
<span class="math inline">\(p=2\min\left\{ P\left( R\leq\hat{R}\mid H_{0}\right) , P\left( R\geq \hat{R}\mid H_{0}\right) \right\}\)</span>.</p></li>
<li><p>Diseñar una rutina que permita realizar el contraste de
aleatoriedad de una variable continua aproximando el <span class="math inline">\(p\)</span>-valor
mediante bootstrap.</p></li>
</ol>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="comparación-de-estimadores.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="monte-carlo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/simbook/edit/master/08-Aplicaciones_Inferencia.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Simulacion.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
