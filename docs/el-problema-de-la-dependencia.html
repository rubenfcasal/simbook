<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.5 El problema de la dependencia | Simulación Estadística</title>
  <meta name="description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="4.5 El problema de la dependencia | Simulación Estadística" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rubenfcasal/simbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.5 El problema de la dependencia | Simulación Estadística" />
  
  <meta name="twitter:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén Fernández Casal (ruben.fcasal@udc.es), Ricardo Cao (rcao@udc.es)" />


<meta name="date" content="2022-02-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="determinación-del-número-de-generaciones.html"/>
<link rel="next" href="observaciones.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simulación Estadística</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="cap1.html"><a href="cap1.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a>
<ul>
<li class="chapter" data-level="1.1" data-path="conceptos-básicos.html"><a href="conceptos-básicos.html"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="conceptos-básicos.html"><a href="conceptos-básicos.html#ventajas-e-inconvenientes-de-la-simulación"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas e inconvenientes de la simulación</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="aplicaciones-de-la-simulación.html"><a href="aplicaciones-de-la-simulación.html"><i class="fa fa-check"></i><b>1.2</b> Aplicaciones de la simulación</a></li>
<li class="chapter" data-level="1.3" data-path="números-aleatorios-puros.html"><a href="números-aleatorios-puros.html"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a></li>
<li class="chapter" data-level="1.4" data-path="generación-de-números-aleatorios-mediante-software.html"><a href="generación-de-números-aleatorios-mediante-software.html"><i class="fa fa-check"></i><b>1.4</b> Generación de números “aleatorios” mediante software</a></li>
<li class="chapter" data-level="1.5" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>1.5</b> Números pseudoaleatorios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rrng.html"><a href="rrng.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="opciones.html"><a href="opciones.html"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="paquetes-de-r.html"><a href="paquetes-de-r.html"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html#utilidades-tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4.1</b> Utilidades tiempo de CPU</a></li>
<li class="chapter" data-level="2.4.2" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html#paquetes-de-r-1"><i class="fa fa-check"></i><b>2.4.2</b> Paquetes de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cap3.html"><a href="cap3.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gen-cong.html"><a href="gen-cong.html"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="gen-cong.html"><a href="gen-cong.html#otros-generadores"><i class="fa fa-check"></i><b>3.1.1</b> Otros generadores</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="calgen.html"><a href="calgen.html"><i class="fa fa-check"></i><b>3.2</b> Análisis de la calidad de un generador</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="calgen.html"><a href="calgen.html#repetición-de-contrastes"><i class="fa fa-check"></i><b>3.2.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.2.2" data-path="calgen.html"><a href="calgen.html#baterias"><i class="fa fa-check"></i><b>3.2.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>3.3</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cap4.html"><a href="cap4.html"><i class="fa fa-check"></i><b>4</b> Análisis de resultados de simulación</a>
<ul>
<li class="chapter" data-level="4.1" data-path="convergencia.html"><a href="convergencia.html"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="convergencia.html"><a href="convergencia.html#detección-de-problemas-de-convergencia"><i class="fa fa-check"></i><b>4.1.1</b> Detección de problemas de convergencia</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="estimación-de-la-precisión.html"><a href="estimación-de-la-precisión.html"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="teorema-central-del-límite.html"><a href="teorema-central-del-límite.html"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="determinación-del-número-de-generaciones.html"><a href="determinación-del-número-de-generaciones.html"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="observaciones.html"><a href="observaciones.html"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sim-con.html"><a href="sim-con.html"><i class="fa fa-check"></i><b>5</b> Simulación de variables continuas</a>
<ul>
<li class="chapter" data-level="5.1" data-path="método-de-inversión.html"><a href="método-de-inversión.html"><i class="fa fa-check"></i><b>5.1</b> Método de inversión</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="método-de-inversión.html"><a href="método-de-inversión.html#algunas-distribuciones-que-pueden-simularse-por-el-método-de-inversión"><i class="fa fa-check"></i><b>5.1.1</b> Algunas distribuciones que pueden simularse por el método de inversión</a></li>
<li class="chapter" data-level="5.1.2" data-path="método-de-inversión.html"><a href="método-de-inversión.html#ventajas-e-inconvenientes"><i class="fa fa-check"></i><b>5.1.2</b> Ventajas e inconvenientes</a></li>
<li class="chapter" data-level="5.1.3" data-path="método-de-inversión.html"><a href="método-de-inversión.html#inversión-aproximada"><i class="fa fa-check"></i><b>5.1.3</b> Inversión aproximada</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>5.2</b> Método de aceptación rechazo</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="AR.html"><a href="AR.html#algoritmo"><i class="fa fa-check"></i><b>5.2.1</b> Algoritmo</a></li>
<li class="chapter" data-level="5.2.2" data-path="AR.html"><a href="AR.html#densidades-acotadas-en-un-intervalo-cerrado"><i class="fa fa-check"></i><b>5.2.2</b> Densidades acotadas en un intervalo cerrado</a></li>
<li class="chapter" data-level="5.2.3" data-path="AR.html"><a href="AR.html#eficiencia-del-algoritmo"><i class="fa fa-check"></i><b>5.2.3</b> Eficiencia del algoritmo</a></li>
<li class="chapter" data-level="5.2.4" data-path="AR.html"><a href="AR.html#ejemplo-inferencia-bayesiana"><i class="fa fa-check"></i><b>5.2.4</b> Ejemplo: Inferencia Bayesiana</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html"><i class="fa fa-check"></i><b>5.3</b> Modificaciones del método de aceptación rechazo</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html#muestreo-por-rechazo-adaptativo-ars"><i class="fa fa-check"></i><b>5.3.1</b> Muestreo por rechazo adaptativo (ARS)</a></li>
<li class="chapter" data-level="5.3.2" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html#método-del-cociente-de-uniformes"><i class="fa fa-check"></i><b>5.3.2</b> Método del cociente de uniformes</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="composicion.html"><a href="composicion.html"><i class="fa fa-check"></i><b>5.4</b> Método de composición (o de simulación condicional)</a></li>
<li class="chapter" data-level="5.5" data-path="notables-cont.html"><a href="notables-cont.html"><i class="fa fa-check"></i><b>5.5</b> Métodos específicos para la generación de algunas distribuciones notables</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="notables-cont.html"><a href="notables-cont.html#método-de-box-müller"><i class="fa fa-check"></i><b>5.5.1</b> Método de Box-Müller</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="discretas.html"><a href="discretas.html"><i class="fa fa-check"></i><b>6</b> Simulación de variables discretas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="método-de-la-transformación-cuantil.html"><a href="método-de-la-transformación-cuantil.html"><i class="fa fa-check"></i><b>6.1</b> Método de la transformación cuantil</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="método-de-la-transformación-cuantil.html"><a href="método-de-la-transformación-cuantil.html#eficiencia-del-algoritmo-1"><i class="fa fa-check"></i><b>6.1.1</b> Eficiencia del algoritmo</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="método-de-la-tabla-guía.html"><a href="método-de-la-tabla-guía.html"><i class="fa fa-check"></i><b>6.2</b> Método de la tabla guía</a></li>
<li class="chapter" data-level="6.3" data-path="alias.html"><a href="alias.html"><i class="fa fa-check"></i><b>6.3</b> Método de Alias</a></li>
<li class="chapter" data-level="6.4" data-path="simulación-de-una-variable-discreta-con-dominio-infinito.html"><a href="simulación-de-una-variable-discreta-con-dominio-infinito.html"><i class="fa fa-check"></i><b>6.4</b> Simulación de una variable discreta con dominio infinito</a></li>
<li class="chapter" data-level="6.5" data-path="cálculo-directo-de-la-función-cuantil.html"><a href="cálculo-directo-de-la-función-cuantil.html"><i class="fa fa-check"></i><b>6.5</b> Cálculo directo de la función cuantil</a></li>
<li class="chapter" data-level="6.6" data-path="otros-métodos.html"><a href="otros-métodos.html"><i class="fa fa-check"></i><b>6.6</b> Otros métodos</a></li>
<li class="chapter" data-level="6.7" data-path="notables-disc.html"><a href="notables-disc.html"><i class="fa fa-check"></i><b>6.7</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulación-de-distribuciones-multivariantes.html"><a href="simulación-de-distribuciones-multivariantes.html"><i class="fa fa-check"></i><b>7</b> Simulación de distribuciones multivariantes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulación-de-componentes-independientes.html"><a href="simulación-de-componentes-independientes.html"><i class="fa fa-check"></i><b>7.1</b> Simulación de componentes independientes</a></li>
<li class="chapter" data-level="7.2" data-path="el-método-de-aceptaciónrechazo.html"><a href="el-método-de-aceptaciónrechazo.html"><i class="fa fa-check"></i><b>7.2</b> El método de aceptación/rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="fact-cov.html"><a href="fact-cov.html"><i class="fa fa-check"></i><b>7.3</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="7.4" data-path="distrcond.html"><a href="distrcond.html"><i class="fa fa-check"></i><b>7.4</b> Método de las distribuciones condicionadas</a></li>
<li class="chapter" data-level="7.5" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html"><i class="fa fa-check"></i><b>7.5</b> Simulación condicional e incondicional</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#condnormal"><i class="fa fa-check"></i><b>7.5.1</b> Simulación condicional de una normal multivariante</a></li>
<li class="chapter" data-level="7.5.2" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#simulación-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>7.5.2</b> Simulación condicional a partir de un modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html"><i class="fa fa-check"></i><b>7.6</b> Simulación basada en cópulas</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#cópulas-arquimedianas"><i class="fa fa-check"></i><b>7.6.1</b> Cópulas Arquimedianas</a></li>
<li class="chapter" data-level="7.6.2" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#simulación"><i class="fa fa-check"></i><b>7.6.2</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="mult-discr.html"><a href="mult-discr.html"><i class="fa fa-check"></i><b>7.7</b> Simulación de distribuciones multivariantes discretas</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="mult-discr.html"><a href="mult-discr.html#métodos-de-codificación-o-etiquetado-para-variables-discretas"><i class="fa fa-check"></i><b>7.7.1</b> Métodos de codificación o etiquetado para variables discretas</a></li>
<li class="chapter" data-level="7.7.2" data-path="mult-discr.html"><a href="mult-discr.html#simulación-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>7.7.2</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="7.7.3" data-path="mult-discr.html"><a href="mult-discr.html#simconting"><i class="fa fa-check"></i><b>7.7.3</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cap8.html"><a href="cap8.html"><i class="fa fa-check"></i><b>8</b> Aplicaciones en Inferencia Estadística</a>
<ul>
<li class="chapter" data-level="8.1" data-path="distribución-en-el-muestreo.html"><a href="distribución-en-el-muestreo.html"><i class="fa fa-check"></i><b>8.1</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="8.2" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>8.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="8.3" data-path="contrastes.html"><a href="contrastes.html"><i class="fa fa-check"></i><b>8.3</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="8.4" data-path="comparación-de-estimadores.html"><a href="comparación-de-estimadores.html"><i class="fa fa-check"></i><b>8.4</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="8.5" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html"><i class="fa fa-check"></i><b>8.5</b> Remuestreo Bootstrap</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#idea"><i class="fa fa-check"></i><b>8.5.1</b> Idea:</a></li>
<li class="chapter" data-level="8.5.2" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#métodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>8.5.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="8.5.3" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>8.5.3</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="8.5.4" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#gráficos"><i class="fa fa-check"></i><b>8.5.4</b> Gráficos</a></li>
<li class="chapter" data-level="8.5.5" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>8.5.5</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cap9.html"><a href="cap9.html"><i class="fa fa-check"></i><b>9</b> Integración y Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="integración-monte-carlo-clásica.html"><a href="integración-monte-carlo-clásica.html"><i class="fa fa-check"></i><b>9.1</b> Integración Monte Carlo (clásica)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="integración-monte-carlo-clásica.html"><a href="integración-monte-carlo-clásica.html#caso-general"><i class="fa fa-check"></i><b>9.1.1</b> Caso general</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html"><i class="fa fa-check"></i><b>9.2</b> Muestreo por importancia</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>9.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="optimización-monte-carlo.html"><a href="optimización-monte-carlo.html"><i class="fa fa-check"></i><b>9.3</b> Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="optimización-monte-carlo.html"><a href="optimización-monte-carlo.html#algoritmos-de-optimización-monte-carlo"><i class="fa fa-check"></i><b>9.3.1</b> Algoritmos de optimización Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="temple-simulado.html"><a href="temple-simulado.html"><i class="fa fa-check"></i><b>9.4</b> Temple simulado</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="temple-simulado.html"><a href="temple-simulado.html#algoritmo-1"><i class="fa fa-check"></i><b>9.4.1</b> Algoritmo:</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="algoritmos-genéticos.html"><a href="algoritmos-genéticos.html"><i class="fa fa-check"></i><b>9.5</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="técnicas-de-reducción-de-la-varianza.html"><a href="técnicas-de-reducción-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a>
<ul>
<li class="chapter" data-level="10.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html"><i class="fa fa-check"></i><b>10.1</b> Variables antitéticas</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#ejemplo-integración-monte-carlo"><i class="fa fa-check"></i><b>10.1.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.1.2" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#generación-de-variables-antitéticas"><i class="fa fa-check"></i><b>10.1.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="estratificación.html"><a href="estratificación.html"><i class="fa fa-check"></i><b>10.2</b> Estratificación</a></li>
<li class="chapter" data-level="10.3" data-path="variables-de-control.html"><a href="variables-de-control.html"><i class="fa fa-check"></i><b>10.3</b> Variables de control</a></li>
<li class="chapter" data-level="10.4" data-path="números-aleatorios-comunes.html"><a href="números-aleatorios-comunes.html"><i class="fa fa-check"></i><b>10.4</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.5" data-path="ejercicios-2.html"><a href="ejercicios-2.html"><i class="fa fa-check"></i><b>10.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-básica.html"><a href="bibliografía-básica.html"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html"><i class="fa fa-check"></i>Bibliografía complementaria</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html#libros"><i class="fa fa-check"></i>Libros</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html#artículos"><i class="fa fa-check"></i>Artículos</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>A</b> Enlaces</a></li>
<li class="chapter" data-level="B" data-path="gof-aleat.html"><a href="gof-aleat.html"><i class="fa fa-check"></i><b>B</b> Bondad de Ajuste y Aleatoriedad</a>
<ul>
<li class="chapter" data-level="B.1" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i><b>B.1</b> Métodos de bondad de ajuste</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="gof.html"><a href="gof.html#histograma"><i class="fa fa-check"></i><b>B.1.1</b> Histograma</a></li>
<li class="chapter" data-level="B.1.2" data-path="gof.html"><a href="gof.html#empdistr"><i class="fa fa-check"></i><b>B.1.2</b> Función de distribución empírica</a></li>
<li class="chapter" data-level="B.1.3" data-path="gof.html"><a href="gof.html#gráficos-p-p-y-q-q"><i class="fa fa-check"></i><b>B.1.3</b> Gráficos P-P y Q-Q</a></li>
<li class="chapter" data-level="B.1.4" data-path="gof.html"><a href="gof.html#chi2test"><i class="fa fa-check"></i><b>B.1.4</b> Contraste ji-cuadrado de Pearson</a></li>
<li class="chapter" data-level="B.1.5" data-path="gof.html"><a href="gof.html#ks-test"><i class="fa fa-check"></i><b>B.1.5</b> Contraste de Kolmogorov-Smirnov</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html"><i class="fa fa-check"></i><b>B.2</b> Diagnosis de la independencia</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#métodos-para-detectar-dependencia"><i class="fa fa-check"></i><b>B.2.1</b> Métodos para detectar dependencia</a></li>
<li class="chapter" data-level="B.2.2" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#gráfico-secuencial"><i class="fa fa-check"></i><b>B.2.2</b> Gráfico secuencial</a></li>
<li class="chapter" data-level="B.2.3" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#gráfico-de-dispersion-retardado"><i class="fa fa-check"></i><b>B.2.3</b> Gráfico de dispersion retardado</a></li>
<li class="chapter" data-level="B.2.4" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#el-correlograma"><i class="fa fa-check"></i><b>B.2.4</b> El correlograma</a></li>
<li class="chapter" data-level="B.2.5" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#test-de-rachas"><i class="fa fa-check"></i><b>B.2.5</b> Test de rachas</a></li>
<li class="chapter" data-level="B.2.6" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#el-contraste-de-ljung-box"><i class="fa fa-check"></i><b>B.2.6</b> El contraste de Ljung-Box</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html"><i class="fa fa-check"></i><b>B.3</b> Contrastes específicos para generadores aleatorios</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-frecuencias"><i class="fa fa-check"></i><b>B.3.1</b> Contraste de frecuencias</a></li>
<li class="chapter" data-level="B.3.2" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-series"><i class="fa fa-check"></i><b>B.3.2</b> Contraste de series</a></li>
<li class="chapter" data-level="B.3.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-poker"><i class="fa fa-check"></i><b>B.3.3</b> El contraste del poker</a></li>
<li class="chapter" data-level="B.3.4" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-coleccionista"><i class="fa fa-check"></i><b>B.3.4</b> El contraste del coleccionista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="int-num.html"><a href="int-num.html"><i class="fa fa-check"></i><b>C</b> Integración numérica</a>
<ul>
<li class="chapter" data-level="C.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html"><i class="fa fa-check"></i><b>C.1</b> Integración numérica unidimensional</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#método-del-trapezoide"><i class="fa fa-check"></i><b>C.1.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="C.1.2" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#regla-de-simpson"><i class="fa fa-check"></i><b>C.1.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="C.1.3" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>C.1.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="C.1.4" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#comandos-de-r"><i class="fa fa-check"></i><b>C.1.4</b> Comandos de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html"><i class="fa fa-check"></i><b>C.2</b> Integración numérica bidimensional</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#representación-gráfica"><i class="fa fa-check"></i><b>C.2.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="C.2.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#método-del-trapezoide-1"><i class="fa fa-check"></i><b>C.2.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="C.2.3" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#comandos-de-r-1"><i class="fa fa-check"></i><b>C.2.3</b> Comandos de <code>R</code></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulación Estadística</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="el-problema-de-la-dependencia" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> El problema de la dependencia</h2>
<p>En el caso de dependencia, la estimación de la precisión se complica:
<span class="math display">\[Var\left( \overline{X}\right) =\frac{1}{n^{2}}\left( 
\sum_{i=1}^{n}Var\left( X_{i} \right) + 2\sum_{i&lt;j}Cov\left( X_{i},X_{j}\right) \right).\]</span></p>

<div class="example">
<span id="exm:mmc" class="example"><strong>Ejemplo 4.3  </strong></span>Aproximación de una proporción bajo dependencia (cadena de Markov)
</div>
<p>Supongamos que en A Coruña llueve de media 1/3 días al año,
y que la probabilidad de que un día llueva solo depende de lo que ocurrió el día anterior,
siendo 0.94 si el día anterior llovió y 0.03 si no.
Podemos generar valores de la variable indicadora de día lluvioso con el siguiente código:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="el-problema-de-la-dependencia.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable dicotómica 0/1 (FALSE/TRUE)  </span></span>
<span id="cb103-2"><a href="el-problema-de-la-dependencia.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb103-3"><a href="el-problema-de-la-dependencia.html#cb103-3" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb103-4"><a href="el-problema-de-la-dependencia.html#cb103-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.03</span> <span class="co"># prob de cambio si seco</span></span>
<span id="cb103-5"><a href="el-problema-de-la-dependencia.html#cb103-5" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.06</span>  <span class="co"># prob de cambio si lluvia</span></span>
<span id="cb103-6"><a href="el-problema-de-la-dependencia.html#cb103-6" aria-hidden="true" tabindex="-1"></a>rx <span class="ot">&lt;-</span> <span class="fu">logical</span>(nsim) <span class="co"># x == &quot;llueve&quot;</span></span>
<span id="cb103-7"><a href="el-problema-de-la-dependencia.html#cb103-7" aria-hidden="true" tabindex="-1"></a>rx[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># El primer día no llueve</span></span>
<span id="cb103-8"><a href="el-problema-de-la-dependencia.html#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nsim)</span>
<span id="cb103-9"><a href="el-problema-de-la-dependencia.html#cb103-9" aria-hidden="true" tabindex="-1"></a>  rx[i] <span class="ot">&lt;-</span> <span class="cf">if</span> (rx[i<span class="dv">-1</span>]) <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&gt;</span> beta <span class="cf">else</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha</span></code></pre></div>
<p>Se podría pensar en emplear las expresiones anteriores:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="el-problema-de-la-dependencia.html#cb104-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nsim</span>
<span id="cb104-2"><a href="el-problema-de-la-dependencia.html#cb104-2" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(rx)<span class="sc">/</span>n</span>
<span id="cb104-3"><a href="el-problema-de-la-dependencia.html#cb104-3" aria-hidden="true" tabindex="-1"></a>esterr <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(est<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>est)<span class="sc">/</span>(n<span class="dv">-1</span>)) <span class="co"># OJO! Supone independencia</span></span>
<span id="cb104-4"><a href="el-problema-de-la-dependencia.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(est, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">ylab=</span><span class="st">&quot;Probabilidad&quot;</span>, </span>
<span id="cb104-5"><a href="el-problema-de-la-dependencia.html#cb104-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Número de simulaciones&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>))</span>
<span id="cb104-6"><a href="el-problema-de-la-dependencia.html#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> est[nsim], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb104-7"><a href="el-problema-de-la-dependencia.html#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(est <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>esterr, <span class="at">lty=</span><span class="dv">2</span>) </span>
<span id="cb104-8"><a href="el-problema-de-la-dependencia.html#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(est <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>esterr, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb104-9"><a href="el-problema-de-la-dependencia.html#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>)     <span class="co"># Prob. teor. cadenas Markov</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:conv-dep"></span>
<img src="04-Analisis_resultados_files/figure-html/conv-dep-1.png" alt="Gráfico de convergencia incluyendo el error de la aproximación (calculado asumiendo independencia)." width="70%" />
<p class="caption">
Figura 4.5: Gráfico de convergencia incluyendo el error de la aproximación (calculado asumiendo independencia).
</p>
</div>
<p>La aproximación de la proporción sería correcta (es consistente):</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="el-problema-de-la-dependencia.html#cb105-1" aria-hidden="true" tabindex="-1"></a>est[nsim]</span></code></pre></div>
<pre><code>## [1] 0.3038</code></pre>
<p>Sin embargo, al ser datos dependientes esta aproximación del error estandar no es adecuada:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="el-problema-de-la-dependencia.html#cb107-1" aria-hidden="true" tabindex="-1"></a>esterr[nsim]</span></code></pre></div>
<pre><code>## [1] 0.004599203</code></pre>
<p>En este caso al haber dependencia positiva se produce una
subestimación del verdadero error estandar.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="el-problema-de-la-dependencia.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">as.numeric</span>(rx))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:acf-depsec"></span>
<img src="04-Analisis_resultados_files/figure-html/acf-depsec-1.png" alt="Correlograma de la secuencia indicadora de días de lluvia." width="70%" />
<p class="caption">
Figura 4.6: Correlograma de la secuencia indicadora de días de lluvia.
</p>
</div>
<p>El gráfico de autocorrelaciones sugiere que si tomamos 1 de cada 25
podemos suponer independencia.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="el-problema-de-la-dependencia.html#cb110-1" aria-hidden="true" tabindex="-1"></a>lag <span class="ot">&lt;-</span> <span class="dv">24</span></span>
<span id="cb110-2"><a href="el-problema-de-la-dependencia.html#cb110-2" aria-hidden="true" tabindex="-1"></a>xlag <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">FALSE</span>, lag), <span class="cn">TRUE</span>)</span>
<span id="cb110-3"><a href="el-problema-de-la-dependencia.html#cb110-3" aria-hidden="true" tabindex="-1"></a>rxi <span class="ot">&lt;-</span> rx[xlag]</span>
<span id="cb110-4"><a href="el-problema-de-la-dependencia.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">as.numeric</span>(rxi))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:acf-depsec2"></span>
<img src="04-Analisis_resultados_files/figure-html/acf-depsec2-1.png" alt="Correlograma de la subsecuencia de días de lluvia obtenida seleccionando uno de cada 25 valores." width="70%" />
<p class="caption">
Figura 4.7: Correlograma de la subsecuencia de días de lluvia obtenida seleccionando uno de cada 25 valores.
</p>
</div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="el-problema-de-la-dependencia.html#cb111-1" aria-hidden="true" tabindex="-1"></a>nrxi <span class="ot">&lt;-</span> <span class="fu">length</span>(rxi)</span>
<span id="cb111-2"><a href="el-problema-de-la-dependencia.html#cb111-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nrxi</span>
<span id="cb111-3"><a href="el-problema-de-la-dependencia.html#cb111-3" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(rxi)<span class="sc">/</span>n</span>
<span id="cb111-4"><a href="el-problema-de-la-dependencia.html#cb111-4" aria-hidden="true" tabindex="-1"></a>esterr <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(est<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>est)<span class="sc">/</span>(n<span class="dv">-1</span>))</span>
<span id="cb111-5"><a href="el-problema-de-la-dependencia.html#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(est, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">ylab=</span><span class="st">&quot;Probabilidad&quot;</span>, </span>
<span id="cb111-6"><a href="el-problema-de-la-dependencia.html#cb111-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">&quot;Número de simulaciones /&quot;</span>, lag <span class="sc">+</span> <span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>))</span>
<span id="cb111-7"><a href="el-problema-de-la-dependencia.html#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> est[<span class="fu">length</span>(rxi)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb111-8"><a href="el-problema-de-la-dependencia.html#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(est <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>esterr, <span class="at">lty=</span><span class="dv">2</span>) <span class="co"># Supone independencia</span></span>
<span id="cb111-9"><a href="el-problema-de-la-dependencia.html#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(est <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>esterr, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb111-10"><a href="el-problema-de-la-dependencia.html#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>)     <span class="co"># Prob. teor. cadenas Markov</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:conv-dep2"></span>
<img src="04-Analisis_resultados_files/figure-html/conv-dep2-1.png" alt="Gráfico de convergencia de la aproximación de la probabilidad a partir de la subsecuencia de días de lluvia (calculando el error de aproximación asumiendo independencia)." width="70%" />
<p class="caption">
Figura 4.8: Gráfico de convergencia de la aproximación de la probabilidad a partir de la subsecuencia de días de lluvia (calculando el error de aproximación asumiendo independencia).
</p>
</div>
<p>Esta forma de proceder podría ser adecuada para tratar de aproximar la precisión:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="el-problema-de-la-dependencia.html#cb112-1" aria-hidden="true" tabindex="-1"></a>esterr[nrxi]</span></code></pre></div>
<pre><code>## [1] 0.02277402</code></pre>
<p>pero no sería eficiente para aproximar la media. Siempre será preferible emplear
todas las observaciones.</p>
<p>Por ejemplo, se podría pensar en considerar las medias de grupos de 24 valores
consecutivos y suponer que hay independencia entre ellas:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="el-problema-de-la-dependencia.html#cb114-1" aria-hidden="true" tabindex="-1"></a>rxm <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(<span class="fu">matrix</span>(rx, <span class="at">ncol =</span> lag, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb114-2"><a href="el-problema-de-la-dependencia.html#cb114-2" aria-hidden="true" tabindex="-1"></a>nrxm <span class="ot">&lt;-</span> <span class="fu">length</span>(rxm)</span>
<span id="cb114-3"><a href="el-problema-de-la-dependencia.html#cb114-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nrxm</span>
<span id="cb114-4"><a href="el-problema-de-la-dependencia.html#cb114-4" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(rxm)<span class="sc">/</span>n</span>
<span id="cb114-5"><a href="el-problema-de-la-dependencia.html#cb114-5" aria-hidden="true" tabindex="-1"></a>esterr <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">cumsum</span>((rxm<span class="sc">-</span>est)<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>n  <span class="co"># Error estándar</span></span>
<span id="cb114-6"><a href="el-problema-de-la-dependencia.html#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(est, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">ylab=</span><span class="st">&quot;Probabilidad&quot;</span>, </span>
<span id="cb114-7"><a href="el-problema-de-la-dependencia.html#cb114-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">&quot;Número de simulaciones /&quot;</span>, lag <span class="sc">+</span> <span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>))</span>
<span id="cb114-8"><a href="el-problema-de-la-dependencia.html#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> est[<span class="fu">length</span>(rxm)], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb114-9"><a href="el-problema-de-la-dependencia.html#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(est <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>esterr, <span class="at">lty=</span><span class="dv">2</span>) <span class="co"># OJO! Supone independencia</span></span>
<span id="cb114-10"><a href="el-problema-de-la-dependencia.html#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(est <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>esterr, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb114-11"><a href="el-problema-de-la-dependencia.html#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>)     <span class="co"># Prob. teor. cadenas Markov</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:conv-dep-lotes"></span>
<img src="04-Analisis_resultados_files/figure-html/conv-dep-lotes-1.png" alt="Gráfico de convergencia de las medias por lotes." width="70%" />
<p class="caption">
Figura 4.9: Gráfico de convergencia de las medias por lotes.
</p>
</div>
<p>Esta es la idea del método de medias por lotes
(<em>batch means</em>; <em>macro-micro replicaciones</em>) para la estimación de la varianza.
En el ejemplo anterior se calcula el error estándar de la aproximación por simulación de la proporción:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="el-problema-de-la-dependencia.html#cb115-1" aria-hidden="true" tabindex="-1"></a>esterr[nrxm]</span></code></pre></div>
<pre><code>## [1] 0.01569017</code></pre>
<p>pero si el objetivo es la aproximación de la varianza (de la variable y no de las medias por lotes), habrá que reescalarlo adecuadamente.
Supongamos que la correlación entre <span class="math inline">\(X_i\)</span> y <span class="math inline">\(X_{i+k}\)</span> es aproximadamente nula,
y consideramos las subsecuencias (lotes) <span class="math inline">\((X_{t+1},X_{t+2},\ldots,X_{t+k})\)</span> con <span class="math inline">\(t=(j-1)k\)</span>, <span class="math inline">\(j=1,\ldots,m\)</span> y <span class="math inline">\(n = mk\)</span>.
Entonces:</p>
<p><span class="math display">\[\begin{aligned}
Var \left(\bar X \right) &amp;= Var \left(\frac{1}{n} \sum_{i=1}^n X_i\right) 
= Var \left( \frac{1}{m}\sum_{j=1}^m \left(\frac{1}{k} \sum_{t=(i-1)k + 1}^{ik} X_t\right) \right) \\
&amp;\approx \frac{1}{m^2} \sum_{j=1}^m Var \left(\frac{1}{k} \sum_{t=(i-1)k + 1}^{ik} X_t\right)
\approx \frac{1}{m} Var \left(\bar{X}_k \right)
\end{aligned}\]</span>
donde <span class="math inline">\(\bar{X}_k\)</span> es la media de una subsecuencia de longitud <span class="math inline">\(k\)</span>.</p>
<!-- Ecuaciones p.237 Gentle, Random numbers & MC methods -->
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="el-problema-de-la-dependencia.html#cb117-1" aria-hidden="true" tabindex="-1"></a>var.aprox <span class="ot">&lt;-</span> nsim <span class="sc">*</span> esterr[<span class="fu">length</span>(rxm)]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb117-2"><a href="el-problema-de-la-dependencia.html#cb117-2" aria-hidden="true" tabindex="-1"></a>var.aprox</span></code></pre></div>
<pre><code>## [1] 2.461814</code></pre>
<p>Obtenida asumiendo independencia entre las medias por lotes, y que será
una mejor aproximación que asumir independencia entre las generaciones
de la variable:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="el-problema-de-la-dependencia.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(rx)</span></code></pre></div>
<pre><code>## [1] 0.2115267</code></pre>
<p>Alternativamente se podría recurrir a la generación de múltiples secuencias
independientes entre sí:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="el-problema-de-la-dependencia.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable dicotómica 0/1 (FALSE/TRUE)  </span></span>
<span id="cb121-2"><a href="el-problema-de-la-dependencia.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb121-3"><a href="el-problema-de-la-dependencia.html#cb121-3" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb121-4"><a href="el-problema-de-la-dependencia.html#cb121-4" aria-hidden="true" tabindex="-1"></a>nsec <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb121-5"><a href="el-problema-de-la-dependencia.html#cb121-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.03</span> <span class="co"># prob de cambio si seco</span></span>
<span id="cb121-6"><a href="el-problema-de-la-dependencia.html#cb121-6" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.06</span>  <span class="co"># prob de cambio si lluvia</span></span>
<span id="cb121-7"><a href="el-problema-de-la-dependencia.html#cb121-7" aria-hidden="true" tabindex="-1"></a>rxm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">FALSE</span>, <span class="at">nrow =</span> nsec, <span class="at">ncol=</span> nsim)</span>
<span id="cb121-8"><a href="el-problema-de-la-dependencia.html#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsec) {</span>
<span id="cb121-9"><a href="el-problema-de-la-dependencia.html#cb121-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rxm[i, 1] &lt;- FALSE # El primer día no llueve</span></span>
<span id="cb121-10"><a href="el-problema-de-la-dependencia.html#cb121-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rxm[i, 1] &lt;- runif(1) &lt; 1/2 # El primer día llueve con probabilidad 1/2</span></span>
<span id="cb121-11"><a href="el-problema-de-la-dependencia.html#cb121-11" aria-hidden="true" tabindex="-1"></a>  rxm[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> <span class="co"># El primer día llueve con probabilidad 1/3 (ideal)</span></span>
<span id="cb121-12"><a href="el-problema-de-la-dependencia.html#cb121-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nsim)</span>
<span id="cb121-13"><a href="el-problema-de-la-dependencia.html#cb121-13" aria-hidden="true" tabindex="-1"></a>    rxm[i, j] <span class="ot">&lt;-</span> <span class="cf">if</span> (rxm[i, j<span class="dv">-1</span>]) <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&gt;</span> beta <span class="cf">else</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha</span>
<span id="cb121-14"><a href="el-problema-de-la-dependencia.html#cb121-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>La idea sería considerar las medias de las series como una muestra independiente
de una nueva variable y estimar su varianza de la forma habitual:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="el-problema-de-la-dependencia.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Media de cada secuencia</span></span>
<span id="cb122-2"><a href="el-problema-de-la-dependencia.html#cb122-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nsim</span>
<span id="cb122-3"><a href="el-problema-de-la-dependencia.html#cb122-3" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">apply</span>(rxm, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">cumsum</span>(x)<span class="sc">/</span>n)</span>
<span id="cb122-4"><a href="el-problema-de-la-dependencia.html#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(n, est, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>,</span>
<span id="cb122-5"><a href="el-problema-de-la-dependencia.html#cb122-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Probabilidad&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Número de simulaciones&quot;</span>)</span>
<span id="cb122-6"><a href="el-problema-de-la-dependencia.html#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Aproximación</span></span>
<span id="cb122-7"><a href="el-problema-de-la-dependencia.html#cb122-7" aria-hidden="true" tabindex="-1"></a>mest <span class="ot">&lt;-</span> <span class="fu">apply</span>(est, <span class="dv">1</span>, mean)</span>
<span id="cb122-8"><a href="el-problema-de-la-dependencia.html#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mest, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb122-9"><a href="el-problema-de-la-dependencia.html#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> mest[nsim], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb122-10"><a href="el-problema-de-la-dependencia.html#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Precisión</span></span>
<span id="cb122-11"><a href="el-problema-de-la-dependencia.html#cb122-11" aria-hidden="true" tabindex="-1"></a>mesterr <span class="ot">&lt;-</span> <span class="fu">apply</span>(est, <span class="dv">1</span>, sd)<span class="sc">/</span><span class="fu">sqrt</span>(nsec)</span>
<span id="cb122-12"><a href="el-problema-de-la-dependencia.html#cb122-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mest <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>mesterr, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb122-13"><a href="el-problema-de-la-dependencia.html#cb122-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mest <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>mesterr, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb122-14"><a href="el-problema-de-la-dependencia.html#cb122-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Prob. teor. cadenas Markov</span></span>
<span id="cb122-15"><a href="el-problema-de-la-dependencia.html#cb122-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>)     </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:conv-dep-nsec"></span>
<img src="04-Analisis_resultados_files/figure-html/conv-dep-nsec-1.png" alt="Gráfico de convergencia de la media de 10 secuencias generadas de forma independiente." width="70%" />
<p class="caption">
Figura 4.10: Gráfico de convergencia de la media de 10 secuencias generadas de forma independiente.
</p>
</div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="el-problema-de-la-dependencia.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aproximación final</span></span>
<span id="cb123-2"><a href="el-problema-de-la-dependencia.html#cb123-2" aria-hidden="true" tabindex="-1"></a>mest[nsim] <span class="co"># mean(rxm)</span></span></code></pre></div>
<pre><code>## [1] 0.3089</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="el-problema-de-la-dependencia.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error estándar</span></span>
<span id="cb125-2"><a href="el-problema-de-la-dependencia.html#cb125-2" aria-hidden="true" tabindex="-1"></a>mesterr[nsim]</span></code></pre></div>
<pre><code>## [1] 0.02403491</code></pre>
<p>Trataremos este tipo de problemas en la diagnosis de algoritmos de
simulación Monte Carlo de Cadenas de Markov (MCMC).
Aparecen también en la simulación dinámica (por eventos o cuantos).</p>
<div id="periodo-de-calentamiento" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Periodo de calentamiento</h3>
<p>En el caso de simulación de datos dependientes (simulación dinámica)
pueden aparecer problemas de estabilización. Puede ocurrir que el sistema
evolucione lentamente en el tiempo hasta alcanzar su distribución estacionaria,
siendo muy sensible a las condiciones iniciales con las que se comienzó la
simulación. En tal caso resulta conveniente ignorar los resultados obtenidos
durante un cierto período inicial de tiempo (denominado período de calentamiento
o estabilización), cuyo único objeto es conseguir que se estabilice la distribución de
probabilidad.</p>
<p>Como ejemplo comparamos la simulación del Ejemplo <a href="el-problema-de-la-dependencia.html#exm:mmc">4.3</a> con la obtenida considerando como punto de partida un día lluvioso (con una semilla distinta para evitar dependencia).</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="el-problema-de-la-dependencia.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb127-2"><a href="el-problema-de-la-dependencia.html#cb127-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb127-3"><a href="el-problema-de-la-dependencia.html#cb127-3" aria-hidden="true" tabindex="-1"></a>rx2 <span class="ot">&lt;-</span> <span class="fu">logical</span>(nsim)</span>
<span id="cb127-4"><a href="el-problema-de-la-dependencia.html#cb127-4" aria-hidden="true" tabindex="-1"></a>rx2[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># El primer día llueve</span></span>
<span id="cb127-5"><a href="el-problema-de-la-dependencia.html#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nsim)</span>
<span id="cb127-6"><a href="el-problema-de-la-dependencia.html#cb127-6" aria-hidden="true" tabindex="-1"></a>  rx2[i] <span class="ot">&lt;-</span> <span class="cf">if</span> (rx2[i<span class="dv">-1</span>]) <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&gt;</span> beta <span class="cf">else</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha</span>
<span id="cb127-7"><a href="el-problema-de-la-dependencia.html#cb127-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nsim</span>
<span id="cb127-8"><a href="el-problema-de-la-dependencia.html#cb127-8" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(rx)<span class="sc">/</span>n</span>
<span id="cb127-9"><a href="el-problema-de-la-dependencia.html#cb127-9" aria-hidden="true" tabindex="-1"></a>est2 <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(rx2)<span class="sc">/</span>n</span>
<span id="cb127-10"><a href="el-problema-de-la-dependencia.html#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(est, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Probabilidad&quot;</span>, </span>
<span id="cb127-11"><a href="el-problema-de-la-dependencia.html#cb127-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Número de simulaciones&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>))</span>
<span id="cb127-12"><a href="el-problema-de-la-dependencia.html#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(est2, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb127-13"><a href="el-problema-de-la-dependencia.html#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplo periodo calentamiento nburn = 2000</span></span>
<span id="cb127-14"><a href="el-problema-de-la-dependencia.html#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">2000</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb127-15"><a href="el-problema-de-la-dependencia.html#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Prob. teor. cadenas Markov</span></span>
<span id="cb127-16"><a href="el-problema-de-la-dependencia.html#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>)     </span></code></pre></div>
<p><img src="04-Analisis_resultados_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>En estos casos puede ser recomendable ignorar los primeros valores generados (por ejemplo los primeros 2000) y recalcular los
estadísticos deseados.</p>
<p>También trataremos este tipo de problemas en la diagnosis de algoritmos MCMC.</p>

<div class="example">
<span id="exm:unnamed-chunk-18" class="example"><strong>Ejemplo 4.4  </strong></span>Simulación de un proceso autorregresivo (serie de tiempo)
</div>
<p><span class="math display">\[X_t = \mu + \rho * (X_{t-1} - \mu) + \varepsilon_t\]</span>
Podemos tener en cuenta que en este caso la varianza es:
<span class="math display">\[\textrm{var}(X_t)=\operatorname{E}(X_t^2)-\mu^2=\frac{\sigma_\varepsilon^2}{1-\rho^2}.\]</span></p>
<p>Establecemos los parámetros:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="el-problema-de-la-dependencia.html#cb128-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">200</span>   <span class="co"># Numero de simulaciones</span></span>
<span id="cb128-2"><a href="el-problema-de-la-dependencia.html#cb128-2" aria-hidden="true" tabindex="-1"></a>xmed <span class="ot">&lt;-</span> <span class="dv">0</span>     <span class="co"># Media</span></span>
<span id="cb128-3"><a href="el-problema-de-la-dependencia.html#cb128-3" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.5</span>    <span class="co"># Coeficiente AR</span></span>
<span id="cb128-4"><a href="el-problema-de-la-dependencia.html#cb128-4" aria-hidden="true" tabindex="-1"></a>nburn <span class="ot">&lt;-</span> <span class="dv">10</span>   <span class="co"># Periodo de calentamiento (burn-in)</span></span></code></pre></div>
<p>Se podría fijar la varianza del error:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="el-problema-de-la-dependencia.html#cb129-1" aria-hidden="true" tabindex="-1"></a>evar <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb129-2"><a href="el-problema-de-la-dependencia.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza de la respuesta</span></span>
<span id="cb129-3"><a href="el-problema-de-la-dependencia.html#cb129-3" aria-hidden="true" tabindex="-1"></a>xvar <span class="ot">&lt;-</span> evar <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>pero la recomendación sería fijar la varianza de la respuesta:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="el-problema-de-la-dependencia.html#cb130-1" aria-hidden="true" tabindex="-1"></a>xvar <span class="ot">&lt;-</span> <span class="dv">1</span>     </span>
<span id="cb130-2"><a href="el-problema-de-la-dependencia.html#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza del error</span></span>
<span id="cb130-3"><a href="el-problema-de-la-dependencia.html#cb130-3" aria-hidden="true" tabindex="-1"></a>evar <span class="ot">&lt;-</span> xvar<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>Para simular la serie, al ser un <span class="math inline">\(AR(1)\)</span>, normalmente simularíamos el primer valor</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="el-problema-de-la-dependencia.html#cb131-1" aria-hidden="true" tabindex="-1"></a>rx[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> xmed, <span class="at">sd =</span> <span class="fu">sqrt</span>(xvar))</span></code></pre></div>
<p>o lo fijamos a la media (en este caso nos alejamos un poco de la distribución estacionaria, para que el “periodo de calentamiento” sea mayor).
Después generamos los siguientes valores de forma recursiva:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="el-problema-de-la-dependencia.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb132-2"><a href="el-problema-de-la-dependencia.html#cb132-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim <span class="sc">+</span> nburn)</span>
<span id="cb132-3"><a href="el-problema-de-la-dependencia.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Establecer el primer valor </span></span>
<span id="cb132-4"><a href="el-problema-de-la-dependencia.html#cb132-4" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span></span>
<span id="cb132-5"><a href="el-problema-de-la-dependencia.html#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simular el resto de la secuencia</span></span>
<span id="cb132-6"><a href="el-problema-de-la-dependencia.html#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(x))</span>
<span id="cb132-7"><a href="el-problema-de-la-dependencia.html#cb132-7" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> xmed <span class="sc">+</span> rho<span class="sc">*</span>(x[i<span class="dv">-1</span>] <span class="sc">-</span> xmed) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(evar))</span>
<span id="cb132-8"><a href="el-problema-de-la-dependencia.html#cb132-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.ts</span>(x)</span>
<span id="cb132-9"><a href="el-problema-de-la-dependencia.html#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span>
<span id="cb132-10"><a href="el-problema-de-la-dependencia.html#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> nburn, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sim-ar1"></span>
<img src="04-Analisis_resultados_files/figure-html/sim-ar1-1.png" alt="Ejemplo de una simulación de una serie de tiempo autorregresiva." width="70%" />
<p class="caption">
Figura 4.11: Ejemplo de una simulación de una serie de tiempo autorregresiva.
</p>
</div>
<p>y eliminamos el periodo de calentamiento:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="el-problema-de-la-dependencia.html#cb133-1" aria-hidden="true" tabindex="-1"></a>rx <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="fu">seq_len</span>(nburn)]</span></code></pre></div>
<p>Para simular una serie de tiempo en <code>R</code>
se puede emplear la función <code>arima.sim</code> del paquete base <code>stats</code>.
En este caso el periodo de calentamiento se establece mediante el
parámetro <code>n.start</code> (que se fija automáticamente a un valor adecuado).</p>
<p>Por ejemplo, podemos generar este serie autoregressiva con:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="el-problema-de-la-dependencia.html#cb134-1" aria-hidden="true" tabindex="-1"></a>rx2 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">ar =</span> rho), <span class="at">n =</span> nsim, <span class="at">n.start =</span> nburn, <span class="at">sd =</span> <span class="fu">sqrt</span>(evar))</span></code></pre></div>
<p>La recomendación es fijar la varianza de las series simuladas si se quieren comparar
resultados considerando distintos parámetros de dependencia.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="determinación-del-número-de-generaciones.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="observaciones.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/simbook/edit/master/04-Analisis_resultados.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Simulacion.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
