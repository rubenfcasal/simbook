<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 Análisis de la calidad de un generador | Técnicas de Simulación y Remuestreo</title>
  <meta name="description" content="Apuntes de Simulación Estadística y Remuestreo." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 Análisis de la calidad de un generador | Técnicas de Simulación y Remuestreo" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Apuntes de Simulación Estadística y Remuestreo." />
  <meta name="github-repo" content="rubenfcasal/simbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 Análisis de la calidad de un generador | Técnicas de Simulación y Remuestreo" />
  
  <meta name="twitter:description" content="Apuntes de Simulación Estadística y Remuestreo." />
  

<meta name="author" content="Rubén Fernández Casal (ruben.fcasal@udc.es)" />
<meta name="author" content="Ricardo Cao (rcao@udc.es)" />
<meta name="author" content="Julián Costa (julian.costa@udc.es)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ext-cong.html"/>
<link rel="next" href="ejercicios-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Técnicas de Simulación y Remuestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a>
<ul>
<li class="chapter" data-level="1.1" data-path="conceptos.html"><a href="conceptos.html"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="conceptos.html"><a href="conceptos.html#ealbum"><i class="fa fa-check"></i><b>1.1.1</b> Ejemplo</a></li>
<li class="chapter" data-level="1.1.2" data-path="conceptos.html"><a href="conceptos.html#ventajas-e-inconvenientes-de-la-simulación"><i class="fa fa-check"></i><b>1.1.2</b> Ventajas e inconvenientes de la simulación</a></li>
<li class="chapter" data-level="1.1.3" data-path="conceptos.html"><a href="conceptos.html#aplicaciones-de-la-simulación"><i class="fa fa-check"></i><b>1.1.3</b> Aplicaciones de la simulación</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html"><i class="fa fa-check"></i><b>1.2</b> Tipos de números aleatorios</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html#números-aleatorios-puros"><i class="fa fa-check"></i><b>1.2.1</b> Números aleatorios puros</a></li>
<li class="chapter" data-level="1.2.2" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html#números-cuasi-aleatorios"><i class="fa fa-check"></i><b>1.2.2</b> Números cuasi-aleatorios</a></li>
<li class="chapter" data-level="1.2.3" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html#números-pseudo-aleatorios"><i class="fa fa-check"></i><b>1.2.3</b> Números pseudo-aleatorios</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rrng.html"><a href="rrng.html"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios en R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="rrng.html"><a href="rrng.html#oprrng"><i class="fa fa-check"></i><b>1.3.1</b> Opciones</a></li>
<li class="chapter" data-level="1.3.2" data-path="rrng.html"><a href="rrng.html#paquetes-de-r"><i class="fa fa-check"></i><b>1.3.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="1.3.3" data-path="rrng.html"><a href="rrng.html#tiempo-de-cpu"><i class="fa fa-check"></i><b>1.3.3</b> Tiempo de CPU</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>1.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="gen-pseudo.html"><a href="gen-pseudo.html"><i class="fa fa-check"></i><b>2</b> Generación de números pseudoaleatorios</a>
<ul>
<li class="chapter" data-level="2.1" data-path="gen-cong.html"><a href="gen-cong.html"><i class="fa fa-check"></i><b>2.1</b> Generadores congruenciales lineales</a></li>
<li class="chapter" data-level="2.2" data-path="ext-cong.html"><a href="ext-cong.html"><i class="fa fa-check"></i><b>2.2</b> Extensiones</a></li>
<li class="chapter" data-level="2.3" data-path="calgen.html"><a href="calgen.html"><i class="fa fa-check"></i><b>2.3</b> Análisis de la calidad de un generador</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="calgen.html"><a href="calgen.html#repetición-de-contrastes"><i class="fa fa-check"></i><b>2.3.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="2.3.2" data-path="calgen.html"><a href="calgen.html#baterias"><i class="fa fa-check"></i><b>2.3.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>2.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="resultados.html"><a href="resultados.html"><i class="fa fa-check"></i><b>3</b> Análisis de resultados de simulación</a>
<ul>
<li class="chapter" data-level="3.1" data-path="convergencia.html"><a href="convergencia.html"><i class="fa fa-check"></i><b>3.1</b> Convergencia</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="convergencia.html"><a href="convergencia.html#detección-de-problemas-de-convergencia"><i class="fa fa-check"></i><b>3.1.1</b> Detección de problemas de convergencia</a></li>
<li class="chapter" data-level="3.1.2" data-path="convergencia.html"><a href="convergencia.html#precisión"><i class="fa fa-check"></i><b>3.1.2</b> Precisión</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="num-gen.html"><a href="num-gen.html"><i class="fa fa-check"></i><b>3.2</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="3.3" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html"><i class="fa fa-check"></i><b>3.3</b> El problema de la dependencia</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>3.3.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="observaciones.html"><a href="observaciones.html"><i class="fa fa-check"></i><b>3.4</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="continuas.html"><a href="continuas.html"><i class="fa fa-check"></i><b>4</b> Simulación de variables continuas</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inversion.html"><a href="inversion.html"><i class="fa fa-check"></i><b>4.1</b> Método de inversión</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="inversion.html"><a href="inversion.html#ejemplos-inv"><i class="fa fa-check"></i><b>4.1.1</b> Algunas distribuciones que pueden simularse por el método de inversión</a></li>
<li class="chapter" data-level="4.1.2" data-path="inversion.html"><a href="inversion.html#ventajas-e-inconvenientes"><i class="fa fa-check"></i><b>4.1.2</b> Ventajas e inconvenientes</a></li>
<li class="chapter" data-level="4.1.3" data-path="inversion.html"><a href="inversion.html#inversión-aproximada"><i class="fa fa-check"></i><b>4.1.3</b> Inversión aproximada</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>4.2</b> Método de aceptación-rechazo</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="AR.html"><a href="AR.html#algoritmo"><i class="fa fa-check"></i><b>4.2.1</b> Algoritmo</a></li>
<li class="chapter" data-level="4.2.2" data-path="AR.html"><a href="AR.html#densidades-acotadas-en-un-intervalo-cerrado"><i class="fa fa-check"></i><b>4.2.2</b> Densidades acotadas en un intervalo cerrado</a></li>
<li class="chapter" data-level="4.2.3" data-path="AR.html"><a href="AR.html#eficiencia-del-algoritmo"><i class="fa fa-check"></i><b>4.2.3</b> Eficiencia del algoritmo</a></li>
<li class="chapter" data-level="4.2.4" data-path="AR.html"><a href="AR.html#elección-de-la-densidad-auxiliar"><i class="fa fa-check"></i><b>4.2.4</b> Elección de la densidad auxiliar</a></li>
<li class="chapter" data-level="4.2.5" data-path="AR.html"><a href="AR.html#bayes-ar"><i class="fa fa-check"></i><b>4.2.5</b> Ejemplo: inferencia bayesiana</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modAR.html"><a href="modAR.html"><i class="fa fa-check"></i><b>4.3</b> Modificaciones del método de aceptación-rechazo</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="modAR.html"><a href="modAR.html#ars"><i class="fa fa-check"></i><b>4.3.1</b> Muestreo por rechazo adaptativo (ARS)</a></li>
<li class="chapter" data-level="4.3.2" data-path="modAR.html"><a href="modAR.html#método-del-cociente-de-uniformes"><i class="fa fa-check"></i><b>4.3.2</b> Método del cociente de uniformes</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="composicion.html"><a href="composicion.html"><i class="fa fa-check"></i><b>4.4</b> Método de composición (o de simulación condicional)</a></li>
<li class="chapter" data-level="4.5" data-path="notables-cont.html"><a href="notables-cont.html"><i class="fa fa-check"></i><b>4.5</b> Métodos específicos para la generación de algunas distribuciones notables</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="notables-cont.html"><a href="notables-cont.html#método-de-box-müller"><i class="fa fa-check"></i><b>4.5.1</b> Método de Box-Müller</a></li>
<li class="chapter" data-level="4.5.2" data-path="notables-cont.html"><a href="notables-cont.html#simulación-de-la-distribución-beta"><i class="fa fa-check"></i><b>4.5.2</b> Simulación de la distribución beta</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="discretas.html"><a href="discretas.html"><i class="fa fa-check"></i><b>5</b> Simulación de variables discretas</a>
<ul>
<li class="chapter" data-level="5.1" data-path="transcuant.html"><a href="transcuant.html"><i class="fa fa-check"></i><b>5.1</b> Método de la transformación cuantil</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="transcuant.html"><a href="transcuant.html#eficiencia-del-algoritmo-1"><i class="fa fa-check"></i><b>5.1.1</b> Eficiencia del algoritmo</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="método-de-la-tabla-guía.html"><a href="método-de-la-tabla-guía.html"><i class="fa fa-check"></i><b>5.2</b> Método de la tabla guía</a></li>
<li class="chapter" data-level="5.3" data-path="alias.html"><a href="alias.html"><i class="fa fa-check"></i><b>5.3</b> Método de Alias</a></li>
<li class="chapter" data-level="5.4" data-path="simulación-de-una-variable-discreta-con-dominio-infinito.html"><a href="simulación-de-una-variable-discreta-con-dominio-infinito.html"><i class="fa fa-check"></i><b>5.4</b> Simulación de una variable discreta con dominio infinito</a></li>
<li class="chapter" data-level="5.5" data-path="otros-métodos.html"><a href="otros-métodos.html"><i class="fa fa-check"></i><b>5.5</b> Otros métodos</a></li>
<li class="chapter" data-level="5.6" data-path="notables-disc.html"><a href="notables-disc.html"><i class="fa fa-check"></i><b>5.6</b> Métodos específicos para generación de distribuciones notables</a></li>
<li class="chapter" data-level="5.7" data-path="ejercicios-discretas.html"><a href="ejercicios-discretas.html"><i class="fa fa-check"></i><b>5.7</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariante.html"><a href="multivariante.html"><i class="fa fa-check"></i><b>6</b> Simulación de distribuciones multivariantes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="simulación-de-componentes-independientes.html"><a href="simulación-de-componentes-independientes.html"><i class="fa fa-check"></i><b>6.1</b> Simulación de componentes independientes</a></li>
<li class="chapter" data-level="6.2" data-path="el-método-de-aceptación-rechazo.html"><a href="el-método-de-aceptación-rechazo.html"><i class="fa fa-check"></i><b>6.2</b> El método de aceptación-rechazo</a></li>
<li class="chapter" data-level="6.3" data-path="fact-cov.html"><a href="fact-cov.html"><i class="fa fa-check"></i><b>6.3</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="6.4" data-path="distrcond.html"><a href="distrcond.html"><i class="fa fa-check"></i><b>6.4</b> Método de las distribuciones condicionadas</a></li>
<li class="chapter" data-level="6.5" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html"><i class="fa fa-check"></i><b>6.5</b> Simulación condicional e incondicional</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#condnormal"><i class="fa fa-check"></i><b>6.5.1</b> Simulación condicional de una normal multivariante</a></li>
<li class="chapter" data-level="6.5.2" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#simulación-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>6.5.2</b> Simulación condicional a partir de un modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html"><i class="fa fa-check"></i><b>6.6</b> Simulación basada en cópulas</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#cópulas-arquimedianas"><i class="fa fa-check"></i><b>6.6.1</b> Cópulas Arquimedianas</a></li>
<li class="chapter" data-level="6.6.2" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#simulación"><i class="fa fa-check"></i><b>6.6.2</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="mult-discr.html"><a href="mult-discr.html"><i class="fa fa-check"></i><b>6.7</b> Simulación de distribuciones multivariantes discretas</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="mult-discr.html"><a href="mult-discr.html#simulación-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>6.7.1</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="6.7.2" data-path="mult-discr.html"><a href="mult-discr.html#simconting"><i class="fa fa-check"></i><b>6.7.2</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="monte-carlo.html"><a href="monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Métodos Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1" data-path="int-MC.html"><a href="int-MC.html"><i class="fa fa-check"></i><b>7.1</b> Integración Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="int-MC.html"><a href="int-MC.html#integración-monte-carlo-clásica"><i class="fa fa-check"></i><b>7.1.1</b> Integración Monte Carlo clásica</a></li>
<li class="chapter" data-level="7.1.2" data-path="int-MC.html"><a href="int-MC.html#caso-general"><i class="fa fa-check"></i><b>7.1.2</b> Caso general</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html"><i class="fa fa-check"></i><b>7.2</b> Muestreo por importancia</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>7.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="opt-MC.html"><a href="opt-MC.html"><i class="fa fa-check"></i><b>7.3</b> Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="opt-MC.html"><a href="opt-MC.html#algoritmos-de-optimización-monte-carlo"><i class="fa fa-check"></i><b>7.3.1</b> Algoritmos de optimización Monte Carlo</a></li>
<li class="chapter" data-level="7.3.2" data-path="opt-MC.html"><a href="opt-MC.html#temple-simulado"><i class="fa fa-check"></i><b>7.3.2</b> Temple simulado</a></li>
<li class="chapter" data-level="7.3.3" data-path="opt-MC.html"><a href="opt-MC.html#algoritmos-genéticos"><i class="fa fa-check"></i><b>7.3.3</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="aplic-inf.html"><a href="aplic-inf.html"><i class="fa fa-check"></i><b>7.4</b> Métodos Monte Carlo en Inferencia Estadística</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="aplic-inf.html"><a href="aplic-inf.html#distribución-en-el-muestreo"><i class="fa fa-check"></i><b>7.4.1</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="7.4.2" data-path="aplic-inf.html"><a href="aplic-inf.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>7.4.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="7.4.3" data-path="aplic-inf.html"><a href="aplic-inf.html#contrastes"><i class="fa fa-check"></i><b>7.4.3</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="7.4.4" data-path="aplic-inf.html"><a href="aplic-inf.html#comparación-de-estimadores"><i class="fa fa-check"></i><b>7.4.4</b> Comparación de estimadores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="red-varianza.html"><a href="red-varianza.html"><i class="fa fa-check"></i><b>8</b> Técnicas de reducción de la varianza</a>
<ul>
<li class="chapter" data-level="8.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html"><i class="fa fa-check"></i><b>8.1</b> Variables antitéticas</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#ejemplo-integración-monte-carlo"><i class="fa fa-check"></i><b>8.1.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="8.1.2" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#generación-de-variables-antitéticas"><i class="fa fa-check"></i><b>8.1.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="estratificación.html"><a href="estratificación.html"><i class="fa fa-check"></i><b>8.2</b> Estratificación</a></li>
<li class="chapter" data-level="8.3" data-path="variables-de-control.html"><a href="variables-de-control.html"><i class="fa fa-check"></i><b>8.3</b> Variables de control</a></li>
<li class="chapter" data-level="8.4" data-path="números-aleatorios-comunes.html"><a href="números-aleatorios-comunes.html"><i class="fa fa-check"></i><b>8.4</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="8.5" data-path="ejercicios-2.html"><a href="ejercicios-2.html"><i class="fa fa-check"></i><b>8.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>9</b> Métodos de remuestreo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="boot-intro.html"><a href="boot-intro.html"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="boot-unif.html"><a href="boot-unif.html"><i class="fa fa-check"></i><b>9.2</b> El Bootstrap uniforme</a></li>
<li class="chapter" data-level="9.3" data-path="intro-paquetes.html"><a href="intro-paquetes.html"><i class="fa fa-check"></i><b>9.3</b> Herramientas disponibles en R sobre bootstrap</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="intro-paquetes.html"><a href="intro-paquetes.html#intro-pkgboot"><i class="fa fa-check"></i><b>9.3.1</b> El paquete <code>boot</code></a></li>
<li class="chapter" data-level="9.3.2" data-path="intro-paquetes.html"><a href="intro-paquetes.html#extensiones-del-bootstrap-uniforme-con-el-paquete-boot"><i class="fa fa-check"></i><b>9.3.2</b> Extensiones del bootstrap uniforme con el paquete <code>boot</code></a></li>
<li class="chapter" data-level="9.3.3" data-path="intro-paquetes.html"><a href="intro-paquetes.html#boot-unif-multi"><i class="fa fa-check"></i><b>9.3.3</b> Ejemplo: Bootstrap uniforme multidimensional</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modunif.html"><a href="modunif.html"><i class="fa fa-check"></i><b>10</b> Extensiones del bootstrap uniforme</a>
<ul>
<li class="chapter" data-level="10.1" data-path="deficien-unif.html"><a href="deficien-unif.html"><i class="fa fa-check"></i><b>10.1</b> Deficiencias del bootstrap uniforme</a></li>
<li class="chapter" data-level="10.2" data-path="modunif-boot-par.html"><a href="modunif-boot-par.html"><i class="fa fa-check"></i><b>10.2</b> Bootstrap paramétrico</a></li>
<li class="chapter" data-level="10.3" data-path="modunif-boot-suav.html"><a href="modunif-boot-suav.html"><i class="fa fa-check"></i><b>10.3</b> Bootstrap suavizado</a></li>
<li class="chapter" data-level="10.4" data-path="boot-reg.html"><a href="boot-reg.html"><i class="fa fa-check"></i><b>10.4</b> Bootstrap basado en modelos</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="boot-reg.html"><a href="boot-reg.html#boot-unif-reg"><i class="fa fa-check"></i><b>10.4.1</b> Remuestreo de las observaciones</a></li>
<li class="chapter" data-level="10.4.2" data-path="boot-reg.html"><a href="boot-reg.html#boot-residual"><i class="fa fa-check"></i><b>10.4.2</b> Bootstrap residual</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="boot-aplic.html"><a href="boot-aplic.html"><i class="fa fa-check"></i><b>11</b> Aplicaciones del remuestreo</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sesgo-prec.html"><a href="sesgo-prec.html"><i class="fa fa-check"></i><b>11.1</b> Estimación del sesgo y la precisión de un estimador</a></li>
<li class="chapter" data-level="11.2" data-path="boot-ic.html"><a href="boot-ic.html"><i class="fa fa-check"></i><b>11.2</b> Intervalos de confianza bootstrap</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-norm"><i class="fa fa-check"></i><b>11.2.1</b> Aproximación normal</a></li>
<li class="chapter" data-level="11.2.2" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-perc"><i class="fa fa-check"></i><b>11.2.2</b> Método percentil directo</a></li>
<li class="chapter" data-level="11.2.3" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-basic"><i class="fa fa-check"></i><b>11.2.3</b> Método percentil básico</a></li>
<li class="chapter" data-level="11.2.4" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-stud"><i class="fa fa-check"></i><b>11.2.4</b> Método percentil-<em>t</em></a></li>
<li class="chapter" data-level="11.2.5" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-bca"><i class="fa fa-check"></i><b>11.2.5</b> Método BCa</a></li>
<li class="chapter" data-level="11.2.6" data-path="boot-ic.html"><a href="boot-ic.html#icboot-trans"><i class="fa fa-check"></i><b>11.2.6</b> Ejemplo: IC bootstrap para el coeficiente de correlación</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="boot-test.html"><a href="boot-test.html"><i class="fa fa-check"></i><b>11.3</b> Contrastes de hipótesis bootstrap</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="boot-test.html"><a href="boot-test.html#contrastes-parametricos"><i class="fa fa-check"></i><b>11.3.1</b> Contrastes bootstrap paramétricos</a></li>
<li class="chapter" data-level="11.3.2" data-path="boot-test.html"><a href="boot-test.html#contrastes-de-permutaciones"><i class="fa fa-check"></i><b>11.3.2</b> Contrastes de permutaciones</a></li>
<li class="chapter" data-level="11.3.3" data-path="boot-test.html"><a href="boot-test.html#contrastes-semiparametricos"><i class="fa fa-check"></i><b>11.3.3</b> Contrastes bootstrap semiparamétricos</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Apéndices</b></span></li>
<li class="chapter" data-level="A" data-path="gof-aleat.html"><a href="gof-aleat.html"><i class="fa fa-check"></i><b>A</b> Bondad de Ajuste y Aleatoriedad</a>
<ul>
<li class="chapter" data-level="A.1" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i><b>A.1</b> Métodos de bondad de ajuste</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="gof.html"><a href="gof.html#histograma"><i class="fa fa-check"></i><b>A.1.1</b> Histograma</a></li>
<li class="chapter" data-level="A.1.2" data-path="gof.html"><a href="gof.html#empdistr"><i class="fa fa-check"></i><b>A.1.2</b> Función de distribución empírica</a></li>
<li class="chapter" data-level="A.1.3" data-path="gof.html"><a href="gof.html#gráficos-p-p-y-q-q"><i class="fa fa-check"></i><b>A.1.3</b> Gráficos P-P y Q-Q</a></li>
<li class="chapter" data-level="A.1.4" data-path="gof.html"><a href="gof.html#chi2test"><i class="fa fa-check"></i><b>A.1.4</b> Contraste chi-cuadrado de Pearson</a></li>
<li class="chapter" data-level="A.1.5" data-path="gof.html"><a href="gof.html#ks-test"><i class="fa fa-check"></i><b>A.1.5</b> Contraste de Kolmogorov-Smirnov</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="diag-aleat.html"><a href="diag-aleat.html"><i class="fa fa-check"></i><b>A.2</b> Diagnosis de la independencia</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="diag-aleat.html"><a href="diag-aleat.html#métodos-para-detectar-dependencia"><i class="fa fa-check"></i><b>A.2.1</b> Métodos para detectar dependencia</a></li>
<li class="chapter" data-level="A.2.2" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-secuencial"><i class="fa fa-check"></i><b>A.2.2</b> Gráfico secuencial</a></li>
<li class="chapter" data-level="A.2.3" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-de-dispersion-retardado"><i class="fa fa-check"></i><b>A.2.3</b> Gráfico de dispersion retardado</a></li>
<li class="chapter" data-level="A.2.4" data-path="diag-aleat.html"><a href="diag-aleat.html#correlograma"><i class="fa fa-check"></i><b>A.2.4</b> El correlograma</a></li>
<li class="chapter" data-level="A.2.5" data-path="diag-aleat.html"><a href="diag-aleat.html#test-de-rachas"><i class="fa fa-check"></i><b>A.2.5</b> Test de rachas</a></li>
<li class="chapter" data-level="A.2.6" data-path="diag-aleat.html"><a href="diag-aleat.html#ljungbox"><i class="fa fa-check"></i><b>A.2.6</b> El contraste de Ljung-Box</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html"><i class="fa fa-check"></i><b>A.3</b> Contrastes específicos para generadores aleatorios</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#freq-test"><i class="fa fa-check"></i><b>A.3.1</b> Contraste de frecuencias</a></li>
<li class="chapter" data-level="A.3.2" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-series"><i class="fa fa-check"></i><b>A.3.2</b> Contraste de series</a></li>
<li class="chapter" data-level="A.3.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-poker"><i class="fa fa-check"></i><b>A.3.3</b> El contraste del poker</a></li>
<li class="chapter" data-level="A.3.4" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-coleccionista"><i class="fa fa-check"></i><b>A.3.4</b> El contraste del coleccionista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="int-num.html"><a href="int-num.html"><i class="fa fa-check"></i><b>B</b> Integración numérica</a>
<ul>
<li class="chapter" data-level="B.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html"><i class="fa fa-check"></i><b>B.1</b> Integración numérica unidimensional</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#método-del-trapezoide"><i class="fa fa-check"></i><b>B.1.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.1.2" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#regla-de-simpson"><i class="fa fa-check"></i><b>B.1.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="B.1.3" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>B.1.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="B.1.4" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#comandos-de-r"><i class="fa fa-check"></i><b>B.1.4</b> Comandos de R</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html"><i class="fa fa-check"></i><b>B.2</b> Integración numérica bidimensional</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#representación-gráfica"><i class="fa fa-check"></i><b>B.2.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="B.2.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#método-del-trapezoide-1"><i class="fa fa-check"></i><b>B.2.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.2.3" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#comandos-de-r-1"><i class="fa fa-check"></i><b>B.2.3</b> Comandos de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="intro-hpc.html"><a href="intro-hpc.html"><i class="fa fa-check"></i><b>C</b> Introducción al procesamiento en paralelo en R</a>
<ul>
<li class="chapter" data-level="C.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>C.1</b> Introducción</a></li>
<li class="chapter" data-level="C.2" data-path="paquetes-en-r.html"><a href="paquetes-en-r.html"><i class="fa fa-check"></i><b>C.2</b> Paquetes en R</a></li>
<li class="chapter" data-level="C.3" data-path="ejemplos.html"><a href="ejemplos.html"><i class="fa fa-check"></i><b>C.3</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="C.3.1" data-path="ejemplos.html"><a href="ejemplos.html#procesamiento-en-paralelo-con-la-función-boot"><i class="fa fa-check"></i><b>C.3.1</b> Procesamiento en paralelo con la función <code>boot()</code></a></li>
<li class="chapter" data-level="C.3.2" data-path="ejemplos.html"><a href="ejemplos.html#estudio-sim-boot"><i class="fa fa-check"></i><b>C.3.2</b> Estudio de simulación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="soluciones.html"><a href="soluciones.html"><i class="fa fa-check"></i><b>D</b> Soluciones ejercicios</a>
<ul>
<li class="chapter" data-level="D.1" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html"><i class="fa fa-check"></i><b>D.1</b> Capítulo 1 Introducción a la simulación</a>
<ul>
<li class="chapter" data-level="D.1.1" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-simpi"><i class="fa fa-check"></i><b>D.1.1</b> Ejercicio 1.1</a></li>
<li class="chapter" data-level="D.1.2" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-bernoulli"><i class="fa fa-check"></i><b>D.1.2</b> Ejercicio 1.2</a></li>
<li class="chapter" data-level="D.1.3" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-circuito"><i class="fa fa-check"></i><b>D.1.3</b> Ejercicio 1.3</a></li>
<li class="chapter" data-level="D.1.4" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-mere"><i class="fa fa-check"></i><b>D.1.4</b> Ejercicio 1.4</a></li>
<li class="chapter" data-level="D.1.5" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-album"><i class="fa fa-check"></i><b>D.1.5</b> Ejercicio 1.5</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="capítulo-2-generación-de-números-pseudoaleatorios.html"><a href="capítulo-2-generación-de-números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>D.2</b> Capítulo 2 Generación de números pseudoaleatorios</a>
<ul>
<li class="chapter" data-level="D.2.1" data-path="capítulo-2-generación-de-números-pseudoaleatorios.html"><a href="capítulo-2-generación-de-números-pseudoaleatorios.html#sol-RANDVN"><i class="fa fa-check"></i><b>D.2.1</b> Ejercicio 2.1</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="capítulo-5-simulación-de-variables-discretas.html"><a href="capítulo-5-simulación-de-variables-discretas.html"><i class="fa fa-check"></i><b>D.3</b> Capítulo 5 Simulación de variables discretas</a>
<ul>
<li class="chapter" data-level="D.3.1" data-path="capítulo-5-simulación-de-variables-discretas.html"><a href="capítulo-5-simulación-de-variables-discretas.html#sol-mixta-cuantil"><i class="fa fa-check"></i><b>D.3.1</b> Ejercicio 5.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-básica.html"><a href="bibliografía-básica.html"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html"><i class="fa fa-check"></i>Bibliografía complementaria</a></li>
<li class="chapter" data-level="" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i>Enlaces</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliografía.html"><a href="bibliografía.html"><i class="fa fa-check"></i>Bibliografía</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Técnicas de Simulación y Remuestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="calgen" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Análisis de la calidad de un generador<a href="calgen.html#calgen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para verificar si un generador tiene las propiedades estadísticas deseadas hay disponibles una gran cantidad de test de hipótesis y métodos gráficos,
incluyendo métodos genéricos (de bondad de ajuste y aleatoriedad) y contrastes específicos para generadores aleatorios.
Se trata principalmente de contrastar si las muestras generadas son i.i.d. <span class="math inline">\(\mathcal{U}\left(0,1\right)\)</span> (análisis univariante).
Aunque los métodos más avanzados tratan de contrastar si las <span class="math inline">\(d\)</span>-uplas:</p>
<p><span class="math display">\[(U_{t+1},U_{t+2},\ldots,U_{t+d}); \ t=(i-1)d, \ i=1,\ldots,m\]</span></p>
<p>son i.i.d. <span class="math inline">\(\mathcal{U}\left(0,1\right)^{d}\)</span> (uniformes independientes en el hipercubo; análisis multivariante).
En el Apéndice <a href="gof-aleat.html#gof-aleat">A</a> se describen algunos de estos métodos.</p>
<p>En esta sección emplearemos únicamente métodos genéricos, ya que también pueden ser de utilidad para evaluar generadores de variables no uniformes y para la construcción de modelos del sistema real (e.g. para modelar variables que se tratarán como entradas del modelo general).
Sin embargo, los métodos clásicos pueden no ser muy adecuados para evaluar generadores de números pseudoaleatorios <span class="citation">(ver <a href="#ref-lecuyer07" role="doc-biblioref">L’Ecuyer y Simard, 2007</a>)</span>.
La recomendación sería emplear baterías de contrastes recientes, como las descritas en la Subsección <a href="calgen.html#baterias">2.3.2</a>.</p>
<p>Hay que destacar algunas diferencias entre el uso de este tipo de métodos en inferencia y en simulación.
Por ejemplo, si empleamos un constrate de hipótesis del modo habitual, desconfiamos del generador si la muestra (secuencia) no se ajusta a la distribución teórica (p-valor <span class="math inline">\(\leq \alpha\)</span>).
En simulación, además, también se sospecha si se ajusta demasiado bien a la distribución teórica (p-valor <span class="math inline">\(\geq1-\alpha\)</span>), lo que indicaría que no reproduce adecuadamente la variabilidad.</p>
<p>Uno de los contrastes más conocidos es el test chi-cuadrado de bondad de ajuste (<a href="https://rdrr.io/r/stats/chisq.test.html"><code>chisq.test()</code></a> para el caso discreto; ver Sección <a href="gof.html#chi2test">A.1.4</a>).
Aunque si la variable de interés es continua, habría que discretizarla (con la correspondiente perdida de información).
Por ejemplo, se podría emplear la función <a href="https://rubenfcasal.github.io/simres/reference/chisq.cont.test.html"><code>simres::chisq.cont.test()</code></a> (fichero <a href="R/test.R"><em>test.R</em></a>), que imita a las incluidas en R:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="calgen.html#cb59-1" aria-hidden="true" tabindex="-1"></a>simres<span class="sc">::</span>chisq.cont.test</span></code></pre></div>
<pre><code>## function(x, distribution = &quot;norm&quot;, nclass = floor(length(x)/5),
##                             output = TRUE, nestpar = 0, ...) {
##   # Función distribución
##   q.distrib &lt;- eval(parse(text = paste(&quot;q&quot;, distribution, sep = &quot;&quot;)))
##   # Puntos de corte
##   q &lt;- q.distrib((1:(nclass - 1))/nclass, ...)
##   tol &lt;- sqrt(.Machine$double.eps)
##   xbreaks &lt;- c(min(x) - tol, q, max(x) + tol)
##   # Gráficos y frecuencias
##   if (output) {
##     xhist &lt;- hist(x, breaks = xbreaks, freq = FALSE,
##                   lty = 2, border = &quot;grey50&quot;)
##     # Función densidad
##     d.distrib &lt;- eval(parse(text = paste(&quot;d&quot;, distribution, sep = &quot;&quot;)))
##     curve(d.distrib(x, ...), add = TRUE)
##   } else {
##     xhist &lt;- hist(x, breaks = xbreaks, plot = FALSE)
##   }
##   # Cálculo estadístico y p-valor
##   O &lt;- xhist$counts  # Equivalente a table(cut(x, xbreaks)) pero más eficiente
##   E &lt;- length(x)/nclass
##   DNAME &lt;- deparse(substitute(x))
##   METHOD &lt;- &quot;Pearson&#39;s Chi-squared test&quot;
##   STATISTIC &lt;- sum((O - E)^2/E)
##   names(STATISTIC) &lt;- &quot;X-squared&quot;
##   PARAMETER &lt;- nclass - nestpar - 1
##   names(PARAMETER) &lt;- &quot;df&quot;
##   PVAL &lt;- pchisq(STATISTIC, PARAMETER, lower.tail = FALSE)
##   # Preparar resultados
##   classes &lt;- format(xbreaks)
##   classes &lt;- paste(&quot;(&quot;, classes[-(nclass + 1)], &quot;,&quot;, classes[-1], &quot;]&quot;,
##                    sep = &quot;&quot;)
##   RESULTS &lt;- list(classes = classes, observed = O, expected = E,
##                   residuals = (O - E)/sqrt(E))
##   if (output) {
##     cat(&quot;\nPearson&#39;s Chi-squared test table\n&quot;)
##     print(as.data.frame(RESULTS))
##   }
##   if (any(E &lt; 5))
##     warning(&quot;Chi-squared approximation may be incorrect&quot;)
##   structure(c(list(statistic = STATISTIC, parameter = PARAMETER, p.value = PVAL,
##                    method = METHOD, data.name = DNAME), RESULTS), class = &quot;htest&quot;)
## }
## &lt;bytecode: 0x0000015a8c39f1a8&gt;
## &lt;environment: namespace:simres&gt;</code></pre>
<div class="example">
<p><span id="exm:congru512b" class="example"><strong>Ejemplo 2.2  (análisis de un generador congruencial continuación) </strong></span><br></p>
<p>Continuando con el generador congruencial del Ejemplo <a href="gen-cong.html#exm:congru512">2.1</a>:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="calgen.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.rng</span>(<span class="dv">321</span>, <span class="st">&quot;lcg&quot;</span>, <span class="at">a =</span> <span class="dv">5</span>, <span class="at">c =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">512</span>)  <span class="co"># Establecer semilla y parámetros</span></span>
<span id="cb61-2"><a href="calgen.html#cb61-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb61-3"><a href="calgen.html#cb61-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">rng</span>(nsim)</span></code></pre></div>
<p>Al aplicar el test chi-cuadrado obtendríamos:</p>

<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="calgen.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.cont.test</span>(u, <span class="at">distribution =</span> <span class="st">&quot;unif&quot;</span>, </span>
<span id="cb62-2"><a href="calgen.html#cb62-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">nclass =</span> <span class="dv">10</span>, <span class="at">nestpar =</span> <span class="dv">0</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:chisq-test-unif"></span>
<img src="02-Generacion_numeros_aleatorios_files/figure-html/chisq-test-unif-1.png" alt="Gráfico resultante de aplicar la función chisq.cont.test() comparando el histograma de los valores generados con la densidad uniforme." width="75%" />
<p class="caption">
Figura 2.3: Gráfico resultante de aplicar la función <code>chisq.cont.test()</code> comparando el histograma de los valores generados con la densidad uniforme.
</p>
</div>
<pre><code>## 
## Pearson&#39;s Chi-squared test table
##                      classes observed expected residuals
## 1  (-1.4901e-08, 1.0000e-01]       51       50   0.14142
## 2  ( 1.0000e-01, 2.0000e-01]       49       50  -0.14142
## 3  ( 2.0000e-01, 3.0000e-01]       49       50  -0.14142
## 4  ( 3.0000e-01, 4.0000e-01]       50       50   0.00000
## 5  ( 4.0000e-01, 5.0000e-01]       51       50   0.14142
## 6  ( 5.0000e-01, 6.0000e-01]       51       50   0.14142
## 7  ( 6.0000e-01, 7.0000e-01]       49       50  -0.14142
## 8  ( 7.0000e-01, 8.0000e-01]       50       50   0.00000
## 9  ( 8.0000e-01, 9.0000e-01]       50       50   0.00000
## 10 ( 9.0000e-01, 9.9805e-01]       50       50   0.00000</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  u
## X-squared = 0.12, df = 9, p-value = 1</code></pre>
<p>Alternativamente, por ejemplo si solo se pretende aplicar el contraste, se podría emplear la función <a href="https://rubenfcasal.github.io/simres/reference/freq.test.html"><code>simres::freq.test()</code></a> (fichero <a href="R/test.R"><em>test.R</em></a>) para este caso particular (ver Sección <a href="contrastes-específicos-para-generadores-aleatorios.html#freq-test">A.3.1</a>).</p>
<p>Como se muestra en la Figura <a href="calgen.html#fig:chisq-test-unif">2.3</a> el histograma de la secuencia generada es muy plano (comparado con lo que cabría esperar de una muestra de tamaño 500 de una uniforme), y consecuentemente el p-valor del contraste chi-cuadrado es prácticamente 1, lo que indicaría que este generador no reproduce adecuadamente la variabilidad de una distribución uniforme.</p>
<p>Otro contraste de bondad de ajuste muy conocido es el test de Kolmogorov-Smirnov, implementado en <a href="https://rdrr.io/r/stats/ks.test.html"><code>ks.test()</code></a> (ver Sección <a href="gof.html#ks-test">A.1.5</a>).
Este contraste de hipótesis compara la función de distribución bajo la hipótesis nula con la función de distribución empírica (ver Sección <a href="gof.html#empdistr">A.1.2</a>), representadas en la Figura <a href="calgen.html#fig:empdistrunif">2.4</a>:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="calgen.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución empírica</span></span>
<span id="cb65-2"><a href="calgen.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ecdf</span>(u)(x), <span class="at">type =</span> <span class="st">&quot;s&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb65-3"><a href="calgen.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">punif</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:empdistrunif"></span>
<img src="02-Generacion_numeros_aleatorios_files/figure-html/empdistrunif-1.png" alt="Comparación de la distribución empírica de la secuencia generada con la función de distribución uniforme." width="75%" />
<p class="caption">
Figura 2.4: Comparación de la distribución empírica de la secuencia generada con la función de distribución uniforme.
</p>
</div>
<p>Podemos realizar el contraste con el siguiente código:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="calgen.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Kolmogorov-Smirnov</span></span>
<span id="cb66-2"><a href="calgen.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(u, <span class="st">&quot;punif&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  u
## D = 0.00333, p-value = 1
## alternative hypothesis: two-sided</code></pre>
<p>La conclusión sería la misma que la del contraste chi-cuadrado, aparentemente este generador no reproduce adecuadamente la variabilidad de una distribución uniforme.
En la Sección <a href="gof.html#gof">A.1</a> se describen con más detalle estos contrastes de bondad de ajuste.</p>
<p>Adicionalmente podríamos estudiar la aleatoriedad de los valores generados (ver Sección <a href="diag-aleat.html#diag-aleat">A.2</a>), por ejemplo mediante un gráfico secuencial y el de dispersión retardado.
Si se observa algún tipo de patrón indicaría dependencia (ver Ejemplo <a href="diag-aleat.html#exm:ret-gen">A.2</a>).</p>
<p>En este caso no se observa nada extraño en el gráfico secuencial:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="calgen.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.ts</span>(u))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plot-sec"></span>
<img src="02-Generacion_numeros_aleatorios_files/figure-html/plot-sec-1.png" alt="Gráfico secuencial de los valores generados." width="75%" />
<p class="caption">
Figura 2.5: Gráfico secuencial de los valores generados.
</p>
</div>
<p>mientras que en el gráfico de dispersión retardado se observa un fuerte patrón reticular:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="calgen.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(u[<span class="sc">-</span>nsim], u[<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plot-ret"></span>
<img src="02-Generacion_numeros_aleatorios_files/figure-html/plot-ret-1.png" alt="Gráfico de dispersión retardado de los valores generados." width="75%" />
<p class="caption">
Figura 2.6: Gráfico de dispersión retardado de los valores generados.
</p>
</div>
<p>Por tanto sospecharíamos que hay problemas con la aleatoriedad de este generador (en este caso también podríamos hablar de que no hay uniformidad en dos dimensiones).</p>
<p>También podemos analizar las autocorrelaciones (las correlaciones de <span class="math inline">\((u_{i},u_{i+k})\)</span>, con <span class="math inline">\(k=1,\ldots,K\)</span>; ver Sección <a href="diag-aleat.html#correlograma">A.2.4</a>):</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="calgen.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(u)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plot-acf"></span>
<img src="02-Generacion_numeros_aleatorios_files/figure-html/plot-acf-1.png" alt="Autocorrelaciones de los valores generados." width="75%" />
<p class="caption">
Figura 2.7: Autocorrelaciones de los valores generados.
</p>
</div>
<p>En este caso la autocorrelación de orden 1 es claramente significativa.
Adicionalmente, podríamos emplear el test de Ljung-Box (ver Sección <a href="diag-aleat.html#ljungbox">A.2.6</a>) para contrastar si las diez primeras autocorrelaciones son nulas:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="calgen.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(u, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;Ljung&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  u
## X-squared = 22.5, df = 10, p-value = 0.013</code></pre>
<p>A partir de estos resultados también sospecharíamos que hay problemas con la aleatoriedad de este generador.</p>
</div>
<div id="repetición-de-contrastes" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Repetición de contrastes<a href="calgen.html#repetición-de-contrastes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los contrastes se plantean habitualmente desde el punto de vista de la inferencia estadística: se realiza una prueba sobre la única muestra disponible.
Si se realiza una única prueba, en las condiciones de <span class="math inline">\(H_0\)</span> hay una probabilidad <span class="math inline">\(\alpha\)</span> de rechazarla.
En simulación tiene mucho más sentido realizar un gran número de pruebas:</p>
<ul>
<li><p>La proporción de rechazos debería aproximarse al valor de
<span class="math inline">\(\alpha\)</span> (se puede comprobar para distintos valores de <span class="math inline">\(\alpha\)</span>).</p></li>
<li><p>La distribución del estadístico debería ajustarse a la teórica
bajo <span class="math inline">\(H_0\)</span> (se podría realizar un nuevo contraste de bondad
de ajuste).</p></li>
<li><p>Los p-valores obtenidos deberían ajustarse a una
<span class="math inline">\(\mathcal{U}\left(0,1\right)\)</span> (se podría realizar también un
contraste de bondad de ajuste).</p></li>
</ul>
<p>Este procedimiento es también el habitual para validar un método de
contraste de hipótesis por simulación (ver Sección <a href="aplic-inf.html#contrastes">7.4.3</a>).</p>
<div class="example">
<p><span id="exm:rep-test-randu" class="example"><strong>Ejemplo 2.3  </strong></span><br></p>
<p>Continuando con el generador congruencial RANDU, podemos pensar en estudiar la uniformidad de los valores generados empleando repetidamente el test chi-cuadrado.
En este caso generamos <code>nsim = 1000</code> secuencias de longitud <code>n = 500</code> y empleamos la función <a href="https://rubenfcasal.github.io/simres/reference/freq.test.html"><code>freq.test()</code></a> con los valores por defecto (<code>nclass = 50</code>):</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="calgen.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Establecer semilla y parámetros</span></span>
<span id="cb73-2"><a href="calgen.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.rng</span>(<span class="dv">543210</span>, <span class="st">&quot;lcg&quot;</span>, <span class="at">a =</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">16</span> <span class="sc">+</span> <span class="dv">3</span>, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">m =</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">31</span>)  </span>
<span id="cb73-3"><a href="calgen.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores iniciales</span></span>
<span id="cb73-4"><a href="calgen.html#cb73-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb73-5"><a href="calgen.html#cb73-5" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb73-6"><a href="calgen.html#cb73-6" aria-hidden="true" tabindex="-1"></a>estadistico <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span>
<span id="cb73-7"><a href="calgen.html#cb73-7" aria-hidden="true" tabindex="-1"></a>pvalor <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span>
<span id="cb73-8"><a href="calgen.html#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar contrastes</span></span>
<span id="cb73-9"><a href="calgen.html#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(isim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb73-10"><a href="calgen.html#cb73-10" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rng</span>(n)    <span class="co"># Generar</span></span>
<span id="cb73-11"><a href="calgen.html#cb73-11" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">freq.test</span>(u)</span>
<span id="cb73-12"><a href="calgen.html#cb73-12" aria-hidden="true" tabindex="-1"></a>  estadistico[isim] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>statistic</span>
<span id="cb73-13"><a href="calgen.html#cb73-13" aria-hidden="true" tabindex="-1"></a>  pvalor[isim] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>p.value</span>
<span id="cb73-14"><a href="calgen.html#cb73-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<!-- estadístico, pvalor -->
<p>Por ejemplo, podemos comparar la proporción de rechazos observados con los que cabría esperar con los niveles de significación habituales:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="calgen.html#cb74-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb74-2"><a href="calgen.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 1% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.01</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb74-3"><a href="calgen.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.05</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb74-4"><a href="calgen.html#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb74-5"><a href="calgen.html#cb74-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Proporción de rechazos al 1% = 0.012 
## Proporción de rechazos al 5% = 0.045 
## Proporción de rechazos al 10% = 0.095</code></pre>
<p>Las proporciones de rechazo obtenidas deberían comportarse como una aproximación por simulación de los niveles teóricos.
En este caso no se observa nada extraño, por lo que no habría motivos para sospechar de la uniformidad de los valores generados (aparentemente no hay problemas con la uniformidad de este generador).</p>
<p>Adicionalmente, si queremos estudiar la proporción de rechazos (el <em>tamaño del contraste</em>) para los posibles valores de <span class="math inline">\(\alpha\)</span>, podemos emplear la distribución empírica del p-valor (proporción de veces que resultó menor que un determinado valor):</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="calgen.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución empírica</span></span>
<span id="cb76-2"><a href="calgen.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(pvalor), <span class="at">do.points =</span> <span class="cn">FALSE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb76-3"><a href="calgen.html#cb76-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Nivel de significación&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Proporción de rechazos&#39;</span>)</span>
<span id="cb76-4"><a href="calgen.html#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)   <span class="co"># curve(punif(x, 0, 1), add = TRUE)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rep-test-ecdf"></span>
<img src="02-Generacion_numeros_aleatorios_files/figure-html/rep-test-ecdf-1.png" alt="Proporción de rechazos con los distintos niveles de significación." width="75%" />
<p class="caption">
Figura 2.8: Proporción de rechazos con los distintos niveles de significación.
</p>
</div>
<p>También podemos estudiar la distribución del estadístico del contraste.
En este caso, como la distribución bajo la hipótesis nula está implementada en R, podemos compararla fácilmente con la de los valores generados (debería ser una aproximación por simulación de la distribución teórica):</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="calgen.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograma</span></span>
<span id="cb77-2"><a href="calgen.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(estadistico, <span class="at">breaks =</span> <span class="st">&quot;FD&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb77-3"><a href="calgen.html#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dchisq</span>(x, <span class="dv">49</span>), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rep-test-est"></span>
<img src="02-Generacion_numeros_aleatorios_files/figure-html/rep-test-est-1.png" alt="Distribución del estadístico del constraste." width="75%" />
<p class="caption">
Figura 2.9: Distribución del estadístico del constraste.
</p>
</div>
<p>Además de la comparación gráfica, podríamos emplear un test de bondad de ajuste para contrastar si la distribución del estadístico es la teórica bajo la hipótesis nula:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="calgen.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test chi-cuadrado (chi-cuadrado sobre chi-cuadrado)</span></span>
<span id="cb78-2"><a href="calgen.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq.cont.test(estadistico, distribution=&quot;chisq&quot;, nclass=20, nestpar=0, df=99)</span></span>
<span id="cb78-3"><a href="calgen.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Kolmogorov-Smirnov</span></span>
<span id="cb78-4"><a href="calgen.html#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(estadistico, <span class="st">&quot;pchisq&quot;</span>, <span class="at">df =</span> <span class="dv">49</span>)</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  estadistico
## D = 0.0359, p-value = 0.15
## alternative hypothesis: two-sided</code></pre>
<p>En este caso la distribución observada del estadístico es la que cabría esperar de una muestra de este tamaño de la distribución teórica, por tanto, según este criterio, aparentemente no habría problemas con la uniformidad de este generador (hay que recordar que estamos utilizando contrastes de hipótesis como herramienta para ver si hay algún problema con el generador, no tiene mucho sentido hablar de aceptar o rechazar una hipótesis).</p>
<p>En lugar de estudiar la distribución del estadístico de contraste siempre podemos analizar la distribución del p-valor.
Mientras que la distribución teórica del estadístico depende del contraste y puede ser complicada, la del p-valor es siempre una uniforme.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="calgen.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograma</span></span>
<span id="cb80-2"><a href="calgen.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pvalor, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb80-3"><a href="calgen.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rep-test-pval"></span>
<img src="02-Generacion_numeros_aleatorios_files/figure-html/rep-test-pval-1.png" alt="Distribución del p-valor del constraste." width="75%" />
<p class="caption">
Figura 2.10: Distribución del p-valor del constraste.
</p>
</div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="calgen.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test chi-cuadrado</span></span>
<span id="cb81-2"><a href="calgen.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># chisq.cont.test(pvalor, distribution=&quot;unif&quot;, nclass=20, nestpar=0, min=0, max=1)</span></span>
<span id="cb81-3"><a href="calgen.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Kolmogorov-Smirnov</span></span>
<span id="cb81-4"><a href="calgen.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(pvalor, <span class="st">&quot;punif&quot;</span>,  <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  pvalor
## D = 0.0359, p-value = 0.15
## alternative hypothesis: two-sided</code></pre>
<p>Como podemos observar, obtendríamos los mismos resultados que al analizar la distribución del estadístico.</p>
<p>Alternativamente podríamos emplear la función <a href="https://rubenfcasal.github.io/simres/reference/rephtest.html"><code>rephtest()</code></a> del paquete <code>simres</code> (fichero <a href="R/test.R"><em>test.R</em></a>):</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="calgen.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.rng</span>(<span class="dv">543210</span>, <span class="st">&quot;lcg&quot;</span>, <span class="at">a =</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">16</span> <span class="sc">+</span> <span class="dv">3</span>, <span class="at">c =</span> <span class="dv">0</span>, <span class="at">m =</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">31</span>)</span>
<span id="cb83-2"><a href="calgen.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># res &lt;- rephtest(n = 30, test = chisq.cont.test, rand.gen = rng,</span></span>
<span id="cb83-3"><a href="calgen.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co">#          distribution = &quot;unif&quot;, output = FALSE, nestpar = 0)</span></span>
<span id="cb83-4"><a href="calgen.html#cb83-4" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rephtest</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">test =</span> freq.test, <span class="at">rand.gen =</span> rng, <span class="at">nclass =</span> <span class="dv">6</span>)</span>
<span id="cb83-5"><a href="calgen.html#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(res)</span></code></pre></div>
<pre><code>## List of 2
##  $ statistics: num [1:1000] 5.2 6.8 12.4 0.8 5.6 7.6 6.4 9.6 5.2 3.2 ...
##  $ p.values  : num [1:1000] 0.392 0.2359 0.0297 0.977 0.3471 ...
##  - attr(*, &quot;class&quot;)= chr &quot;rhtest&quot;
##  - attr(*, &quot;method&quot;)= chr &quot;Chi-squared test for given probabilities&quot;
##  - attr(*, &quot;names.stat&quot;)= chr &quot;X-squared&quot;
##  - attr(*, &quot;parameter&quot;)= Named num 5
##   ..- attr(*, &quot;names&quot;)= chr &quot;df&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="calgen.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div>
<pre><code>## Proportion of rejections:
##    1%    5%   10%   25%   50% 
## 0.013 0.054 0.096 0.255 0.544</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="calgen.html#cb87-1" aria-hidden="true" tabindex="-1"></a>old.par <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb87-2"><a href="calgen.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rephtest"></span>
<img src="02-Generacion_numeros_aleatorios_files/figure-html/rephtest-1.png" alt="Distribución de los p-valores y proporción de rechazos." width="90%" />
<p class="caption">
Figura 2.11: Distribución de los p-valores y proporción de rechazos.
</p>
</div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="calgen.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(old.par)</span></code></pre></div>
</div>
<!-- 
Ejercicio: repetir el ejemplo anterior empleando runif()
-->
</div>
<div id="baterias" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Baterías de contrastes<a href="calgen.html#baterias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hay numerosos ejemplos de generadores que pasaron diferentes test de uniformidad y aleatoriedad pero que fallaron estrepitosamente al considerar nuevos contrastes diseñados específicamente para generadores aleatorios <span class="citation">(ver <a href="#ref-marsaglia1990" role="doc-biblioref">Marsaglia et al., 1990</a>)</span>.
Por este motivo, el procedimiento habitual en la práctica es aplicar un número más o menos elevado de contrastes <span class="citation">(de distinto tipo y difíciles de pasar, e.g. <a href="#ref-marsaglia2002" role="doc-biblioref">Marsaglia y Tsang, 2002</a>)</span>, de forma que si el generador los pasa tendremos mayor confianza en que sus propiedades son las adecuadas.
Este conjunto de pruebas es lo que se denomina batería de contrastes. Una de las primeras se introdujo en <span class="citation">Knuth (<a href="#ref-knuth1969" role="doc-biblioref">1969</a>)</span> y de las más recientes podríamos destacar:</p>
<ul>
<li><p>Diehard tests (The Marsaglia Random Number <a href="https://ani.stat.fsu.edu/diehard">CDROM</a>, 1995):
<a href="https://web.archive.org/web/20160125103112/http://stat.fsu.edu/pub/diehard">http://www.stat.fsu.edu/pub/diehard (versión archivada el 2016-01-25)</a>.</p></li>
<li><p>Dieharder (Brown y Bauer, 2003):
<a href="https://webhome.phy.duke.edu/~rgb/General/dieharder.php">Dieharder Page</a>,
paquete <a href="https://github.com/eddelbuettel/rdieharder"><code>RDieHarder</code></a>.</p></li>
<li><p>TestU01 <span class="citation">(<a href="#ref-lecuyer07" role="doc-biblioref">L’Ecuyer y Simard, 2007</a>)</span>:
<a href="http://simul.iro.umontreal.ca/testu01/tu01.html">http://simul.iro.umontreal.ca/testu01/tu01.html</a>.</p></li>
<li><p>NIST test suite <span class="citation">(National Institute of Standards and Technology, Cryptographic Technology Group, <a href="#ref-nistsp2010" role="doc-biblioref">Bassham et al., 2010</a>)</span>:
<a href="https://csrc.nist.gov/Projects/random-bit-generation/Documentation-and-Software">https://csrc.nist.gov/projects/random-bit-generation</a>.</p></li>
</ul>
<p>Para más detalles, ver por ejemplo <span class="citation">Marsaglia y Tsang (<a href="#ref-marsaglia2002" role="doc-biblioref">2002</a>)</span> o <span class="citation">Demirhan y Bitirim (<a href="#ref-demirhan2016" role="doc-biblioref">2016</a>)</span><a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>.</p>
<!-- 
-  Marsaglia, G. y Tsang, W.W. (2002). [Some difficult-to-pass tests of randomness](http://www.jstatsoft.org/v07/i03). Journal of Statistical Software, 7(3), 1-9. 
  
-  Demirhan, H. y Bitirim, N. (2016). [CryptRndTest: an R package for testing the cryptographic randomness](https://journal.r-project.org/archive/2016/RJ-2016-016/index.html). The R Journal, 8(1), 233-247.
-->
<p>Estas baterías de contrastes se suelen emplear si el generador va a ser utilizado en criptografía o si es muy importante la impredecibilidad (normalmente con generadores de números “verdaderamente aleatorios” por hardware).
Si el objetivo es únicamente obtener resultados estadísticos (como en nuestro caso) no sería tan importante que el generador no superase alguno de estos test.</p>
</div>
</div>
<h3>Bibliografía<a href="bibliografía.html#bibliografía" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-nistsp2010" class="csl-entry">
Bassham, L., Rukhin, A., Soto, J., Nechvatal, J., Smid, M., Leigh, S., Levenson, M., Vangel, M., Heckert, N., y Banks, D. (2010). <em>A Statistical Test Suite for Random and Pseudorandom Number Generators for Cryptographic Applications</em>. Special Publication (NIST SP), National Institute of Standards; Technology, Gaithersburg, MD. <a href="https://doi.org/10.6028/NIST.SP.800-22r1a">https://doi.org/10.6028/NIST.SP.800-22r1a</a>
</div>
<div id="ref-demirhan2016" class="csl-entry">
Demirhan, H., y Bitirim, N. (2016). <span>CryptRndTest</span>: An R Package for Testing the Cryptographic Randomness. <em>The R Journal</em>, <em>8</em>(1), 233-247. <a href="https://doi.org/10.32614/rj-2016-016">https://doi.org/10.32614/rj-2016-016</a>
</div>
<div id="ref-knuth1969" class="csl-entry">
Knuth, D. E. (1969). <em>The Art of Computer Programming: Semi-numerical algorithms</em> (Vol. 2). Addison-Wesley. <a href="https://www-cs-faculty.stanford.edu/~knuth/taocp.html">https://www-cs-faculty.stanford.edu/~knuth/taocp.html</a>
</div>
<div id="ref-lecuyer07" class="csl-entry">
L’Ecuyer, P., y Simard, R. (2007). <span>TestU</span>01. <em><span>ACM</span> Transactions on Mathematical Software</em>, <em>33</em>(4), 1-40. <a href="https://doi.org/10.1145/1268776.1268777">https://doi.org/10.1145/1268776.1268777</a>
</div>
<div id="ref-marsaglia2002" class="csl-entry">
Marsaglia, G., y Tsang, W. W. (2002). Some Difficult-to-Pass Tests of Randomness. <em>Journal of Statistical Software</em>, <em>7</em>(3). <a href="https://doi.org/10.18637/jss.v007.i03">https://doi.org/10.18637/jss.v007.i03</a>
</div>
<div id="ref-marsaglia1990" class="csl-entry">
Marsaglia, G., Zaman, A., y Tsang, W. W. (1990). Toward a universal random number generator. <em>Statistics &amp; Probability Letters</em>, <em>9</em>(1), 35-39. <a href="https://doi.org/10.1016/0167-7152(90)90092-l">https://doi.org/10.1016/0167-7152(90)90092-l</a>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>También puede ser de interés el enlace <a href="http://www.ciphersbyritter.com/RES/RANDTEST.HTM">Randomness Tests: A Literature Survey</a> y la entidad certificadora (gratuita) en línea <a href="http://www.cacert.at/random">CAcert</a>.<a href="calgen.html#fnref11" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ext-cong.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ejercicios-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/rubenfcasal/simbook/edit/master/02-Generacion_numeros_aleatorios.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Simulacion.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
