<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.2 Método de aceptación rechazo | Simulación Estadística</title>
  <meta name="description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="5.2 Método de aceptación rechazo | Simulación Estadística" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rubenfcasal/simbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.2 Método de aceptación rechazo | Simulación Estadística" />
  
  <meta name="twitter:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén Fernández Casal (ruben.fcasal@udc.es), Ricardo Cao (rcao@udc.es)" />


<meta name="date" content="2022-03-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="método-de-inversión.html"/>
<link rel="next" href="modificaciones-del-método-de-aceptación-rechazo.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simulación Estadística</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="cap1.html"><a href="cap1.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a>
<ul>
<li class="chapter" data-level="1.1" data-path="conceptos-básicos.html"><a href="conceptos-básicos.html"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="conceptos-básicos.html"><a href="conceptos-básicos.html#ventajas-e-inconvenientes-de-la-simulación"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas e inconvenientes de la simulación</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="aplicaciones-de-la-simulación.html"><a href="aplicaciones-de-la-simulación.html"><i class="fa fa-check"></i><b>1.2</b> Aplicaciones de la simulación</a></li>
<li class="chapter" data-level="1.3" data-path="números-aleatorios-puros.html"><a href="números-aleatorios-puros.html"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a></li>
<li class="chapter" data-level="1.4" data-path="generación-de-números-aleatorios-mediante-software.html"><a href="generación-de-números-aleatorios-mediante-software.html"><i class="fa fa-check"></i><b>1.4</b> Generación de números “aleatorios” mediante software</a></li>
<li class="chapter" data-level="1.5" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>1.5</b> Números pseudoaleatorios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rrng.html"><a href="rrng.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="opciones.html"><a href="opciones.html"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="paquetes-de-r.html"><a href="paquetes-de-r.html"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cap3.html"><a href="cap3.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gen-cong.html"><a href="gen-cong.html"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales lineales</a></li>
<li class="chapter" data-level="3.2" data-path="extensiones.html"><a href="extensiones.html"><i class="fa fa-check"></i><b>3.2</b> Extensiones</a></li>
<li class="chapter" data-level="3.3" data-path="calgen.html"><a href="calgen.html"><i class="fa fa-check"></i><b>3.3</b> Análisis de la calidad de un generador</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="calgen.html"><a href="calgen.html#repetición-de-contrastes"><i class="fa fa-check"></i><b>3.3.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.3.2" data-path="calgen.html"><a href="calgen.html#baterias"><i class="fa fa-check"></i><b>3.3.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>3.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cap4.html"><a href="cap4.html"><i class="fa fa-check"></i><b>4</b> Análisis de resultados de simulación</a>
<ul>
<li class="chapter" data-level="4.1" data-path="convergencia.html"><a href="convergencia.html"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="convergencia.html"><a href="convergencia.html#detección-de-problemas-de-convergencia"><i class="fa fa-check"></i><b>4.1.1</b> Detección de problemas de convergencia</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="estimación-de-la-precisión.html"><a href="estimación-de-la-precisión.html"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="teorema-central-del-límite.html"><a href="teorema-central-del-límite.html"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="determinación-del-número-de-generaciones.html"><a href="determinación-del-número-de-generaciones.html"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="observaciones.html"><a href="observaciones.html"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sim-con.html"><a href="sim-con.html"><i class="fa fa-check"></i><b>5</b> Simulación de variables continuas</a>
<ul>
<li class="chapter" data-level="5.1" data-path="método-de-inversión.html"><a href="método-de-inversión.html"><i class="fa fa-check"></i><b>5.1</b> Método de inversión</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="método-de-inversión.html"><a href="método-de-inversión.html#algunas-distribuciones-que-pueden-simularse-por-el-método-de-inversión"><i class="fa fa-check"></i><b>5.1.1</b> Algunas distribuciones que pueden simularse por el método de inversión</a></li>
<li class="chapter" data-level="5.1.2" data-path="método-de-inversión.html"><a href="método-de-inversión.html#ventajas-e-inconvenientes"><i class="fa fa-check"></i><b>5.1.2</b> Ventajas e inconvenientes</a></li>
<li class="chapter" data-level="5.1.3" data-path="método-de-inversión.html"><a href="método-de-inversión.html#inversión-aproximada"><i class="fa fa-check"></i><b>5.1.3</b> Inversión aproximada</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>5.2</b> Método de aceptación rechazo</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="AR.html"><a href="AR.html#algoritmo"><i class="fa fa-check"></i><b>5.2.1</b> Algoritmo</a></li>
<li class="chapter" data-level="5.2.2" data-path="AR.html"><a href="AR.html#densidades-acotadas-en-un-intervalo-cerrado"><i class="fa fa-check"></i><b>5.2.2</b> Densidades acotadas en un intervalo cerrado</a></li>
<li class="chapter" data-level="5.2.3" data-path="AR.html"><a href="AR.html#eficiencia-del-algoritmo"><i class="fa fa-check"></i><b>5.2.3</b> Eficiencia del algoritmo</a></li>
<li class="chapter" data-level="5.2.4" data-path="AR.html"><a href="AR.html#ejemplo-inferencia-bayesiana"><i class="fa fa-check"></i><b>5.2.4</b> Ejemplo: Inferencia Bayesiana</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html"><i class="fa fa-check"></i><b>5.3</b> Modificaciones del método de aceptación rechazo</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html#muestreo-por-rechazo-adaptativo-ars"><i class="fa fa-check"></i><b>5.3.1</b> Muestreo por rechazo adaptativo (ARS)</a></li>
<li class="chapter" data-level="5.3.2" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html#método-del-cociente-de-uniformes"><i class="fa fa-check"></i><b>5.3.2</b> Método del cociente de uniformes</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="composicion.html"><a href="composicion.html"><i class="fa fa-check"></i><b>5.4</b> Método de composición (o de simulación condicional)</a></li>
<li class="chapter" data-level="5.5" data-path="notables-cont.html"><a href="notables-cont.html"><i class="fa fa-check"></i><b>5.5</b> Métodos específicos para la generación de algunas distribuciones notables</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="notables-cont.html"><a href="notables-cont.html#método-de-box-müller"><i class="fa fa-check"></i><b>5.5.1</b> Método de Box-Müller</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="discretas.html"><a href="discretas.html"><i class="fa fa-check"></i><b>6</b> Simulación de variables discretas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="método-de-la-transformación-cuantil.html"><a href="método-de-la-transformación-cuantil.html"><i class="fa fa-check"></i><b>6.1</b> Método de la transformación cuantil</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="método-de-la-transformación-cuantil.html"><a href="método-de-la-transformación-cuantil.html#eficiencia-del-algoritmo-1"><i class="fa fa-check"></i><b>6.1.1</b> Eficiencia del algoritmo</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="método-de-la-tabla-guía.html"><a href="método-de-la-tabla-guía.html"><i class="fa fa-check"></i><b>6.2</b> Método de la tabla guía</a></li>
<li class="chapter" data-level="6.3" data-path="alias.html"><a href="alias.html"><i class="fa fa-check"></i><b>6.3</b> Método de Alias</a></li>
<li class="chapter" data-level="6.4" data-path="simulación-de-una-variable-discreta-con-dominio-infinito.html"><a href="simulación-de-una-variable-discreta-con-dominio-infinito.html"><i class="fa fa-check"></i><b>6.4</b> Simulación de una variable discreta con dominio infinito</a></li>
<li class="chapter" data-level="6.5" data-path="cálculo-directo-de-la-función-cuantil.html"><a href="cálculo-directo-de-la-función-cuantil.html"><i class="fa fa-check"></i><b>6.5</b> Cálculo directo de la función cuantil</a></li>
<li class="chapter" data-level="6.6" data-path="otros-métodos.html"><a href="otros-métodos.html"><i class="fa fa-check"></i><b>6.6</b> Otros métodos</a></li>
<li class="chapter" data-level="6.7" data-path="notables-disc.html"><a href="notables-disc.html"><i class="fa fa-check"></i><b>6.7</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulación-de-distribuciones-multivariantes.html"><a href="simulación-de-distribuciones-multivariantes.html"><i class="fa fa-check"></i><b>7</b> Simulación de distribuciones multivariantes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulación-de-componentes-independientes.html"><a href="simulación-de-componentes-independientes.html"><i class="fa fa-check"></i><b>7.1</b> Simulación de componentes independientes</a></li>
<li class="chapter" data-level="7.2" data-path="el-método-de-aceptaciónrechazo.html"><a href="el-método-de-aceptaciónrechazo.html"><i class="fa fa-check"></i><b>7.2</b> El método de aceptación/rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="fact-cov.html"><a href="fact-cov.html"><i class="fa fa-check"></i><b>7.3</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="7.4" data-path="distrcond.html"><a href="distrcond.html"><i class="fa fa-check"></i><b>7.4</b> Método de las distribuciones condicionadas</a></li>
<li class="chapter" data-level="7.5" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html"><i class="fa fa-check"></i><b>7.5</b> Simulación condicional e incondicional</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#condnormal"><i class="fa fa-check"></i><b>7.5.1</b> Simulación condicional de una normal multivariante</a></li>
<li class="chapter" data-level="7.5.2" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#simulación-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>7.5.2</b> Simulación condicional a partir de un modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html"><i class="fa fa-check"></i><b>7.6</b> Simulación basada en cópulas</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#cópulas-arquimedianas"><i class="fa fa-check"></i><b>7.6.1</b> Cópulas Arquimedianas</a></li>
<li class="chapter" data-level="7.6.2" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#simulación"><i class="fa fa-check"></i><b>7.6.2</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="mult-discr.html"><a href="mult-discr.html"><i class="fa fa-check"></i><b>7.7</b> Simulación de distribuciones multivariantes discretas</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="mult-discr.html"><a href="mult-discr.html#métodos-de-codificación-o-etiquetado-para-variables-discretas"><i class="fa fa-check"></i><b>7.7.1</b> Métodos de codificación o etiquetado para variables discretas</a></li>
<li class="chapter" data-level="7.7.2" data-path="mult-discr.html"><a href="mult-discr.html#simulación-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>7.7.2</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="7.7.3" data-path="mult-discr.html"><a href="mult-discr.html#simconting"><i class="fa fa-check"></i><b>7.7.3</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cap8.html"><a href="cap8.html"><i class="fa fa-check"></i><b>8</b> Aplicaciones en Inferencia Estadística</a>
<ul>
<li class="chapter" data-level="8.1" data-path="distribución-en-el-muestreo.html"><a href="distribución-en-el-muestreo.html"><i class="fa fa-check"></i><b>8.1</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="8.2" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>8.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="8.3" data-path="contrastes.html"><a href="contrastes.html"><i class="fa fa-check"></i><b>8.3</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="8.4" data-path="comparación-de-estimadores.html"><a href="comparación-de-estimadores.html"><i class="fa fa-check"></i><b>8.4</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="8.5" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>8.5</b> Remuestreo Bootstrap</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="bootstrap.html"><a href="bootstrap.html#idea"><i class="fa fa-check"></i><b>8.5.1</b> Idea:</a></li>
<li class="chapter" data-level="8.5.2" data-path="bootstrap.html"><a href="bootstrap.html#métodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>8.5.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="8.5.3" data-path="bootstrap.html"><a href="bootstrap.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>8.5.3</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="8.5.4" data-path="bootstrap.html"><a href="bootstrap.html#gráficos"><i class="fa fa-check"></i><b>8.5.4</b> Gráficos</a></li>
<li class="chapter" data-level="8.5.5" data-path="bootstrap.html"><a href="bootstrap.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>8.5.5</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cap9.html"><a href="cap9.html"><i class="fa fa-check"></i><b>9</b> Integración y Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="integración-monte-carlo-clásica.html"><a href="integración-monte-carlo-clásica.html"><i class="fa fa-check"></i><b>9.1</b> Integración Monte Carlo (clásica)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="integración-monte-carlo-clásica.html"><a href="integración-monte-carlo-clásica.html#caso-general"><i class="fa fa-check"></i><b>9.1.1</b> Caso general</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html"><i class="fa fa-check"></i><b>9.2</b> Muestreo por importancia</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>9.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="optimización-monte-carlo.html"><a href="optimización-monte-carlo.html"><i class="fa fa-check"></i><b>9.3</b> Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="optimización-monte-carlo.html"><a href="optimización-monte-carlo.html#algoritmos-de-optimización-monte-carlo"><i class="fa fa-check"></i><b>9.3.1</b> Algoritmos de optimización Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="temple-simulado.html"><a href="temple-simulado.html"><i class="fa fa-check"></i><b>9.4</b> Temple simulado</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="temple-simulado.html"><a href="temple-simulado.html#algoritmo-1"><i class="fa fa-check"></i><b>9.4.1</b> Algoritmo:</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="algoritmos-genéticos.html"><a href="algoritmos-genéticos.html"><i class="fa fa-check"></i><b>9.5</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="técnicas-de-reducción-de-la-varianza.html"><a href="técnicas-de-reducción-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a>
<ul>
<li class="chapter" data-level="10.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html"><i class="fa fa-check"></i><b>10.1</b> Variables antitéticas</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#ejemplo-integración-monte-carlo"><i class="fa fa-check"></i><b>10.1.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.1.2" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#generación-de-variables-antitéticas"><i class="fa fa-check"></i><b>10.1.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="estratificación.html"><a href="estratificación.html"><i class="fa fa-check"></i><b>10.2</b> Estratificación</a></li>
<li class="chapter" data-level="10.3" data-path="variables-de-control.html"><a href="variables-de-control.html"><i class="fa fa-check"></i><b>10.3</b> Variables de control</a></li>
<li class="chapter" data-level="10.4" data-path="números-aleatorios-comunes.html"><a href="números-aleatorios-comunes.html"><i class="fa fa-check"></i><b>10.4</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.5" data-path="ejercicios-2.html"><a href="ejercicios-2.html"><i class="fa fa-check"></i><b>10.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-básica.html"><a href="bibliografía-básica.html"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html"><i class="fa fa-check"></i>Bibliografía complementaria</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html#libros"><i class="fa fa-check"></i>Libros</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html#artículos"><i class="fa fa-check"></i>Artículos</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>A</b> Enlaces</a></li>
<li class="chapter" data-level="B" data-path="gof-aleat.html"><a href="gof-aleat.html"><i class="fa fa-check"></i><b>B</b> Bondad de Ajuste y Aleatoriedad</a>
<ul>
<li class="chapter" data-level="B.1" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i><b>B.1</b> Métodos de bondad de ajuste</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="gof.html"><a href="gof.html#histograma"><i class="fa fa-check"></i><b>B.1.1</b> Histograma</a></li>
<li class="chapter" data-level="B.1.2" data-path="gof.html"><a href="gof.html#empdistr"><i class="fa fa-check"></i><b>B.1.2</b> Función de distribución empírica</a></li>
<li class="chapter" data-level="B.1.3" data-path="gof.html"><a href="gof.html#gráficos-p-p-y-q-q"><i class="fa fa-check"></i><b>B.1.3</b> Gráficos P-P y Q-Q</a></li>
<li class="chapter" data-level="B.1.4" data-path="gof.html"><a href="gof.html#chi2test"><i class="fa fa-check"></i><b>B.1.4</b> Contraste chi-cuadrado de Pearson</a></li>
<li class="chapter" data-level="B.1.5" data-path="gof.html"><a href="gof.html#ks-test"><i class="fa fa-check"></i><b>B.1.5</b> Contraste de Kolmogorov-Smirnov</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="diag-aleat.html"><a href="diag-aleat.html"><i class="fa fa-check"></i><b>B.2</b> Diagnosis de la independencia</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="diag-aleat.html"><a href="diag-aleat.html#métodos-para-detectar-dependencia"><i class="fa fa-check"></i><b>B.2.1</b> Métodos para detectar dependencia</a></li>
<li class="chapter" data-level="B.2.2" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-secuencial"><i class="fa fa-check"></i><b>B.2.2</b> Gráfico secuencial</a></li>
<li class="chapter" data-level="B.2.3" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-de-dispersion-retardado"><i class="fa fa-check"></i><b>B.2.3</b> Gráfico de dispersion retardado</a></li>
<li class="chapter" data-level="B.2.4" data-path="diag-aleat.html"><a href="diag-aleat.html#el-correlograma"><i class="fa fa-check"></i><b>B.2.4</b> El correlograma</a></li>
<li class="chapter" data-level="B.2.5" data-path="diag-aleat.html"><a href="diag-aleat.html#test-de-rachas"><i class="fa fa-check"></i><b>B.2.5</b> Test de rachas</a></li>
<li class="chapter" data-level="B.2.6" data-path="diag-aleat.html"><a href="diag-aleat.html#el-contraste-de-ljung-box"><i class="fa fa-check"></i><b>B.2.6</b> El contraste de Ljung-Box</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html"><i class="fa fa-check"></i><b>B.3</b> Contrastes específicos para generadores aleatorios</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-frecuencias"><i class="fa fa-check"></i><b>B.3.1</b> Contraste de frecuencias</a></li>
<li class="chapter" data-level="B.3.2" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-series"><i class="fa fa-check"></i><b>B.3.2</b> Contraste de series</a></li>
<li class="chapter" data-level="B.3.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-poker"><i class="fa fa-check"></i><b>B.3.3</b> El contraste del poker</a></li>
<li class="chapter" data-level="B.3.4" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-coleccionista"><i class="fa fa-check"></i><b>B.3.4</b> El contraste del coleccionista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="int-num.html"><a href="int-num.html"><i class="fa fa-check"></i><b>C</b> Integración numérica</a>
<ul>
<li class="chapter" data-level="C.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html"><i class="fa fa-check"></i><b>C.1</b> Integración numérica unidimensional</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#método-del-trapezoide"><i class="fa fa-check"></i><b>C.1.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="C.1.2" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#regla-de-simpson"><i class="fa fa-check"></i><b>C.1.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="C.1.3" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>C.1.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="C.1.4" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#comandos-de-r"><i class="fa fa-check"></i><b>C.1.4</b> Comandos de R</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html"><i class="fa fa-check"></i><b>C.2</b> Integración numérica bidimensional</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#representación-gráfica"><i class="fa fa-check"></i><b>C.2.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="C.2.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#método-del-trapezoide-1"><i class="fa fa-check"></i><b>C.2.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="C.2.3" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#comandos-de-r-1"><i class="fa fa-check"></i><b>C.2.3</b> Comandos de R</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulación Estadística</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="AR" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Método de aceptación rechazo</h2>
<p>Se trata de un método universal alternativo al de inversión para
el caso de que no se pueda emplear la función cuantil,
pero se dispone de una expresión (preferiblemente sencilla) para la
función de densidad <span class="math inline">\(f\left( x \right)\)</span>.</p>
<p>Si <span class="math inline">\(f\)</span> es la densidad objetivo, la idea es simular una variable aleatoria
bidimensional <span class="math inline">\(\left( X, Y\right)\)</span> con distribución
uniforme en el hipografo de <span class="math inline">\(f\)</span> (el conjunto de puntos del plano
comprendidos entre el eje OX y <span class="math inline">\(f\)</span>):
<span class="math display">\[A_{f}=\left\{ \left( x,y\right) \in \mathbb{R}^{2}:0\leq y\leq
f(x) \right\}.\]</span>
De esta forma la primera componente tendrá la distribución deseada:</p>
<p><img src="images/rechazo.png" width="70%" style="display: block; margin: auto;" /></p>
<p><span class="math display">\[ P\left( a&lt;X&lt;b\right) = \frac{\text{Area de }\left\{ \left( x,y\right) \in 
\mathbb{R}^{2}:a&lt;x&lt;b;~0\leq y\leq f(x) \right\} }{\text{Area de }
A_{f}} \\
= \int_{a}^{b}f(x) dx \]</span></p>
<p>El resultado anterior es también válido para una cuasi-densidad <span class="math inline">\(f^{\ast}\)</span>
(no depende de la constante normalizadora).
El resultado general sería en siguiente:</p>
<ul>
<li><p>Si <span class="math inline">\(X\)</span> es una variable aleatoria con función de densidad <span class="math inline">\(f\)</span>
y <span class="math inline">\(U \sim \mathcal{U}(0, 1)\)</span> entonces
<span class="math display">\[\left( X,c\cdot U\cdot f(x) \right) \sim \mathcal{U}\left(
A_{cf}\right)\]</span>
siendo
<span class="math inline">\(A_{cf}=\left\{ \left( x, y \right) \in \mathbb{R}^{2} : 0 \leq y \leq cf\left( x \right) \right\}\)</span>.</p></li>
<li><p>Recíprocamente si <span class="math inline">\(\left( X,Y\right) \sim \mathcal{U}\left(A_{cf}\right)\)</span> entonces<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> <span class="math inline">\(X\sim f\)</span>.</p></li>
</ul>
<p>Para generar valores de una variable aleatoria bidimensional con distribución uniforme
en <span class="math inline">\(A_{f}\)</span> (o en <span class="math inline">\(A_{f^{\ast }}\)</span>), se emplea el resultado anterior para
generar valores en <span class="math inline">\(A_{cg} \supset A_{f}\)</span>, siendo <span class="math inline">\(g\)</span> una densidad auxiliar
(preferiblemente fácil de simular y similar a <span class="math inline">\(f\)</span>).
Teniendo en cuenta además que:</p>
<ul>
<li>Si <span class="math inline">\(\left( X,Y\right) \sim \mathcal{U}\left( A\right)\)</span> y
<span class="math inline">\(B \subset A\Rightarrow \left. \left( X,Y\right) \right\vert _{B} \sim \mathcal{U}\left(B\right)\)</span></li>
</ul>
<p>Por tanto, si <span class="math inline">\(\left( T, Y \right)\)</span> sigue una distribución
uniforme en <span class="math inline">\(A_{cg}\)</span>, aceptando los valores de
<span class="math inline">\(\left( T, Y\right)\)</span> que pertenezcan a <span class="math inline">\(A_{f}\)</span> (o a <span class="math inline">\(A_{f^{\ast }}\)</span>) se obtendrán
generaciones con distribución uniforme sobre <span class="math inline">\(A_{f}\)</span> (o <span class="math inline">\(A_{f^{\ast }}\)</span>)
y la densidad de la primera componente <span class="math inline">\(T\)</span> será <span class="math inline">\(f\)</span>.</p>
<div id="algoritmo" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Algoritmo</h3>
<p>Supongamos que <span class="math inline">\(f\)</span> es la densidad objetivo y <span class="math inline">\(g\)</span> es una densidad
auxiliar (fácil de simular y similar a <span class="math inline">\(f\)</span>), de forma que
existe una constante <span class="math inline">\(c&gt;0\)</span> tal que:
<span class="math display">\[f(x) \leq c\cdot g(x) 
\text{, }\forall x\in \mathbb{R}\text{.}\]</span></p>

<div class="conjecture">
<p><span id="cnj:aceptacion-rechazo" class="conjecture"><strong>Algoritmo 5.3  (Método de aceptación-rechazo; Von Neuman, 1951)  </strong></span></p>
<ol style="list-style-type: decimal">
<li><p>Generar <span class="math inline">\(U \sim \mathcal{U}(0, 1)\)</span>.</p></li>
<li><p>Generar <span class="math inline">\(T\sim g\)</span>.</p></li>
<li><p>Si <span class="math inline">\(c\cdot U\cdot g\left( T\right) \leq f\left( T\right)\)</span>
devolver <span class="math inline">\(X=T\)</span>,</p>
<p>en caso contrario volver al paso 1.</p></li>
</ol>
</div>
<!-- \@ref(cnj:aceptacion-rechazo) -->
</div>
<div id="densidades-acotadas-en-un-intervalo-cerrado" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Densidades acotadas en un intervalo cerrado</h3>
<p>Sea <span class="math inline">\(f\)</span> una función de densidad cualquiera con soporte en un intervalo cerrado <span class="math inline">\([a,b]\)</span> (es decir, <span class="math inline">\(\{x : f(x) &gt; 0\}=[a,b]\)</span>) de tal forma que existe una constante <span class="math inline">\(M&gt;0\)</span> tal que <span class="math inline">\(f(x) \leq M\)</span> <span class="math inline">\(\forall x\)</span> (es decir, <span class="math inline">\(f\)</span> es acotada superiormente).
En este caso puede tomarse como densidad auxiliar <span class="math inline">\(g\)</span>, la de una <span class="math inline">\(\mathcal{U}(a,b)\)</span>.
En efecto, tomando <span class="math inline">\(c = M\left( b-a\right)\)</span> y teniendo en cuenta que
<span class="math display">\[g(x) = \left\{
\begin{array}{ll}\frac{1}{b-a} &amp; \text{si } x \in [a,b]\\
0 &amp; \text{en caso contrario}
\end{array} \right.\]</span>
se tiene que <span class="math inline">\(f(x) \leq M = \frac{c}{b-a}=c \cdot g(x)\)</span>,
<span class="math inline">\(\forall x \in [a,b]\)</span>.
Así pues, el algoritmo quedaría como sigue:</p>
<ol style="list-style-type: decimal">
<li><p>Generar <span class="math inline">\(U,V\sim \mathcal{U}(0, 1)\)</span>.</p></li>
<li><p>Hacer <span class="math inline">\(T = a + \left( b-a \right) V\)</span>.</p></li>
<li><p>Si <span class="math inline">\(M \cdot U\leq f\left( T \right)\)</span>
devolver <span class="math inline">\(X = T\)</span>,</p>
<p>en caso contrario volver al paso 1.</p></li>
</ol>
<p><strong>Nota</strong>: no confundir <span class="math inline">\(M\)</span> con <span class="math inline">\(c = M \left( b - a \right)\)</span>.</p>
<!-- Incluir cuentas de AR para la doble exponencial -->

<div class="exercise">
<span id="exr:dnorm-ddexp-ar" class="exercise"><strong>Ejercicio 5.2  (Simulación de la normal mediante la doble exponencial)  </strong></span>
</div>
<p>Desarrollar el código necesario para generar, por el método de
aceptación-rechazo, una muestra de <span class="math inline">\(n\)</span> observaciones de una
distribución normal estándar:
<span class="math display">\[f(x)  =\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}\text{, }x\in\mathbb{R}\text{, }\]</span>
empleando como distribución auxiliar una doble exponencial con <span class="math inline">\(\lambda=1\)</span>
(más adelante veremos que esta es la elección óptima para el parámetro de la densidad auxiliar) y que la cota óptima es:
<span class="math display">\[c_{\text{opt}}=\sqrt{\frac{2e}{\pi}} \approx 1.3155\]</span>
Para establecer la condición de aceptación o rechazo se puede tener en cuenta que:
<span class="math display">\[c\cdot U\cdot\frac{g\left( T\right)  }{f\left( T\right)  }=\sqrt{\frac
{2e}{\pi}}U\sqrt{\frac{\pi}{2}}\exp\left( \frac{T^{2}}{2}-\left\vert
T\right\vert \right)  =U\cdot\exp\left( \frac{T^{2}}{2}-\left\vert
T\right\vert +\frac{1}{2}\right) ,\]</span>
aunque en general puede ser recomendable emplear
<span class="math inline">\(c\cdot U\cdot g\left( T\right) \leq f\left( T\right)\)</span>.</p>
<p>En el código del Ejercicio <a href="método-de-inversión.html#exr:ddexp">5.1</a> se definió la densidad auxiliar <code>ddexp(x, lambda)</code> y la función <code>rdexp(lambda)</code> para generar un valor aleatorio de esta densidad.
Si comparamos la densidad objetivo con la auxiliar reescalada con los parámetros óptimos (Figura <a href="AR.html#fig:dnorm-ddexp-plot">5.4</a>), vemos que esta última está por encima, como debería ocurrir, pero llegan a tocarse (se está empleando la cota óptima; ver siguiente sección).</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="AR.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># densidad objetivo: dnorm</span></span>
<span id="cb151-2"><a href="AR.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co"># densidad auxiliar: ddexp</span></span>
<span id="cb151-3"><a href="AR.html#cb151-3" aria-hidden="true" tabindex="-1"></a>c.opt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">/</span>pi)</span>
<span id="cb151-4"><a href="AR.html#cb151-4" aria-hidden="true" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb151-5"><a href="AR.html#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(c.opt <span class="sc">*</span> <span class="fu">ddexp</span>(x), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb151-6"><a href="AR.html#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x), <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dnorm-ddexp-plot"></span>
<img src="05-Metodos_generales_continuas_files/figure-html/dnorm-ddexp-plot-1.png" alt="Densidad objetivo (normal estándar) y densidad auxiliar (doble exponencial) reescalada." width="70%" />
<p class="caption">
Figura 5.4: Densidad objetivo (normal estándar) y densidad auxiliar (doble exponencial) reescalada.
</p>
</div>
<p>Para generar los valores de la densidad objetivo podríamos emplear el siguiente código:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="AR.html#cb152-1" aria-hidden="true" tabindex="-1"></a>ngen <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb152-2"><a href="AR.html#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="AR.html#cb152-3" aria-hidden="true" tabindex="-1"></a>rnormAR <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb152-4"><a href="AR.html#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación por aceptación-rechazo</span></span>
<span id="cb152-5"><a href="AR.html#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal estandar a partir de doble exponencial</span></span>
<span id="cb152-6"><a href="AR.html#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb152-7"><a href="AR.html#cb152-7" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb152-8"><a href="AR.html#cb152-8" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rdexp</span>(lambda.opt) <span class="co"># rdexpn(1, lambda.opt)</span></span>
<span id="cb152-9"><a href="AR.html#cb152-9" aria-hidden="true" tabindex="-1"></a>    ngen <span class="ot">&lt;&lt;-</span> ngen <span class="sc">+</span> <span class="dv">1</span> <span class="co"># Comentar esta línea para uso normal</span></span>
<span id="cb152-10"><a href="AR.html#cb152-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if (U*exp((X^2+1)*0.5-abs(X)) &lt;= 1) return(X)</span></span>
<span id="cb152-11"><a href="AR.html#cb152-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (c.opt <span class="sc">*</span> U <span class="sc">*</span> <span class="fu">ddexp</span>(X, lambda.opt) <span class="sc">&lt;=</span> <span class="fu">dnorm</span>(X)) <span class="fu">return</span>(X)</span>
<span id="cb152-12"><a href="AR.html#cb152-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb152-13"><a href="AR.html#cb152-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb152-14"><a href="AR.html#cb152-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-15"><a href="AR.html#cb152-15" aria-hidden="true" tabindex="-1"></a>rnormARn <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb152-16"><a href="AR.html#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación n valores N(0,1)</span></span>
<span id="cb152-17"><a href="AR.html#cb152-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb152-18"><a href="AR.html#cb152-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) x[i] <span class="ot">&lt;-</span> <span class="fu">rnormAR</span>()</span>
<span id="cb152-19"><a href="AR.html#cb152-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb152-20"><a href="AR.html#cb152-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb152-21"><a href="AR.html#cb152-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-22"><a href="AR.html#cb152-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafico</span></span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Generar una muestra de <span class="math inline">\(10^{4}\)</span> observaciones empleando este
algoritmo. Obtener el tiempo de CPU y calcular el número medio
de generaciones de la distribución auxiliar.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="AR.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb153-2"><a href="AR.html#cb153-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb153-3"><a href="AR.html#cb153-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-4"><a href="AR.html#cb153-4" aria-hidden="true" tabindex="-1"></a>ngen <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb153-5"><a href="AR.html#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(x <span class="ot">&lt;-</span> <span class="fu">rnormARn</span>(nsim))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.11    0.00    0.10</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="AR.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nº generaciones</span></span>
<span id="cb155-2"><a href="AR.html#cb155-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb155-3"><a href="AR.html#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Número de generaciones = &quot;</span>, ngen)</span>
<span id="cb155-4"><a href="AR.html#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Número medio de generaciones = &quot;</span>, ngen<span class="sc">/</span>nsim)</span>
<span id="cb155-5"><a href="AR.html#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Proporción de rechazos = &quot;</span>, <span class="dv">1</span><span class="sc">-</span>nsim<span class="sc">/</span>ngen, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb155-6"><a href="AR.html#cb155-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Número de generaciones =  13163
## Número medio de generaciones =  1.3163
## Proporción de rechazos =  0.2402948</code></pre></li>
<li><p>Representar el histograma y compararlo con la densidad teórica.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="AR.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="st">&quot;FD&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb157-2"><a href="AR.html#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(dnorm, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dnorm-ar"></span>
<img src="05-Metodos_generales_continuas_files/figure-html/dnorm-ar-1.png" alt="Distribución de los valores generados mediante el método de aceptación-rechazo." width="70%" />
<p class="caption">
Figura 5.5: Distribución de los valores generados mediante el método de aceptación-rechazo.
</p>
</div>
<p>Podemos observar que la distribución de los valores generados es la que cabría esperar de una muestra de tamaño <code>nsim</code> de la distribución objetivo (lo que nos ayudaría a confirmar que el algoritmo está bien implementado, al ser un método exacto de simulación).</p></li>
</ol>
</div>
<div id="eficiencia-del-algoritmo" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Eficiencia del algoritmo</h3>
<p>Como medida de la eficiencia del algoritmo de aceptación-rechazo
podríamos considerar el número de iteraciones del algoritmo,
es decir, el número de generaciones de la densidad auxiliar y
de comparaciones para aceptar un valor de la densidad objetivo.
Este número <span class="math inline">\(N\)</span> es aleatorio y sigue una distribución geométrica
(número de pruebas necesarias hasta obtener el primer éxito)
con parámetro <span class="math inline">\(p\)</span> (probabilidad de éxito) la probabilidad de aceptación
en el paso 3:
<span class="math display">\[p = \frac{\text{area}\left(
        A_{f}\right) }{\text{area}\left( A_{cg}\right) }=\frac{1}{c}.\]</span>
Por tanto:
<span class="math display">\[E\left( N \right) = \frac1p = c\]</span>
es el número medio de iteraciones del algoritmo
(el número medio de pares de variables <span class="math inline">\(\left( T,U\right)\)</span>
que se necesitan generar, y de comparaciones, para obtener
una simulación de la densidad objetivo).</p>
<p>Es obvio, por tanto, que cuanto más cercano a 1 sea el valor de <span class="math inline">\(c\)</span> más eficiente será el algoritmo (el caso de <span class="math inline">\(c=1\)</span> se correspondería con <span class="math inline">\(g=f\)</span> y no tendría sentido emplear este algoritmo).
El principal problema con este método es encontrar una densidad auxiliar <span class="math inline">\(g\)</span> de forma que:
<span class="math display">\[c_{\text{opt}}=\max_{\{x : g(x) &gt;0\}}
\frac{f(x) }{g(x) }.\]</span>
sea próximo a 1.
Una solución intermedia consiste en seleccionar una familia paramétrica de densidades <span class="math inline">\(\{g_{\theta} : \theta \in \Theta\}\)</span> entre las que haya alguna que se parezca bastante a <span class="math inline">\(f\)</span>,
encontrar el valor de <span class="math inline">\(c\)</span> óptimo para cada densidad de esa familia:
<span class="math display">\[c_{\theta}=\max_{x}\frac{f\left(  x\right)  }{g_{\theta}(x) }\]</span>
y, finalmente, elegir el mejor valor <span class="math inline">\(\theta_{0}\)</span> del parámetro, en el sentido de ofrecer el menor posible <span class="math inline">\(c_{\theta}\)</span>:
<span class="math display">\[c_{\theta_{0}}=\min_{\theta\in\Theta}\max_{x}\frac{f\left(  x\right) }{g_{\theta}\left(  x\right)  }.\]</span></p>

<div class="exercise">
<span id="exr:dnorm-ddexp-arb" class="exercise"><strong>Ejercicio 5.3  (Simulación de la normal mediante la doble exponencial, continuación)  </strong></span>
</div>
<p>Continuando con el Ejercicio <a href="AR.html#exr:dnorm-ddexp-ar">5.2</a> anterior del método de aceptación-rechazo para generar observaciones de una distribución normal estándar, empleando como distribución auxiliar una doble exponencial:</p>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>Aproximar la cota óptima numéricamente.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="AR.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOTA: Cuidado con los límites</span></span>
<span id="cb158-2"><a href="AR.html#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="co"># optimize(f=function(x) dnorm(x)/ddexp(x), maximum=TRUE, interval=c(-0.5,0.5))</span></span>
<span id="cb158-3"><a href="AR.html#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize</span>(<span class="at">f =</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x)<span class="sc">/</span><span class="fu">ddexp</span>(x), <span class="at">maximum =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## $maximum
## [1] 1
## 
## $objective
## [1] 1.315489</code></pre>
<p>Vemos que la aproximación numérica coincide con el valor óptimo real <span class="math inline">\(c_{\text{opt}}=\sqrt{\frac{2e}{\pi}} \approx\)</span> 1.3154892 (que se alcanza en <span class="math inline">\(x = \pm 1\)</span>).</p></li>
<li><p>Aproximar el parámetro óptimo de la densidad auxiliar
numéricamente (normalmente comenzaríamos por este paso).</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="AR.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtención de valores c y lambda óptimos aproximados</span></span>
<span id="cb160-2"><a href="AR.html#cb160-2" aria-hidden="true" tabindex="-1"></a>fopt <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda) {</span>
<span id="cb160-3"><a href="AR.html#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Obtiene c fijado lambda</span></span>
<span id="cb160-4"><a href="AR.html#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">optimize</span>(<span class="at">f =</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x)<span class="sc">/</span><span class="fu">ddexp</span>(x,lambda),</span>
<span id="cb160-5"><a href="AR.html#cb160-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">maximum =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">$</span>objective</span>
<span id="cb160-6"><a href="AR.html#cb160-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb160-7"><a href="AR.html#cb160-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-8"><a href="AR.html#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Encontrar lambda que minimiza</span></span>
<span id="cb160-9"><a href="AR.html#cb160-9" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">optimize</span>(fopt, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>))</span>
<span id="cb160-10"><a href="AR.html#cb160-10" aria-hidden="true" tabindex="-1"></a>lambda.opt2 <span class="ot">&lt;-</span> res<span class="sc">$</span>minimum</span>
<span id="cb160-11"><a href="AR.html#cb160-11" aria-hidden="true" tabindex="-1"></a>c.opt2 <span class="ot">&lt;-</span> res<span class="sc">$</span>objective</span></code></pre></div></li>
</ol>
</div>
<div id="ejemplo-inferencia-bayesiana" class="section level3" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Ejemplo: Inferencia Bayesiana</h3>
<p>El algoritmo de Aceptación-Rechazo se emplea habitualmente en
Inferencia Bayesiana:</p>
<ul>
<li><p><span class="math inline">\(f(x|\theta )\)</span> densidad muestral.</p></li>
<li><p><span class="math inline">\(\pi (\theta )\)</span> densidad a priori.</p></li>
<li><p><span class="math inline">\(\mathbf{x}=(x_{1},...,x_n)^{\prime }\)</span> muestra observada.</p></li>
<li><p>La distribución a posteriori de <span class="math inline">\(\theta\)</span> es:
<span class="math display">\[\pi (\theta |\mathbf{x})=\frac{L(\mathbf{x}|\theta )\pi (\theta )}
{\int L(\mathbf{x}|\theta )\pi (\theta )d\theta }\]</span>
siendo <span class="math inline">\(L(\mathbf{x}|\theta )\)</span> la función de verosimilitud
(<span class="math inline">\(L(\mathbf{x}|\theta )=\prod\limits_{i=1}^{n}f(x_{i}|\theta)\)</span>
suponiendo i.i.d.). Es decir:
<span class="math display">\[\pi (\theta |\mathbf{x})\propto L(\mathbf{x}|\theta )\pi (\theta ).\]</span></p></li>
</ul>
<p>Para simular valores de la densidad a posteriori <span class="math inline">\(\pi (\theta | \mathbf{x})\)</span>
a partir de la densidad a priori <span class="math inline">\(\pi (\theta )\)</span></p>
<ul>
<li><p><span class="math inline">\(\pi (\theta |\mathbf{x})/\pi (\theta )\propto L(\mathbf{x}|\theta )\)</span></p></li>
<li><p><span class="math inline">\(L(\mathbf{x}|\theta )\leq c^{\prime }=L(\mathbf{x}|\hat{\theta})\)</span> siendo
<span class="math inline">\(\hat{\theta}\)</span> el estimador MV de <span class="math inline">\(\theta\)</span>.</p></li>
</ul>
<p>Algoritmo:</p>
<ol style="list-style-type: decimal">
<li><p>Generar <span class="math inline">\(U \sim \mathcal{U}(0, 1)\)</span>.</p></li>
<li><p>Generar <span class="math inline">\(\tilde{\theta}\sim \pi (\theta )\)</span>.</p></li>
<li><p>Si <span class="math inline">\(L(\mathbf{x}|\hat{\theta})\cdot U \leq L(\mathbf{x}|\tilde{\theta})\)</span> devolver <span class="math inline">\(\tilde{\theta}\)</span>,</p>
<p>en caso contrario volver al paso 1.</p></li>
</ol>

<div class="exercise">
<span id="exr:post-pri-ar" class="exercise"><strong>Ejercicio 5.4  (Simulación de la distribución a posteriori a partir de la distribución a priori)  </strong></span>
</div>
<p>Para la estimación Bayes de la media de una normal se suele utilizar
como distribución a priori una Cauchy.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Generar una muestra i.i.d. <span class="math inline">\(X_{i}\sim N(\theta_{0},1)\)</span> de tamaño
<span class="math inline">\(n=10\)</span> con <span class="math inline">\(\theta_{0}=1\)</span>. Utilizar una <span class="math inline">\(Cauchy(0,1)\)</span>
(<code>rcauchy</code>) como distribución a priori y como densidad auxiliar
para simular por aceptación-rechazo una muestra de la densidad a
posteriori (emplear <code>dnorm</code> para construir la verosimilitud).
Obtener el intervalo de probabilidad/credibilidad al 95%.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="AR.html#cb161-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb161-2"><a href="AR.html#cb161-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb161-3"><a href="AR.html#cb161-3" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span></span>
<span id="cb161-4"><a href="AR.html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb161-5"><a href="AR.html#cb161-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu0)</span>
<span id="cb161-6"><a href="AR.html#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="AR.html#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de verosimilitud</span></span>
<span id="cb161-8"><a href="AR.html#cb161-8" aria-hidden="true" tabindex="-1"></a>lik <span class="ot">&lt;-</span> <span class="cf">function</span>(mu){<span class="fu">prod</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu))}</span>
<span id="cb161-9"><a href="AR.html#cb161-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-10"><a href="AR.html#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Cota óptima</span></span>
<span id="cb161-11"><a href="AR.html#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimación por máxima verosimilitud</span></span>
<span id="cb161-12"><a href="AR.html#cb161-12" aria-hidden="true" tabindex="-1"></a>emv <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f =</span> lik, <span class="at">int =</span> <span class="fu">range</span>(x), <span class="at">maximum =</span> <span class="cn">TRUE</span>)</span>
<span id="cb161-13"><a href="AR.html#cb161-13" aria-hidden="true" tabindex="-1"></a>emv</span></code></pre></div>
<pre><code>## $maximum
## [1] 0.7353805
## 
## $objective
## [1] 3.303574e-08</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="AR.html#cb163-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> emv<span class="sc">$</span>objective</span></code></pre></div>
<p>En este caso concreto, ya sabríamos que el estimador máximo verosímil es la media muestral:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="AR.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] 0.7353958</code></pre>
<p>y por tanto:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="AR.html#cb166-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">lik</span>(<span class="fu">mean</span>(x))</span>
<span id="cb166-2"><a href="AR.html#cb166-2" aria-hidden="true" tabindex="-1"></a>c    </span></code></pre></div>
<pre><code>## [1] 3.303574e-08</code></pre>
<p>Finalmente podríamos emplear el siguiente código para generar simulaciones de la distribución a posteriori mediante aceptación-rechazo a partir de la distribución de Cauchy:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="AR.html#cb168-1" aria-hidden="true" tabindex="-1"></a>ngen <span class="ot">&lt;-</span> nsim</span>
<span id="cb168-2"><a href="AR.html#cb168-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(nsim)</span>
<span id="cb168-3"><a href="AR.html#cb168-3" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> (c<span class="sc">*</span><span class="fu">runif</span>(nsim) <span class="sc">&gt;</span> <span class="fu">sapply</span>(Y, lik)) <span class="co"># TRUE si no verifica condición</span></span>
<span id="cb168-4"><a href="AR.html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Volver a generar si no verifica condición</span></span>
<span id="cb168-5"><a href="AR.html#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">sum</span>(ind)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb168-6"><a href="AR.html#cb168-6" aria-hidden="true" tabindex="-1"></a>  le <span class="ot">&lt;-</span> <span class="fu">sum</span>(ind)</span>
<span id="cb168-7"><a href="AR.html#cb168-7" aria-hidden="true" tabindex="-1"></a>  ngen <span class="ot">&lt;-</span> ngen <span class="sc">+</span> le</span>
<span id="cb168-8"><a href="AR.html#cb168-8" aria-hidden="true" tabindex="-1"></a>  Y[ind] <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(le)</span>
<span id="cb168-9"><a href="AR.html#cb168-9" aria-hidden="true" tabindex="-1"></a>  ind[ind] <span class="ot">&lt;-</span> (c<span class="sc">*</span><span class="fu">runif</span>(le) <span class="sc">&gt;</span> <span class="fu">sapply</span>(Y[ind], lik)) <span class="co"># TRUE si no verifica condición</span></span>
<span id="cb168-10"><a href="AR.html#cb168-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-11"><a href="AR.html#cb168-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-12"><a href="AR.html#cb168-12" aria-hidden="true" tabindex="-1"></a>{ <span class="co"># Número generaciones</span></span>
<span id="cb168-13"><a href="AR.html#cb168-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Número de generaciones = &quot;</span>, ngen)</span>
<span id="cb168-14"><a href="AR.html#cb168-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Número medio de generaciones = &quot;</span>, ngen<span class="sc">/</span>nsim)</span>
<span id="cb168-15"><a href="AR.html#cb168-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Proporción de rechazos = &quot;</span>, <span class="dv">1</span><span class="sc">-</span>nsim<span class="sc">/</span>ngen,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb168-16"><a href="AR.html#cb168-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Número de generaciones =  5898
## Número medio de generaciones =  5.898
## Proporción de rechazos =  0.830451</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="AR.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de probabilidad al 95% (IC Bayes)</span></span>
<span id="cb170-2"><a href="AR.html#cb170-2" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Y, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb170-3"><a href="AR.html#cb170-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-4"><a href="AR.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Representar estimador e IC Bayes</span></span>
<span id="cb170-5"><a href="AR.html#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Y, <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">&quot;Distribución a posteriori&quot;</span>)</span>
<span id="cb170-6"><a href="AR.html#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(v = mean(x), lty = 3) # Estimación frecuentista</span></span>
<span id="cb170-7"><a href="AR.html#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(Y), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># Estimación Bayesiana</span></span>
<span id="cb170-8"><a href="AR.html#cb170-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> q, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="05-Metodos_generales_continuas_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Repetir el apartado anterior con <span class="math inline">\(n=100\)</span>.</p></li>
</ol>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>Emplearemos también <span class="math inline">\(X\sim f\)</span> para indicar que <span class="math inline">\(X\)</span> es una variable aleatoria con función de densidad <span class="math inline">\(f\)</span>.<a href="AR.html#fnref11" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="método-de-inversión.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modificaciones-del-método-de-aceptación-rechazo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/simbook/edit/master/05-Metodos_generales_continuas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Simulacion.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
