<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.2 Método de aceptación-rechazo | Técnicas de Simulación y Remuestreo</title>
  <meta name="description" content="Apuntes de Simulación Estadística y Remuestreo." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="4.2 Método de aceptación-rechazo | Técnicas de Simulación y Remuestreo" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Apuntes de Simulación Estadística y Remuestreo." />
  <meta name="github-repo" content="rubenfcasal/simbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.2 Método de aceptación-rechazo | Técnicas de Simulación y Remuestreo" />
  
  <meta name="twitter:description" content="Apuntes de Simulación Estadística y Remuestreo." />
  

<meta name="author" content="Rubén Fernández Casal (ruben.fcasal@udc.es)" />
<meta name="author" content="Ricardo Cao (rcao@udc.es)" />
<meta name="author" content="Julián Costa (julian.costa@udc.es)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inversion.html"/>
<link rel="next" href="modAR.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Técnicas de Simulación y Remuestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a>
<ul>
<li class="chapter" data-level="1.1" data-path="conceptos.html"><a href="conceptos.html"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="conceptos.html"><a href="conceptos.html#ealbum"><i class="fa fa-check"></i><b>1.1.1</b> Ejemplo</a></li>
<li class="chapter" data-level="1.1.2" data-path="conceptos.html"><a href="conceptos.html#ventajas-e-inconvenientes-de-la-simulación"><i class="fa fa-check"></i><b>1.1.2</b> Ventajas e inconvenientes de la simulación</a></li>
<li class="chapter" data-level="1.1.3" data-path="conceptos.html"><a href="conceptos.html#aplicaciones-de-la-simulación"><i class="fa fa-check"></i><b>1.1.3</b> Aplicaciones de la simulación</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html"><i class="fa fa-check"></i><b>1.2</b> Tipos de números aleatorios</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html#números-aleatorios-puros"><i class="fa fa-check"></i><b>1.2.1</b> Números aleatorios puros</a></li>
<li class="chapter" data-level="1.2.2" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html#números-cuasi-aleatorios"><i class="fa fa-check"></i><b>1.2.2</b> Números cuasi-aleatorios</a></li>
<li class="chapter" data-level="1.2.3" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html#números-pseudo-aleatorios"><i class="fa fa-check"></i><b>1.2.3</b> Números pseudo-aleatorios</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rrng.html"><a href="rrng.html"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios en R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="rrng.html"><a href="rrng.html#oprrng"><i class="fa fa-check"></i><b>1.3.1</b> Opciones</a></li>
<li class="chapter" data-level="1.3.2" data-path="rrng.html"><a href="rrng.html#paquetes-de-r"><i class="fa fa-check"></i><b>1.3.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="1.3.3" data-path="rrng.html"><a href="rrng.html#tiempo-de-cpu"><i class="fa fa-check"></i><b>1.3.3</b> Tiempo de CPU</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>1.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="gen-pseudo.html"><a href="gen-pseudo.html"><i class="fa fa-check"></i><b>2</b> Generación de números pseudoaleatorios</a>
<ul>
<li class="chapter" data-level="2.1" data-path="gen-cong.html"><a href="gen-cong.html"><i class="fa fa-check"></i><b>2.1</b> Generadores congruenciales lineales</a></li>
<li class="chapter" data-level="2.2" data-path="ext-cong.html"><a href="ext-cong.html"><i class="fa fa-check"></i><b>2.2</b> Extensiones</a></li>
<li class="chapter" data-level="2.3" data-path="calgen.html"><a href="calgen.html"><i class="fa fa-check"></i><b>2.3</b> Análisis de la calidad de un generador</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="calgen.html"><a href="calgen.html#repetición-de-contrastes"><i class="fa fa-check"></i><b>2.3.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="2.3.2" data-path="calgen.html"><a href="calgen.html#baterias"><i class="fa fa-check"></i><b>2.3.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>2.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="resultados.html"><a href="resultados.html"><i class="fa fa-check"></i><b>3</b> Análisis de resultados de simulación</a>
<ul>
<li class="chapter" data-level="3.1" data-path="convergencia.html"><a href="convergencia.html"><i class="fa fa-check"></i><b>3.1</b> Convergencia</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="convergencia.html"><a href="convergencia.html#detección-de-problemas-de-convergencia"><i class="fa fa-check"></i><b>3.1.1</b> Detección de problemas de convergencia</a></li>
<li class="chapter" data-level="3.1.2" data-path="convergencia.html"><a href="convergencia.html#precisión"><i class="fa fa-check"></i><b>3.1.2</b> Precisión</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="num-gen.html"><a href="num-gen.html"><i class="fa fa-check"></i><b>3.2</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="3.3" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html"><i class="fa fa-check"></i><b>3.3</b> El problema de la dependencia</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>3.3.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="observaciones.html"><a href="observaciones.html"><i class="fa fa-check"></i><b>3.4</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="continuas.html"><a href="continuas.html"><i class="fa fa-check"></i><b>4</b> Simulación de variables continuas</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inversion.html"><a href="inversion.html"><i class="fa fa-check"></i><b>4.1</b> Método de inversión</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="inversion.html"><a href="inversion.html#ejemplos-inv"><i class="fa fa-check"></i><b>4.1.1</b> Algunas distribuciones que pueden simularse por el método de inversión</a></li>
<li class="chapter" data-level="4.1.2" data-path="inversion.html"><a href="inversion.html#ventajas-e-inconvenientes"><i class="fa fa-check"></i><b>4.1.2</b> Ventajas e inconvenientes</a></li>
<li class="chapter" data-level="4.1.3" data-path="inversion.html"><a href="inversion.html#inversión-aproximada"><i class="fa fa-check"></i><b>4.1.3</b> Inversión aproximada</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>4.2</b> Método de aceptación-rechazo</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="AR.html"><a href="AR.html#algoritmo"><i class="fa fa-check"></i><b>4.2.1</b> Algoritmo</a></li>
<li class="chapter" data-level="4.2.2" data-path="AR.html"><a href="AR.html#densidades-acotadas-en-un-intervalo-cerrado"><i class="fa fa-check"></i><b>4.2.2</b> Densidades acotadas en un intervalo cerrado</a></li>
<li class="chapter" data-level="4.2.3" data-path="AR.html"><a href="AR.html#eficiencia-del-algoritmo"><i class="fa fa-check"></i><b>4.2.3</b> Eficiencia del algoritmo</a></li>
<li class="chapter" data-level="4.2.4" data-path="AR.html"><a href="AR.html#elección-de-la-densidad-auxiliar"><i class="fa fa-check"></i><b>4.2.4</b> Elección de la densidad auxiliar</a></li>
<li class="chapter" data-level="4.2.5" data-path="AR.html"><a href="AR.html#bayes-ar"><i class="fa fa-check"></i><b>4.2.5</b> Ejemplo: inferencia bayesiana</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modAR.html"><a href="modAR.html"><i class="fa fa-check"></i><b>4.3</b> Modificaciones del método de aceptación-rechazo</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="modAR.html"><a href="modAR.html#ars"><i class="fa fa-check"></i><b>4.3.1</b> Muestreo por rechazo adaptativo (ARS)</a></li>
<li class="chapter" data-level="4.3.2" data-path="modAR.html"><a href="modAR.html#método-del-cociente-de-uniformes"><i class="fa fa-check"></i><b>4.3.2</b> Método del cociente de uniformes</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="composicion.html"><a href="composicion.html"><i class="fa fa-check"></i><b>4.4</b> Método de composición (o de simulación condicional)</a></li>
<li class="chapter" data-level="4.5" data-path="notables-cont.html"><a href="notables-cont.html"><i class="fa fa-check"></i><b>4.5</b> Métodos específicos para la generación de algunas distribuciones notables</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="notables-cont.html"><a href="notables-cont.html#método-de-box-müller"><i class="fa fa-check"></i><b>4.5.1</b> Método de Box-Müller</a></li>
<li class="chapter" data-level="4.5.2" data-path="notables-cont.html"><a href="notables-cont.html#simulación-de-la-distribución-beta"><i class="fa fa-check"></i><b>4.5.2</b> Simulación de la distribución beta</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="discretas.html"><a href="discretas.html"><i class="fa fa-check"></i><b>5</b> Simulación de variables discretas</a>
<ul>
<li class="chapter" data-level="5.1" data-path="transcuant.html"><a href="transcuant.html"><i class="fa fa-check"></i><b>5.1</b> Método de la transformación cuantil</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="transcuant.html"><a href="transcuant.html#eficiencia-del-algoritmo-1"><i class="fa fa-check"></i><b>5.1.1</b> Eficiencia del algoritmo</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="método-de-la-tabla-guía.html"><a href="método-de-la-tabla-guía.html"><i class="fa fa-check"></i><b>5.2</b> Método de la tabla guía</a></li>
<li class="chapter" data-level="5.3" data-path="alias.html"><a href="alias.html"><i class="fa fa-check"></i><b>5.3</b> Método de Alias</a></li>
<li class="chapter" data-level="5.4" data-path="simulación-de-una-variable-discreta-con-dominio-infinito.html"><a href="simulación-de-una-variable-discreta-con-dominio-infinito.html"><i class="fa fa-check"></i><b>5.4</b> Simulación de una variable discreta con dominio infinito</a></li>
<li class="chapter" data-level="5.5" data-path="otros-métodos.html"><a href="otros-métodos.html"><i class="fa fa-check"></i><b>5.5</b> Otros métodos</a></li>
<li class="chapter" data-level="5.6" data-path="notables-disc.html"><a href="notables-disc.html"><i class="fa fa-check"></i><b>5.6</b> Métodos específicos para generación de distribuciones notables</a></li>
<li class="chapter" data-level="5.7" data-path="ejercicios-discretas.html"><a href="ejercicios-discretas.html"><i class="fa fa-check"></i><b>5.7</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariante.html"><a href="multivariante.html"><i class="fa fa-check"></i><b>6</b> Simulación de distribuciones multivariantes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="simulación-de-componentes-independientes.html"><a href="simulación-de-componentes-independientes.html"><i class="fa fa-check"></i><b>6.1</b> Simulación de componentes independientes</a></li>
<li class="chapter" data-level="6.2" data-path="el-método-de-aceptación-rechazo.html"><a href="el-método-de-aceptación-rechazo.html"><i class="fa fa-check"></i><b>6.2</b> El método de aceptación-rechazo</a></li>
<li class="chapter" data-level="6.3" data-path="fact-cov.html"><a href="fact-cov.html"><i class="fa fa-check"></i><b>6.3</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="6.4" data-path="distrcond.html"><a href="distrcond.html"><i class="fa fa-check"></i><b>6.4</b> Método de las distribuciones condicionadas</a></li>
<li class="chapter" data-level="6.5" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html"><i class="fa fa-check"></i><b>6.5</b> Simulación condicional e incondicional</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#condnormal"><i class="fa fa-check"></i><b>6.5.1</b> Simulación condicional de una normal multivariante</a></li>
<li class="chapter" data-level="6.5.2" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#simulación-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>6.5.2</b> Simulación condicional a partir de un modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html"><i class="fa fa-check"></i><b>6.6</b> Simulación basada en cópulas</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#cópulas-arquimedianas"><i class="fa fa-check"></i><b>6.6.1</b> Cópulas Arquimedianas</a></li>
<li class="chapter" data-level="6.6.2" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#simulación"><i class="fa fa-check"></i><b>6.6.2</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="mult-discr.html"><a href="mult-discr.html"><i class="fa fa-check"></i><b>6.7</b> Simulación de distribuciones multivariantes discretas</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="mult-discr.html"><a href="mult-discr.html#simulación-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>6.7.1</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="6.7.2" data-path="mult-discr.html"><a href="mult-discr.html#simconting"><i class="fa fa-check"></i><b>6.7.2</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="monte-carlo.html"><a href="monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Métodos Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1" data-path="int-MC.html"><a href="int-MC.html"><i class="fa fa-check"></i><b>7.1</b> Integración Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="int-MC.html"><a href="int-MC.html#integración-monte-carlo-clásica"><i class="fa fa-check"></i><b>7.1.1</b> Integración Monte Carlo clásica</a></li>
<li class="chapter" data-level="7.1.2" data-path="int-MC.html"><a href="int-MC.html#caso-general"><i class="fa fa-check"></i><b>7.1.2</b> Caso general</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html"><i class="fa fa-check"></i><b>7.2</b> Muestreo por importancia</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>7.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="opt-MC.html"><a href="opt-MC.html"><i class="fa fa-check"></i><b>7.3</b> Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="opt-MC.html"><a href="opt-MC.html#algoritmos-de-optimización-monte-carlo"><i class="fa fa-check"></i><b>7.3.1</b> Algoritmos de optimización Monte Carlo</a></li>
<li class="chapter" data-level="7.3.2" data-path="opt-MC.html"><a href="opt-MC.html#temple-simulado"><i class="fa fa-check"></i><b>7.3.2</b> Temple simulado</a></li>
<li class="chapter" data-level="7.3.3" data-path="opt-MC.html"><a href="opt-MC.html#algoritmos-genéticos"><i class="fa fa-check"></i><b>7.3.3</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="aplic-inf.html"><a href="aplic-inf.html"><i class="fa fa-check"></i><b>7.4</b> Métodos Monte Carlo en Inferencia Estadística</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="aplic-inf.html"><a href="aplic-inf.html#distribución-en-el-muestreo"><i class="fa fa-check"></i><b>7.4.1</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="7.4.2" data-path="aplic-inf.html"><a href="aplic-inf.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>7.4.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="7.4.3" data-path="aplic-inf.html"><a href="aplic-inf.html#contrastes"><i class="fa fa-check"></i><b>7.4.3</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="7.4.4" data-path="aplic-inf.html"><a href="aplic-inf.html#comparación-de-estimadores"><i class="fa fa-check"></i><b>7.4.4</b> Comparación de estimadores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="red-varianza.html"><a href="red-varianza.html"><i class="fa fa-check"></i><b>8</b> Técnicas de reducción de la varianza</a>
<ul>
<li class="chapter" data-level="8.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html"><i class="fa fa-check"></i><b>8.1</b> Variables antitéticas</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#ejemplo-integración-monte-carlo"><i class="fa fa-check"></i><b>8.1.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="8.1.2" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#generación-de-variables-antitéticas"><i class="fa fa-check"></i><b>8.1.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="estratificación.html"><a href="estratificación.html"><i class="fa fa-check"></i><b>8.2</b> Estratificación</a></li>
<li class="chapter" data-level="8.3" data-path="variables-de-control.html"><a href="variables-de-control.html"><i class="fa fa-check"></i><b>8.3</b> Variables de control</a></li>
<li class="chapter" data-level="8.4" data-path="números-aleatorios-comunes.html"><a href="números-aleatorios-comunes.html"><i class="fa fa-check"></i><b>8.4</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="8.5" data-path="ejercicios-2.html"><a href="ejercicios-2.html"><i class="fa fa-check"></i><b>8.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>9</b> Métodos de remuestreo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="boot-intro.html"><a href="boot-intro.html"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="boot-unif.html"><a href="boot-unif.html"><i class="fa fa-check"></i><b>9.2</b> El Bootstrap uniforme</a></li>
<li class="chapter" data-level="9.3" data-path="intro-paquetes.html"><a href="intro-paquetes.html"><i class="fa fa-check"></i><b>9.3</b> Herramientas disponibles en R sobre bootstrap</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="intro-paquetes.html"><a href="intro-paquetes.html#intro-pkgboot"><i class="fa fa-check"></i><b>9.3.1</b> El paquete <code>boot</code></a></li>
<li class="chapter" data-level="9.3.2" data-path="intro-paquetes.html"><a href="intro-paquetes.html#extensiones-del-bootstrap-uniforme-con-el-paquete-boot"><i class="fa fa-check"></i><b>9.3.2</b> Extensiones del bootstrap uniforme con el paquete <code>boot</code></a></li>
<li class="chapter" data-level="9.3.3" data-path="intro-paquetes.html"><a href="intro-paquetes.html#boot-unif-multi"><i class="fa fa-check"></i><b>9.3.3</b> Ejemplo: Bootstrap uniforme multidimensional</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modunif.html"><a href="modunif.html"><i class="fa fa-check"></i><b>10</b> Extensiones del bootstrap uniforme</a>
<ul>
<li class="chapter" data-level="10.1" data-path="deficien-unif.html"><a href="deficien-unif.html"><i class="fa fa-check"></i><b>10.1</b> Deficiencias del bootstrap uniforme</a></li>
<li class="chapter" data-level="10.2" data-path="modunif-boot-par.html"><a href="modunif-boot-par.html"><i class="fa fa-check"></i><b>10.2</b> Bootstrap paramétrico</a></li>
<li class="chapter" data-level="10.3" data-path="modunif-boot-suav.html"><a href="modunif-boot-suav.html"><i class="fa fa-check"></i><b>10.3</b> Bootstrap suavizado</a></li>
<li class="chapter" data-level="10.4" data-path="boot-reg.html"><a href="boot-reg.html"><i class="fa fa-check"></i><b>10.4</b> Bootstrap basado en modelos</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="boot-reg.html"><a href="boot-reg.html#boot-unif-reg"><i class="fa fa-check"></i><b>10.4.1</b> Remuestreo de las observaciones</a></li>
<li class="chapter" data-level="10.4.2" data-path="boot-reg.html"><a href="boot-reg.html#boot-residual"><i class="fa fa-check"></i><b>10.4.2</b> Bootstrap residual</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="boot-aplic.html"><a href="boot-aplic.html"><i class="fa fa-check"></i><b>11</b> Aplicaciones del remuestreo</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sesgo-prec.html"><a href="sesgo-prec.html"><i class="fa fa-check"></i><b>11.1</b> Estimación del sesgo y la precisión de un estimador</a></li>
<li class="chapter" data-level="11.2" data-path="boot-ic.html"><a href="boot-ic.html"><i class="fa fa-check"></i><b>11.2</b> Intervalos de confianza bootstrap</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-norm"><i class="fa fa-check"></i><b>11.2.1</b> Aproximación normal</a></li>
<li class="chapter" data-level="11.2.2" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-perc"><i class="fa fa-check"></i><b>11.2.2</b> Método percentil directo</a></li>
<li class="chapter" data-level="11.2.3" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-basic"><i class="fa fa-check"></i><b>11.2.3</b> Método percentil básico</a></li>
<li class="chapter" data-level="11.2.4" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-stud"><i class="fa fa-check"></i><b>11.2.4</b> Método percentil-<em>t</em></a></li>
<li class="chapter" data-level="11.2.5" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-bca"><i class="fa fa-check"></i><b>11.2.5</b> Método BCa</a></li>
<li class="chapter" data-level="11.2.6" data-path="boot-ic.html"><a href="boot-ic.html#icboot-trans"><i class="fa fa-check"></i><b>11.2.6</b> Ejemplo: IC bootstrap para el coeficiente de correlación</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="boot-test.html"><a href="boot-test.html"><i class="fa fa-check"></i><b>11.3</b> Contrastes de hipótesis bootstrap</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="boot-test.html"><a href="boot-test.html#contrastes-parametricos"><i class="fa fa-check"></i><b>11.3.1</b> Contrastes bootstrap paramétricos</a></li>
<li class="chapter" data-level="11.3.2" data-path="boot-test.html"><a href="boot-test.html#contrastes-de-permutaciones"><i class="fa fa-check"></i><b>11.3.2</b> Contrastes de permutaciones</a></li>
<li class="chapter" data-level="11.3.3" data-path="boot-test.html"><a href="boot-test.html#contrastes-semiparametricos"><i class="fa fa-check"></i><b>11.3.3</b> Contrastes bootstrap semiparamétricos</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Apéndices</b></span></li>
<li class="chapter" data-level="A" data-path="gof-aleat.html"><a href="gof-aleat.html"><i class="fa fa-check"></i><b>A</b> Bondad de Ajuste y Aleatoriedad</a>
<ul>
<li class="chapter" data-level="A.1" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i><b>A.1</b> Métodos de bondad de ajuste</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="gof.html"><a href="gof.html#histograma"><i class="fa fa-check"></i><b>A.1.1</b> Histograma</a></li>
<li class="chapter" data-level="A.1.2" data-path="gof.html"><a href="gof.html#empdistr"><i class="fa fa-check"></i><b>A.1.2</b> Función de distribución empírica</a></li>
<li class="chapter" data-level="A.1.3" data-path="gof.html"><a href="gof.html#gráficos-p-p-y-q-q"><i class="fa fa-check"></i><b>A.1.3</b> Gráficos P-P y Q-Q</a></li>
<li class="chapter" data-level="A.1.4" data-path="gof.html"><a href="gof.html#chi2test"><i class="fa fa-check"></i><b>A.1.4</b> Contraste chi-cuadrado de Pearson</a></li>
<li class="chapter" data-level="A.1.5" data-path="gof.html"><a href="gof.html#ks-test"><i class="fa fa-check"></i><b>A.1.5</b> Contraste de Kolmogorov-Smirnov</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="diag-aleat.html"><a href="diag-aleat.html"><i class="fa fa-check"></i><b>A.2</b> Diagnosis de la independencia</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="diag-aleat.html"><a href="diag-aleat.html#métodos-para-detectar-dependencia"><i class="fa fa-check"></i><b>A.2.1</b> Métodos para detectar dependencia</a></li>
<li class="chapter" data-level="A.2.2" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-secuencial"><i class="fa fa-check"></i><b>A.2.2</b> Gráfico secuencial</a></li>
<li class="chapter" data-level="A.2.3" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-de-dispersion-retardado"><i class="fa fa-check"></i><b>A.2.3</b> Gráfico de dispersion retardado</a></li>
<li class="chapter" data-level="A.2.4" data-path="diag-aleat.html"><a href="diag-aleat.html#correlograma"><i class="fa fa-check"></i><b>A.2.4</b> El correlograma</a></li>
<li class="chapter" data-level="A.2.5" data-path="diag-aleat.html"><a href="diag-aleat.html#test-de-rachas"><i class="fa fa-check"></i><b>A.2.5</b> Test de rachas</a></li>
<li class="chapter" data-level="A.2.6" data-path="diag-aleat.html"><a href="diag-aleat.html#ljungbox"><i class="fa fa-check"></i><b>A.2.6</b> El contraste de Ljung-Box</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html"><i class="fa fa-check"></i><b>A.3</b> Contrastes específicos para generadores aleatorios</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#freq-test"><i class="fa fa-check"></i><b>A.3.1</b> Contraste de frecuencias</a></li>
<li class="chapter" data-level="A.3.2" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-series"><i class="fa fa-check"></i><b>A.3.2</b> Contraste de series</a></li>
<li class="chapter" data-level="A.3.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-poker"><i class="fa fa-check"></i><b>A.3.3</b> El contraste del poker</a></li>
<li class="chapter" data-level="A.3.4" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-coleccionista"><i class="fa fa-check"></i><b>A.3.4</b> El contraste del coleccionista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="int-num.html"><a href="int-num.html"><i class="fa fa-check"></i><b>B</b> Integración numérica</a>
<ul>
<li class="chapter" data-level="B.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html"><i class="fa fa-check"></i><b>B.1</b> Integración numérica unidimensional</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#método-del-trapezoide"><i class="fa fa-check"></i><b>B.1.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.1.2" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#regla-de-simpson"><i class="fa fa-check"></i><b>B.1.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="B.1.3" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>B.1.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="B.1.4" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#comandos-de-r"><i class="fa fa-check"></i><b>B.1.4</b> Comandos de R</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html"><i class="fa fa-check"></i><b>B.2</b> Integración numérica bidimensional</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#representación-gráfica"><i class="fa fa-check"></i><b>B.2.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="B.2.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#método-del-trapezoide-1"><i class="fa fa-check"></i><b>B.2.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.2.3" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#comandos-de-r-1"><i class="fa fa-check"></i><b>B.2.3</b> Comandos de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="intro-hpc.html"><a href="intro-hpc.html"><i class="fa fa-check"></i><b>C</b> Introducción al procesamiento en paralelo en R</a>
<ul>
<li class="chapter" data-level="C.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>C.1</b> Introducción</a></li>
<li class="chapter" data-level="C.2" data-path="paquetes-en-r.html"><a href="paquetes-en-r.html"><i class="fa fa-check"></i><b>C.2</b> Paquetes en R</a></li>
<li class="chapter" data-level="C.3" data-path="ejemplos.html"><a href="ejemplos.html"><i class="fa fa-check"></i><b>C.3</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="C.3.1" data-path="ejemplos.html"><a href="ejemplos.html#procesamiento-en-paralelo-con-la-función-boot"><i class="fa fa-check"></i><b>C.3.1</b> Procesamiento en paralelo con la función <code>boot()</code></a></li>
<li class="chapter" data-level="C.3.2" data-path="ejemplos.html"><a href="ejemplos.html#estudio-sim-boot"><i class="fa fa-check"></i><b>C.3.2</b> Estudio de simulación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="soluciones.html"><a href="soluciones.html"><i class="fa fa-check"></i><b>D</b> Soluciones ejercicios</a>
<ul>
<li class="chapter" data-level="D.1" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html"><i class="fa fa-check"></i><b>D.1</b> Capítulo 1 Introducción a la simulación</a>
<ul>
<li class="chapter" data-level="D.1.1" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-simpi"><i class="fa fa-check"></i><b>D.1.1</b> Ejercicio 1.1</a></li>
<li class="chapter" data-level="D.1.2" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-bernoulli"><i class="fa fa-check"></i><b>D.1.2</b> Ejercicio 1.2</a></li>
<li class="chapter" data-level="D.1.3" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-circuito"><i class="fa fa-check"></i><b>D.1.3</b> Ejercicio 1.3</a></li>
<li class="chapter" data-level="D.1.4" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-mere"><i class="fa fa-check"></i><b>D.1.4</b> Ejercicio 1.4</a></li>
<li class="chapter" data-level="D.1.5" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-album"><i class="fa fa-check"></i><b>D.1.5</b> Ejercicio 1.5</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="capítulo-2-generación-de-números-pseudoaleatorios.html"><a href="capítulo-2-generación-de-números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>D.2</b> Capítulo 2 Generación de números pseudoaleatorios</a>
<ul>
<li class="chapter" data-level="D.2.1" data-path="capítulo-2-generación-de-números-pseudoaleatorios.html"><a href="capítulo-2-generación-de-números-pseudoaleatorios.html#sol-RANDVN"><i class="fa fa-check"></i><b>D.2.1</b> Ejercicio 2.1</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="capítulo-5-simulación-de-variables-discretas.html"><a href="capítulo-5-simulación-de-variables-discretas.html"><i class="fa fa-check"></i><b>D.3</b> Capítulo 5 Simulación de variables discretas</a>
<ul>
<li class="chapter" data-level="D.3.1" data-path="capítulo-5-simulación-de-variables-discretas.html"><a href="capítulo-5-simulación-de-variables-discretas.html#sol-mixta-cuantil"><i class="fa fa-check"></i><b>D.3.1</b> Ejercicio 5.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-básica.html"><a href="bibliografía-básica.html"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html"><i class="fa fa-check"></i>Bibliografía complementaria</a></li>
<li class="chapter" data-level="" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i>Enlaces</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliografía.html"><a href="bibliografía.html"><i class="fa fa-check"></i>Bibliografía</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Técnicas de Simulación y Remuestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="AR" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Método de aceptación-rechazo<a href="AR.html#AR" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Se trata de un método universal alternativo al de inversión para el caso de que no se pueda emplear la función cuantil, pero se dispone de una expresión (preferiblemente sencilla) para la función de densidad objetivo <span class="math inline">\(f\left( x \right)\)</span>.</p>
<p>La idea es simular una variable aleatoria bidimensional <span class="math inline">\(\left( X, Y\right)\)</span> con distribución uniforme en el hipografo de <span class="math inline">\(f\)</span> (la región del plano comprendida entre el eje OX y <span class="math inline">\(f\)</span>, de área 1):
<span class="math display">\[A_{f}=\left\{ \left( x,y\right) \in \mathbb{R}^{2}:0\leq y\leq f(x) \right\}.\]</span>
De esta forma la primera componente tendrá la distribución deseada (ver Figura <a href="AR.html#fig:var-gen">4.4</a>):</p>
<p><span class="math display">\[ P\left( a&lt;X&lt;b\right) = \frac{\text{Area de }\left\{ \left( x,y\right) \in
\mathbb{R}^{2}:a&lt;x&lt;b;~0\leq y\leq f(x) \right\} }{\text{Area de }
A_{f}} \\
= \int_{a}^{b}f(x) dx \]</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:var-gen"></span>
<img src="04-Metodos_generales_continuas_files/figure-html/var-gen-1.png" alt="Puntos con distribución uniforme en el hipografo de una función de densidad." width="80%" />
<p class="caption">
Figura 4.4: Puntos con distribución uniforme en el hipografo de una función de densidad.
</p>
</div>
<p>El resultado anterior es también válido para una cuasi-densidad<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a> <span class="math inline">\(f^{\ast}\)</span> (no depende de la constante normalizadora):</p>
<ul>
<li>Si <span class="math inline">\(\left( X,Y\right) \sim \mathcal{U}\left(A_{f^{\ast}}\right)\)</span> entonces <span class="math inline">\(X\sim f\)</span>.</li>
</ul>
<p>Para simular una distribución uniforme en el hipografo <span class="math inline">\(A_{f}\)</span> (o en <span class="math inline">\(A_{f^{\ast}}\)</span>), lo que se hace es utilizar una variable aleatoria auxiliar <span class="math inline">\(T\)</span> con función de densidad <span class="math inline">\(g\)</span>, similar a <span class="math inline">\(f\)</span> y fácil de simular, y una constante <span class="math inline">\(c &gt; 0\)</span> verificando:
<span class="math display">\[f(x) \leq c\cdot g(x) \text{, }\forall x\in \mathbb{R}.\]</span>
Podemos generar valores en <span class="math inline">\(A_{cg} \supset A_{f}\)</span> empleando el resultado:</p>
<ul>
<li>Si <span class="math inline">\(T\)</span> es una variable aleatoria con función de densidad <span class="math inline">\(g\)</span>
y <span class="math inline">\(U \sim \mathcal{U}(0, 1)\)</span> entonces
<span class="math display">\[\left( T,c\cdot U\cdot g(x) \right) \sim \mathcal{U}\left(
A_{cg}\right)\]</span>
siendo
<span class="math inline">\(A_{cg}=\left\{ \left( x, y \right) \in \mathbb{R}^{2} : 0 \leq y \leq cg\left( x \right) \right\}\)</span>.</li>
</ul>
<p>Teniendo en cuenta además que:</p>
<ul>
<li>Si <span class="math inline">\(\left( T,Y\right) \sim \mathcal{U}\left( A\right)\)</span> y
<span class="math inline">\(B \subset A\Rightarrow \left. \left( T,Y\right) \right\vert _{B} \sim \mathcal{U}\left(B\right)\)</span>.</li>
</ul>
<p>Entonces, si <span class="math inline">\(\left( T, Y \right)\)</span> sigue una distribución uniforme en <span class="math inline">\(A_{cg}\)</span>, aceptando los valores de <span class="math inline">\(\left( T, Y \right)\)</span> que pertenezcan a <span class="math inline">\(A_{f}\)</span> (o a <span class="math inline">\(A_{f^{\ast}}\)</span>) se obtendrán generaciones con distribución uniforme sobre <span class="math inline">\(A_{f}\)</span> (o <span class="math inline">\(A_{f^{\ast}}\)</span>) y la densidad de la primera componente será <span class="math inline">\(f\)</span>.</p>
<div id="algoritmo" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Algoritmo<a href="AR.html#algoritmo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Supongamos que <span class="math inline">\(f\)</span> es la densidad objetivo y <span class="math inline">\(g\)</span> es una densidad
auxiliar (fácil de simular y similar a <span class="math inline">\(f\)</span>), de forma que
existe una constante <span class="math inline">\(c&gt;0\)</span> tal que:
<span class="math display">\[f(x) \leq c\cdot g(x)
\text{, }\forall x\in \mathbb{R},\]</span>
(de donde se deduce que el soporte de <span class="math inline">\(g\)</span> debe contener el de <span class="math inline">\(f\)</span>).</p>
<div class="conjecture">
<p><span id="cnj:aceptacion-rechazo" class="conjecture"><strong>Algoritmo 4.3  (Método de aceptación-rechazo; Von Neuman, 1951) </strong></span><br></p>
<ol style="list-style-type: decimal">
<li><p>Generar <span class="math inline">\(U \sim \mathcal{U}(0, 1)\)</span>.</p></li>
<li><p>Generar <span class="math inline">\(T \sim g\)</span>.</p></li>
<li><p>Si <span class="math inline">\(c\cdot U\cdot g(T) \leq f(T)\)</span>
devolver <span class="math inline">\(X=T\)</span>,</p>
<p>en caso contrario volver al paso 1.</p></li>
</ol>
</div>
<!-- \@ref(cnj:aceptacion-rechazo) -->
</div>
<div id="densidades-acotadas-en-un-intervalo-cerrado" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Densidades acotadas en un intervalo cerrado<a href="AR.html#densidades-acotadas-en-un-intervalo-cerrado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sea <span class="math inline">\(f\)</span> una función de densidad cualquiera con soporte en un intervalo cerrado <span class="math inline">\([a,b]\)</span> (es decir, <span class="math inline">\(\{x : f(x) &gt; 0\}=[a,b]\)</span>) de tal forma que existe una constante <span class="math inline">\(M&gt;0\)</span> tal que <span class="math inline">\(f(x) \leq M\)</span> <span class="math inline">\(\forall x\)</span> (es decir, <span class="math inline">\(f\)</span> es acotada superiormente).
En este caso puede tomarse como densidad auxiliar <span class="math inline">\(g\)</span>, la de una <span class="math inline">\(\mathcal{U}(a,b)\)</span>.
En efecto, tomando <span class="math inline">\(c = M\left( b-a\right)\)</span> y teniendo en cuenta que
<span class="math display">\[g(x) = \left\{
\begin{array}{ll}\frac{1}{b-a} &amp; \text{si } x \in [a,b]\\
0 &amp; \text{en caso contrario}
\end{array} \right.\]</span>
se tiene que <span class="math inline">\(f(x) \leq M = \frac{c}{b-a}=c \cdot g(x)\)</span>,
<span class="math inline">\(\forall x \in [a,b]\)</span>.
Así pues, el algoritmo quedaría como sigue:</p>
<ol style="list-style-type: decimal">
<li><p>Generar <span class="math inline">\(U,V\sim \mathcal{U}(0, 1)\)</span>.</p></li>
<li><p>Hacer <span class="math inline">\(T = a + \left( b-a \right) V\)</span>.</p></li>
<li><p>Si <span class="math inline">\(M \cdot U\leq f\left( T \right)\)</span>
devolver <span class="math inline">\(X = T\)</span>,</p>
<p>en caso contrario volver al paso 1.</p></li>
</ol>
<div class="remark">
<p><span id="unlabeled-div-5" class="remark"><em>Nota:</em>. </span>No confundir <span class="math inline">\(M\)</span> con <span class="math inline">\(c = M \left( b - a \right)\)</span>.</p>
</div>
<!-- 
Pendiente: cambiar beta por triangular en [0, 2] 
Emplear código dtri?
-->
<div class="example">
<p><span id="exm:dbeta-dunif-ar" class="example"><strong>Ejemplo 4.3  (simulación de distribución beta a partir de la uniforme) </strong></span><br></p>
<p>Para simular una variable con función de densidad <span class="math inline">\(\mathcal{Beta}(\alpha, \beta)\)</span>:
<span class="math display">\[f(x)=\frac{\Gamma (\alpha + \beta )}{\Gamma (\alpha )\Gamma (\beta )}
x^{\alpha -1}(1-x)^{\beta -1}\text{ si }0 \leq x \leq 1,\]</span>
(siguiendo la notación de la función <code>dbeta(x, shape1, shape2)</code> de <code>R</code>), podemos considerar como distribución auxiliar una <span class="math inline">\(\mathcal{U}(0,1)\)</span>,
con <span class="math inline">\(g(x) = 1\)</span> si <span class="math inline">\(0 \leq x \leq 1\)</span>.</p>
</div>
<p>Esta distribución está acotada y es unimodal, si <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> son mayores<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a> que 1, y su moda es <span class="math inline">\(\frac{\alpha - 1} {\alpha + \beta - 2}\)</span>, por lo que:
<span class="math display">\[c = M = \max_{0 \leq x \leq 1}f(x) = f\left( \frac{\alpha - 1} {\alpha + \beta - 2} \right).\]</span></p>
<p>Por ejemplo, considerando <span class="math inline">\(\alpha = 2\)</span> y <span class="math inline">\(\beta = 4\)</span>, si comparamos la densidad objetivo con la auxiliar reescalada (Figura <a href="AR.html#fig:dbeta-dunif-plot">4.5</a>), confirmamos que esta última está por encima (y llegan a tocarse, por lo que se está empleando la cota óptima; ver siguiente sección).</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="AR.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># densidad objetivo: dbeta</span></span>
<span id="cb136-2"><a href="AR.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="co"># densidad auxiliar: dunif</span></span>
<span id="cb136-3"><a href="AR.html#cb136-3" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb136-4"><a href="AR.html#cb136-4" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb136-5"><a href="AR.html#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, s1, s2), <span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb136-6"><a href="AR.html#cb136-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">dbeta</span>((s1 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>(s1 <span class="sc">+</span> s2 <span class="sc">-</span> <span class="dv">2</span>), s1, s2)</span>
<span id="cb136-7"><a href="AR.html#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(h = m, lty = 2)</span></span>
<span id="cb136-8"><a href="AR.html#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, m, <span class="dv">1</span>, m, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb136-9"><a href="AR.html#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb136-10"><a href="AR.html#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb136-11"><a href="AR.html#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dbeta-dunif-plot"></span>
<img src="04-Metodos_generales_continuas_files/figure-html/dbeta-dunif-plot-1.png" alt="Densidad objetivo beta (línea continua) y densidad auxiliar unifome reescalada (línea discontinua)." width="75%" />
<p class="caption">
Figura 4.5: Densidad objetivo beta (línea continua) y densidad auxiliar unifome reescalada (línea discontinua).
</p>
</div>
<p>El siguiente código implementa el método de aceptación-rechazo para simular valores de la densidad objetivo (se incluye una variable “global” <code>ngen</code> para contar el número de generaciones de la distribución auxiliar):</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="AR.html#cb137-1" aria-hidden="true" tabindex="-1"></a>ngen <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb137-2"><a href="AR.html#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="AR.html#cb137-3" aria-hidden="true" tabindex="-1"></a>rbeta2 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">s1 =</span> <span class="dv">2</span>, <span class="at">s2 =</span> <span class="dv">2</span>) {</span>
<span id="cb137-4"><a href="AR.html#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulación por aceptación-rechazo</span></span>
<span id="cb137-5"><a href="AR.html#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Beta a partir de uniforme</span></span>
<span id="cb137-6"><a href="AR.html#cb137-6" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">dbeta</span>((s1 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>(s1 <span class="sc">+</span> s2 <span class="sc">-</span> <span class="dv">2</span>), s1, s2)</span>
<span id="cb137-7"><a href="AR.html#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb137-8"><a href="AR.html#cb137-8" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb137-9"><a href="AR.html#cb137-9" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb137-10"><a href="AR.html#cb137-10" aria-hidden="true" tabindex="-1"></a>    ngen <span class="ot">&lt;&lt;-</span> ngen<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb137-11"><a href="AR.html#cb137-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (m<span class="sc">*</span>u <span class="sc">&lt;=</span> <span class="fu">dbeta</span>(x, s1, s2)) <span class="fu">return</span>(x)</span>
<span id="cb137-12"><a href="AR.html#cb137-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb137-13"><a href="AR.html#cb137-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-14"><a href="AR.html#cb137-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-15"><a href="AR.html#cb137-15" aria-hidden="true" tabindex="-1"></a>rbeta2n <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">s1 =</span> <span class="dv">2</span>, <span class="at">s2 =</span> <span class="dv">2</span>) {</span>
<span id="cb137-16"><a href="AR.html#cb137-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulación n valores Beta(s1, s2)</span></span>
<span id="cb137-17"><a href="AR.html#cb137-17" aria-hidden="true" tabindex="-1"></a>  ngen <span class="ot">&lt;&lt;-</span> <span class="dv">0</span></span>
<span id="cb137-18"><a href="AR.html#cb137-18" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb137-19"><a href="AR.html#cb137-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) x[i]<span class="ot">&lt;-</span><span class="fu">rbeta2</span>(s1, s2)</span>
<span id="cb137-20"><a href="AR.html#cb137-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb137-21"><a href="AR.html#cb137-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Empleando estas funciones podemos generar una muestra de <span class="math inline">\(10^3\)</span> observaciones de una <span class="math inline">\(\mathcal{Beta}(2, 4)\)</span> (calculando de paso el tiempo de CPU):</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="AR.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb138-2"><a href="AR.html#cb138-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb138-3"><a href="AR.html#cb138-3" aria-hidden="true" tabindex="-1"></a>ngen <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb138-4"><a href="AR.html#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(x <span class="ot">&lt;-</span> <span class="fu">rbeta2n</span>(nsim, s1, s2))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.02    0.00    0.01</code></pre>
<p>Para analizar la eficiencia podemos emplear el número de generaciones de la distribución auxiliar (siguiente sección):</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="AR.html#cb140-1" aria-hidden="true" tabindex="-1"></a>{<span class="fu">cat</span>(<span class="st">&quot;Número de generaciones = &quot;</span>, ngen)</span>
<span id="cb140-2"><a href="AR.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Número medio de generaciones = &quot;</span>, ngen<span class="sc">/</span>nsim)</span>
<span id="cb140-3"><a href="AR.html#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Proporción de rechazos = &quot;</span>, <span class="dv">1</span><span class="sc">-</span>nsim<span class="sc">/</span>ngen, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)}</span></code></pre></div>
<pre><code>## Número de generaciones =  2121
## Número medio de generaciones =  2.121
## Proporción de rechazos =  0.52852</code></pre>
<p>Finalmente podemos representar la distribución de los valores generados y compararla con la densidad teórica:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="AR.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="st">&quot;FD&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb142-2"><a href="AR.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x))</span>
<span id="cb142-3"><a href="AR.html#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, s1, s2), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dbeta-ar"></span>
<img src="04-Metodos_generales_continuas_files/figure-html/dbeta-ar-1.png" alt="Distribución de los valores generados mediante el método de aceptación-rechazo." width="75%" />
<p class="caption">
Figura 4.6: Distribución de los valores generados mediante el método de aceptación-rechazo.
</p>
</div>
<p>Al ser un método exacto de simulación (si está bien implementado), la distribución de los valores generados debería comportarse como una muestra genuina de la distribución objetivo.</p>
<div class="exercise">
<p><span id="exr:dacotada-ar" class="exercise"><strong>Ejercicio 4.1  </strong></span><br></p>
<p>Dar un algoritmo para simular la función de densidad dada por
<span class="math inline">\(f\left(x\right) = \frac{1}{16} \left( 3x^{2}+2x+2 \right)\)</span> si
<span class="math inline">\(0 \le x \le 2\)</span>, cero en otro caso. Estudiar su eficiencia.</p>
</div>
</div>
<div id="eficiencia-del-algoritmo" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Eficiencia del algoritmo<a href="AR.html#eficiencia-del-algoritmo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como medida de la eficiencia del algoritmo de aceptación-rechazo podríamos considerar el número de iteraciones del algoritmo, es decir, el número de generaciones de la densidad auxiliar y de comparaciones para aceptar un valor de la densidad objetivo.
Este número <span class="math inline">\(N\)</span> es aleatorio y sigue una distribución geométrica (entendida como el número de pruebas necesarias hasta obtener el primer éxito[^04-AR-3]) con parámetro <span class="math inline">\(p\)</span> (probabilidad de éxito) la probabilidad de aceptación en el paso 3:
<span class="math display">\[p = \frac{\text{area}\left(A_{f}\right)}{\text{area}\left( A_{cg}\right)} = \frac{1}{c}.\]</span></p>
<p>[^04-AR-3] Esta distribución también se puede definir como el número de fracasos hasta el primer éxito al realizar experimentos de Bernoulli independientes, que es como la consideraremos normalmente (ya que coincide con la parametrización de R, como un caso particular de la distribución binomial negativa).
Sin embargo, en este caso resulta más cómodo considerar el número total de pruebas.</p>
<p>Por tanto:
<span class="math display">\[E\left( N \right) = \frac1p = c\]</span>
es el número medio de iteraciones del algoritmo (el número medio de pares de variables <span class="math inline">\(\left( T,U\right)\)</span> que se necesitan generar, y de comparaciones, para obtener una simulación de la densidad objetivo).</p>
<p>Es obvio, por tanto, que cuanto más cercano a 1 sea el valor de <span class="math inline">\(c\)</span> más eficiente será el algoritmo (el caso de <span class="math inline">\(c=1\)</span> se correspondería con <span class="math inline">\(g=f\)</span> y no tendría sentido emplear este método).
Una vez fijada la densidad <span class="math inline">\(g\)</span>, el valor óptimo será:
<span class="math display">\[c_{\text{opt}}=\max_{\{x : g(x) &gt; 0\}} \frac{f(x)}{g(x)}.\]</span></p>
<p><br></p>
<div class="remark">
<p><span id="unlabeled-div-6" class="remark"><em>Nota:</em>. </span>Hay que tener en cuenta que la cota óptima es el número medio de iteraciones <span class="math inline">\(c\)</span> solo si conocemos las constantes normalizadoras.
Si solo se conoce la cuasi-densidad <span class="math inline">\(f^{\ast}\)</span> de la distribución objetivo (o de la auxiliar), la correspondiente cota óptima:
<span class="math display">\[\tilde{c} = \max_{\{x : g(x) &gt; 0\}} \frac{f^{\ast}(x)}{g(x)}\]</span>
asumirá la constante desconocida, aunque siempre podemos aproximar por simulación el verdadero valor de <span class="math inline">\(c\)</span> y a partir de él la constante normalizadora (ver Ejercicio <a href="AR.html#exr:post-pri-ar">4.2</a>).
Basta con tener en cuenta que, si <span class="math inline">\(f(x) = f^{\ast}(x)/k\)</span>:
<span class="math display">\[\frac{1}{c} = \frac{\text{area}\left(A_{f^{\ast}}\right)}{\text{area}\left( A_{\tilde{c}g}\right)} = \frac{k}{\tilde{c}},\]</span>
y por tanto <span class="math inline">\(k= \tilde{c}/c\)</span>.</p>
</div>
<div class="example">
<p><span id="exm:dnorm-ddexp-ar" class="example"><strong>Ejemplo 4.4  (simulación de la normal a partir de la doble exponencial) </strong></span><br></p>
<p>Se trata de simular la distribución normal estándar, con función de densidad:
<span class="math display">\[f(x)  =\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}} \text{, } x\in\mathbb{R}\text{, }\]</span>
empleando el método de aceptación-rechazo considerando como distribución auxiliar una doble exponencial con <span class="math inline">\(\lambda=1\)</span> (o distribución de Laplace):
<span class="math display">\[g(x)  =\frac{1}{2}e^{-\left| x \right|} \text{, } x\in\mathbb{R}.\]</span>
Esta distribución se utilizó en el Ejemplo <a href="inversion.html#exm:ddexp">4.2</a>, donde se definió la densidad auxiliar <code>ddexp(x, lambda)</code> y la función <code>rdexp(lambda)</code> para generar un valor aleatorio de esta distribución.</p>
<p>En este caso el soporte de ambas densidades es la recta real y el valor óptimo para <span class="math inline">\(c\)</span> es:
<span class="math display">\[c_{\text{opt}} = \max_{x\in\mathbb{R}}\frac{f(x)}{g(x) } = \max_{x\in\mathbb{R}} \frac{\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}}{\frac{1}{2}e^{-\left| x\right|  }} = \sqrt{\frac{2}{\pi}}\max_{x\in\mathbb{R}}e^{\varphi(x)} = \sqrt{\frac{2}{\pi}}e^{\max_{x\in\mathbb{R}}\varphi(x)},\]</span>
donde <span class="math inline">\(\varphi(x) = -\frac{x^{2}}{2}+\left| x \right|\)</span>.
Dado que esta función es simétrica, continua en toda la recta real y diferenciable tantas veces como se desee salvo en <span class="math inline">\(x=0\)</span>, bastará encontrar su máximo absoluto en el intervalo <span class="math inline">\([0,\infty]\)</span>:
<span class="math display">\[\begin{aligned}
x  &amp; &gt;0\Rightarrow\varphi^{\prime}(x)  =-x+1,\varphi
^{\prime\prime}(x)  =-1;\\
\{x  &amp; &gt;0,\varphi^{\prime}(x)  =0\}\Leftrightarrow x=1.
\end{aligned}\]</span>
Por tanto, como <span class="math inline">\(\varphi^{\prime\prime}(1) &lt;0\)</span>, <span class="math inline">\(\varphi\)</span> alcanza un máximo relativo en <span class="math inline">\(x=1\)</span> y otro de idéntico valor en <span class="math inline">\(x=-1\)</span>.
Resulta fácil demostrar que ambos son máximos absolutos
(por los intervalos de crecimiento y decrecimiento de la función).
Como consecuencia:
<span class="math display">\[c_{\text{opt}} = \sqrt{\frac{2}{\pi}}e^{\varphi(1)}
=\sqrt{\frac{2}{\pi}}e^{1/2} =\sqrt{\frac{2e}{\pi}} \approx 1.3155.\]</span></p>
<p>Si comparamos la densidad objetivo con la auxiliar reescalada con los parámetros óptimos (Figura <a href="AR.html#fig:dnorm-ddexp-plot">4.7</a>), vemos que esta última está por encima, como debería ocurrir, pero llegan a tocarse (lo que validaría el cálculo para la obtención de la cota óptima).</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="AR.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># densidad objetivo: dnorm</span></span>
<span id="cb143-2"><a href="AR.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co"># densidad auxiliar: ddexp</span></span>
<span id="cb143-3"><a href="AR.html#cb143-3" aria-hidden="true" tabindex="-1"></a>c.opt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">/</span>pi)</span>
<span id="cb143-4"><a href="AR.html#cb143-4" aria-hidden="true" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb143-5"><a href="AR.html#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(c.opt <span class="sc">*</span> <span class="fu">ddexp</span>(x), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb143-6"><a href="AR.html#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(dnorm, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dnorm-ddexp-plot"></span>
<img src="04-Metodos_generales_continuas_files/figure-html/dnorm-ddexp-plot-1.png" alt="Densidad objetivo (normal estándar, línea continua) y densidad auxiliar (doble exponencial, línea discontinua) reescalada." width="75%" />
<p class="caption">
Figura 4.7: Densidad objetivo (normal estándar, línea continua) y densidad auxiliar (doble exponencial, línea discontinua) reescalada.
</p>
</div>
<p>Alternativamente, en lugar de obtener la cota óptima de modo analítico, podríamos aproximarla numéricamente:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="AR.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOTA: Cuidado con los límites</span></span>
<span id="cb144-2"><a href="AR.html#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="co"># optimize(f = function(x) dnorm(x)/ddexp(x), maximum = TRUE, interval = c(-0.5,0.5))</span></span>
<span id="cb144-3"><a href="AR.html#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize</span>(<span class="at">f =</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x)<span class="sc">/</span><span class="fu">ddexp</span>(x), <span class="at">maximum =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## $maximum
## [1] 1
## 
## $objective
## [1] 1.3155</code></pre>
<p>Vemos que la aproximación numérica coincide con el valor óptimo real <span class="math inline">\(c_{\text{opt}} \approx\)</span> 1.31549 (que se alcanza en <span class="math inline">\(x = \pm 1\)</span>).</p>
<p>Para establecer la condición de aceptación o rechazo es recomendable emplear
<span class="math inline">\(c\cdot U\cdot g(T) \leq f(T)\)</span>.
Aunque, en este caso concreto, sería equivalente a:
<span class="math display">\[c\cdot U\cdot\frac{g(T)  }{f(T)  }=\sqrt{\frac
{2e}{\pi}}U\sqrt{\frac{\pi}{2}}\exp\left( \frac{T^{2}}{2}-\left\vert
T\right\vert \right)  =U\cdot\exp\left( \frac{T^{2}}{2}-\left\vert
T\right\vert +\frac{1}{2}\right) \leq 1.\]</span></p>
<p>Teniendo en cuenta los resultados anteriores, podríamos emplear el siguiente código para generar los valores de la densidad objetivo:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="AR.html#cb146-1" aria-hidden="true" tabindex="-1"></a>ngen <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb146-2"><a href="AR.html#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="AR.html#cb146-3" aria-hidden="true" tabindex="-1"></a>rnormAR <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb146-4"><a href="AR.html#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación por aceptación-rechazo</span></span>
<span id="cb146-5"><a href="AR.html#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal estandar a partir de doble exponencial</span></span>
<span id="cb146-6"><a href="AR.html#cb146-6" aria-hidden="true" tabindex="-1"></a>  c.opt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">/</span>pi)</span>
<span id="cb146-7"><a href="AR.html#cb146-7" aria-hidden="true" tabindex="-1"></a>  lambda.opt <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb146-8"><a href="AR.html#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb146-9"><a href="AR.html#cb146-9" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb146-10"><a href="AR.html#cb146-10" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rdexp</span>(lambda.opt) <span class="co"># rdexpn(1, lambda.opt)</span></span>
<span id="cb146-11"><a href="AR.html#cb146-11" aria-hidden="true" tabindex="-1"></a>    ngen <span class="ot">&lt;&lt;-</span> ngen <span class="sc">+</span> <span class="dv">1</span> <span class="co"># Comentar esta línea para uso normal</span></span>
<span id="cb146-12"><a href="AR.html#cb146-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if (u*exp((x^2+1)*0.5-abs(x)) &lt;= 1) return(x)</span></span>
<span id="cb146-13"><a href="AR.html#cb146-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (c.opt <span class="sc">*</span> u <span class="sc">*</span> <span class="fu">ddexp</span>(x, lambda.opt) <span class="sc">&lt;=</span> <span class="fu">dnorm</span>(x)) <span class="fu">return</span>(x)</span>
<span id="cb146-14"><a href="AR.html#cb146-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb146-15"><a href="AR.html#cb146-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb146-16"><a href="AR.html#cb146-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-17"><a href="AR.html#cb146-17" aria-hidden="true" tabindex="-1"></a>rnormARn <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb146-18"><a href="AR.html#cb146-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación n valores N(0,1)</span></span>
<span id="cb146-19"><a href="AR.html#cb146-19" aria-hidden="true" tabindex="-1"></a>  ngen <span class="ot">&lt;&lt;-</span> <span class="dv">0</span></span>
<span id="cb146-20"><a href="AR.html#cb146-20" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb146-21"><a href="AR.html#cb146-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) x[i] <span class="ot">&lt;-</span> <span class="fu">rnormAR</span>()</span>
<span id="cb146-22"><a href="AR.html#cb146-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb146-23"><a href="AR.html#cb146-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Generamos una muestra de <span class="math inline">\(10^4\)</span> observaciones:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="AR.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb147-2"><a href="AR.html#cb147-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb147-3"><a href="AR.html#cb147-3" aria-hidden="true" tabindex="-1"></a>ngen <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb147-4"><a href="AR.html#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(x <span class="ot">&lt;-</span> <span class="fu">rnormARn</span>(nsim))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.05    0.01    0.06</code></pre>
<p>Evaluamos la eficiencia:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="AR.html#cb149-1" aria-hidden="true" tabindex="-1"></a>{<span class="fu">cat</span>(<span class="st">&quot;Número de generaciones = &quot;</span>, ngen)</span>
<span id="cb149-2"><a href="AR.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Número medio de generaciones = &quot;</span>, ngen<span class="sc">/</span>nsim)</span>
<span id="cb149-3"><a href="AR.html#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Proporción de rechazos = &quot;</span>, <span class="dv">1</span><span class="sc">-</span>nsim<span class="sc">/</span>ngen, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)}</span></code></pre></div>
<pre><code>## Número de generaciones =  13178
## Número medio de generaciones =  1.3178
## Proporción de rechazos =  0.24116</code></pre>
<p>Estos valores serían aproximaciones por simulación de los correspondientes valores teóricos (valor medio <span class="math inline">\(c \approx 1.3155\)</span> y probabilidad de rechazo <span class="math inline">\(1 - p = 1 - 1/c \approx 0.23983\)</span>).
A partir de ellos podríamos decir que el algoritmo es bastante eficiente.</p>
<p>Finalmente comparamos la distribución de los valores generados con la densidad teórica:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="AR.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="st">&quot;FD&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb151-2"><a href="AR.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x))</span>
<span id="cb151-3"><a href="AR.html#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(dnorm, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dnorm-ar"></span>
<img src="04-Metodos_generales_continuas_files/figure-html/dnorm-ar-1.png" alt="Distribución de los valores generados mediante el método de aceptación-rechazo." width="75%" />
<p class="caption">
Figura 4.8: Distribución de los valores generados mediante el método de aceptación-rechazo.
</p>
</div>
<p>Podemos observar que la distribución de los valores generados es la que cabría esperar de una muestra de tamaño <code>nsim</code> de la distribución objetivo (lo que nos ayudaría a confirmar que el algoritmo está bien implementado, al ser un método exacto de simulación).</p>
</div>
</div>
<div id="elección-de-la-densidad-auxiliar" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Elección de la densidad auxiliar<a href="AR.html#elección-de-la-densidad-auxiliar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El principal problema con este método es encontrar una densidad auxiliar <span class="math inline">\(g\)</span> de forma que <span class="math inline">\(c_{\text{opt}}\)</span> sea próximo a 1.
Una solución intermedia consiste en seleccionar una familia paramétrica de densidades <span class="math inline">\(\{g_{\theta} : \theta \in \Theta\}\)</span> entre las que haya alguna que se parezca bastante a <span class="math inline">\(f\)</span>,
encontrar el valor de <span class="math inline">\(c\)</span> óptimo para cada densidad de esa familia:
<span class="math display">\[c_{\theta}=\max_{x}\frac{f(x)  }{g_{\theta}(x) }\]</span>
y, finalmente, elegir el mejor valor <span class="math inline">\(\theta_{0}\)</span> del parámetro, en el sentido de ofrecer el menor posible <span class="math inline">\(c_{\theta}\)</span>:
<span class="math display">\[c_{\theta_{0}}=\min_{\theta\in\Theta}\max_{x}\frac{f(x) }{g_{\theta}(x)}.\]</span></p>
<div class="example">
<p><span id="exm:dnorm-ddexp-arb" class="example"><strong>Ejemplo 4.5  (simulación de la normal mediante la doble exponencial continuación) </strong></span><br></p>
<p>Continuando con el Ejemplo <a href="AR.html#exm:dnorm-ddexp-ar">4.4</a> anterior sobre la simulación de una normal estándar mediante el método de aceptación-rechazo, en lugar de fijar la densidad auxiliar a una doble exponencial con <span class="math inline">\(\lambda=1\)</span>, consideraremos el caso general de <span class="math inline">\(\lambda&gt;0\)</span>:
<span class="math display">\[g_{\lambda}(x)  = \frac{\lambda}{2}e^{-\lambda\left| x \right|} \text{, } x\in\mathbb{R}.\]</span></p>
<p>Si pretendemos encontrar el mejor valor de <span class="math inline">\(\lambda\)</span>, en términos de eficiencia del algoritmo, debemos calcular:
<span class="math display">\[c_{\lambda_{0}} = \min_{\lambda&gt;0}\max_{x\in\mathbb{R}}\frac{f(x)}{g_{\lambda(x)}}
=\min_{\lambda&gt;0}\max_{x\in\mathbb{R}}\frac{\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}}{\frac{\lambda}{2}e^{-\lambda \left| x \right| }}.\]</span>
De forma totalmente análoga a la vista para el caso <span class="math inline">\(\lambda=1\)</span>, se tiene que:
<span class="math display">\[c_{\lambda}=\max_{x\in\mathbb{R}}\frac{\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}}{\frac{\lambda}{2}e^{-\lambda \left| x \right|  }}=\frac{1}{\lambda}\sqrt{\frac{2}{\pi}}\max_{x\in\mathbb{R}}e^{\varphi
_{\lambda(x)}}=\frac{1}{\lambda}\sqrt{\frac{2}{\pi}}e^{\max_{x\in\mathbb{R}}\varphi_{\lambda(x)} },\]</span>
donde <span class="math inline">\(\varphi_{\lambda}(x) =-\frac{x^{2}}{2}+\lambda\left| x \right|\)</span>.
De forma totalmente similar también puede probarse que <span class="math inline">\(\varphi_{\lambda}\)</span> alcanza su máximo absoluto en los puntos <span class="math inline">\(x=\pm\lambda\)</span>, siendo dicho valor máximo
<span class="math inline">\(\varphi_{\lambda}\left( \pm\lambda \right) = \frac{\lambda^{2}}{2}\)</span>.
Como consecuencia:
<span class="math display">\[c_{\lambda}=\frac{1}{\lambda}\sqrt{\frac{2}{\pi}}e^{\varphi_{\lambda}\left( \pm\lambda \right)} =\frac{e^{\frac{\lambda^{2}}{2}}}{\lambda}\sqrt{\frac{2}{\pi}}.\]</span></p>
<p>Finalmente debemos encontrar <span class="math inline">\(\lambda_{0}\)</span> tal que <span class="math inline">\(c_{\lambda_{0}}=\min_{\lambda&gt;0}c_{\lambda}\)</span>.
Como:
<span class="math display">\[\frac{\partial c_{\lambda}}{\partial \lambda} =\sqrt{\frac{2}{\pi}}\frac{e^{\frac{\lambda^{2}}{2}}\left( \lambda^{2}-1\right)  }{\lambda^{2}},\]</span>
entonces <span class="math inline">\(\frac{\partial c_{\lambda}}{\partial \lambda} = 0\Leftrightarrow\lambda=1\)</span>, ya que <span class="math inline">\(\lambda&gt;0\)</span>.
Además:
<span class="math display">\[\left. \frac{\partial ^{2}c_{\lambda}}{\partial \lambda^{2}}\right|_{\lambda=1} =\left.\sqrt{\frac
{2}{\pi}}\frac{e^{\frac{\lambda^{2}}{2}}\left(  \lambda^{5}-\lambda
^{3}+2\lambda\right)  }{\lambda^{4}}\right|_{\lambda=1}=2\sqrt{\frac{2e}{\pi}}&gt;0,\]</span>
luego en <span class="math inline">\(\lambda=1\)</span> se alcanza el mínimo.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="AR.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>x<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span>pi), <span class="fl">0.1</span>, <span class="fl">2.5</span>,</span>
<span id="cb152-2"><a href="AR.html#cb152-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(lambda), <span class="at">ylab =</span> <span class="fu">expression</span>(c[lambda]))</span>
<span id="cb152-3"><a href="AR.html#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cop-lambda"></span>
<img src="04-Metodos_generales_continuas_files/figure-html/cop-lambda-1.png" alt="Representación de la cota óptima dependiedo del valor del parámetro y mínimo global (línea vertical)." width="75%" />
<p class="caption">
Figura 4.9: Representación de la cota óptima dependiedo del valor del parámetro y mínimo global (línea vertical).
</p>
</div>
<p>De esto se deduce que la mejor densidad auxiliar doble exponencial es la correspondiente a <span class="math inline">\(\lambda=1\)</span>.
Por tanto el algoritmo más eficiente, con esta familia de densidades auxiliares, es el expuesto en el Ejemplo <a href="AR.html#exm:dnorm-ddexp-ar">4.4</a>.</p>
<p>Alternativamente también podríamos aproximar simultáneamente el parámetro óptimo y la cota óptima de la densidad auxiliar numéricamente:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="AR.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtención de valores c y lambda óptimos aproximados</span></span>
<span id="cb153-2"><a href="AR.html#cb153-2" aria-hidden="true" tabindex="-1"></a>fopt <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda) {</span>
<span id="cb153-3"><a href="AR.html#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Obtiene c fijado lambda</span></span>
<span id="cb153-4"><a href="AR.html#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">optimize</span>(<span class="at">f =</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x)<span class="sc">/</span><span class="fu">ddexp</span>(x,lambda),</span>
<span id="cb153-5"><a href="AR.html#cb153-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">maximum =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">$</span>objective</span>
<span id="cb153-6"><a href="AR.html#cb153-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb153-7"><a href="AR.html#cb153-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-8"><a href="AR.html#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Encontrar lambda que minimiza</span></span>
<span id="cb153-9"><a href="AR.html#cb153-9" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">optimize</span>(fopt, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>))</span>
<span id="cb153-10"><a href="AR.html#cb153-10" aria-hidden="true" tabindex="-1"></a>lambda.opt2 <span class="ot">&lt;-</span> res<span class="sc">$</span>minimum</span>
<span id="cb153-11"><a href="AR.html#cb153-11" aria-hidden="true" tabindex="-1"></a>c.opt2 <span class="ot">&lt;-</span> res<span class="sc">$</span>objective</span>
<span id="cb153-12"><a href="AR.html#cb153-12" aria-hidden="true" tabindex="-1"></a>lambda.opt2 </span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="AR.html#cb155-1" aria-hidden="true" tabindex="-1"></a>c.opt2</span></code></pre></div>
<pre><code>## [1] 1.3155</code></pre>
</div>
</div>
<div id="bayes-ar" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Ejemplo: inferencia bayesiana<a href="AR.html#bayes-ar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El algoritmo de aceptación-rechazo se emplea habitualmente en inferencia bayesiana.
Denotando por:</p>
<ul>
<li><p><span class="math inline">\(f(x | \theta)\)</span> la densidad de una observación condicionada al valor del parámetro <span class="math inline">\(\theta \in \Theta\)</span>.</p></li>
<li><p><span class="math inline">\(\pi(\theta)\)</span> la densidad a priori (se supone que el parámetro <span class="math inline">\(\theta\)</span> es aleatorio).</p></li>
<li><p><span class="math inline">\(\mathbf{x}=(x_1,...,x_n)^{\top}\)</span> la muestra observada.</p></li>
</ul>
<p>Suponiendo que <span class="math inline">\(\mathbf{x}\)</span> es una muestra aleatoria simple, tendríamos que:
<span class="math display">\[f(\mathbf{x}|\theta) = \prod\limits_{i=1}^{n}f(x_i | \theta)\]</span>
que, considerada como función de <span class="math inline">\(\theta\)</span>, se denomina función de verosimilitud y se denota habitualmente por <span class="math inline">\(\mathcal{L}(\theta | \mathbf{x})\)</span>.
Empleando esta notación, también podríamos expresar la distribución conjunta como:
<span class="math display">\[f(\mathbf{x}, \theta) = \mathcal{L}(\theta | \mathbf{x})\pi(\theta)\]</span></p>
<p>El objetivo sería simular la distribución a posteriori de <span class="math inline">\(\theta\)</span>:
<span class="math display">\[\pi(\theta|\mathbf{x}) = \frac{\mathcal{L}(\theta | \mathbf{x})\pi(\theta)}{\int_\Theta \mathcal{L}(\theta | \mathbf{x})\pi(\theta)d\theta}\]</span>
Es decir:
<span class="math display">\[\pi(\theta | \mathbf{x}) \propto \mathcal{L}(\theta | \mathbf{x})\pi(\theta).\]</span></p>
<p>Como esta distribución cambia al variar la muestra observada, puede resultar difícil encontrar una densidad auxiliar adecuada para simular valores de la densidad a posteriori <span class="math inline">\(\pi(\theta|\mathbf{x})\)</span> mediante el método de aceptación-rechazo.</p>
<p>Una forma de proceder (en principio no recomendada), sería considerar como densidad auxiliar la densidad a priori <span class="math inline">\(\pi(\theta)\)</span>.
Así resultaría bastante fácil obtener la cota optima <span class="math inline">\(\tilde{c}\)</span> y verificar la condición de aceptación<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a>, ya que:</p>
<ul>
<li><p><span class="math inline">\(\pi(\theta |\mathbf{x})/\pi(\theta)\propto \mathcal{L}(\theta | \mathbf{x})\)</span></p></li>
<li><p><span class="math inline">\(\mathcal{L}(\theta | \mathbf{x}) \leq \tilde{c} = \mathcal{L}(\hat{\theta} | \mathbf{x})\)</span> siendo
<span class="math inline">\(\hat{\theta}\)</span> el estimador máximo verosímil de <span class="math inline">\(\theta\)</span>.</p></li>
</ul>
<p>Teniendo en cuenta esto, el algoritmo de aceptación-rechazo sería:</p>
<ol style="list-style-type: decimal">
<li><p>Generar <span class="math inline">\(U \sim \mathcal{U}(0, 1)\)</span>.</p></li>
<li><p>Generar <span class="math inline">\(\tilde{\theta}\sim \pi(\theta)\)</span>.</p></li>
<li><p>Si <span class="math inline">\(\mathcal{L}(\hat{\theta} | \mathbf{x}) \cdot U \leq \mathcal{L}(\tilde{\theta} | \mathbf{x})\)</span> devolver <span class="math inline">\(\tilde{\theta}\)</span>,</p>
<p>en caso contrario volver al paso 1.</p></li>
</ol>
<p>Aunque, como se muestra en el siguiente ejercicio, esta elección de densidad auxiliar puede ser muy poco adecuada, siendo preferible en la práctica emplear un método adaptativo que construya la densidad auxiliar de forma automática (Sección <a href="modAR.html#ars">4.3.1</a>).</p>
<div class="exercise">
<p><span id="exr:post-pri-ar" class="exercise"><strong>Ejercicio 4.2  (Simulación de la distribución a posteriori a partir de la distribución a priori) </strong></span><br></p>
<!-- 
Basado en el Ejercicio 2.23 de Robert y Casella, 2009 
Cambiar a ejemplo y apartado b) a ejercicio $n = 100$, $\theta_{0}=3$
Comentar resultados (intervalos de probabilidad a posteriori) y eficiencia del método
-->
<p>Se desea estimar la media <span class="math inline">\(\theta\)</span> de una distribución normal <span class="math inline">\(N(\theta, 1)\)</span> (supondremos que la desviación típica es conocida).
Para ello se va a simular la distribución a posteriori de <span class="math inline">\(\theta\)</span> por el método de aceptación-rechazo.
En este caso, en la estimación bayesiana de la media de una distribución normal, se suele utilizar una distribución de Cauchy como distribución a priori.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Generar una muestra i.i.d. <span class="math inline">\(X_{i}\sim N(\theta_{0},1)\)</span> de tamaño
<span class="math inline">\(n=10\)</span> con <span class="math inline">\(\theta_{0}=1\)</span>. Utilizar una <span class="math inline">\(Cauchy(0,1)\)</span>
(<code>rcauchy()</code>) como distribución a priori y como densidad auxiliar.
Simular por aceptación-rechazo una muestra de la densidad a
posteriori (emplear <code>dnorm()</code> para construir la verosimilitud).
Obtener el intervalo de probabilidad/credibilidad al 95%.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="AR.html#cb157-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb157-2"><a href="AR.html#cb157-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb157-3"><a href="AR.html#cb157-3" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb157-4"><a href="AR.html#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb157-5"><a href="AR.html#cb157-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu0)</span>
<span id="cb157-6"><a href="AR.html#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de verosimilitud</span></span>
<span id="cb157-7"><a href="AR.html#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co"># lik1 &lt;- function(mu) prod(dnorm(x, mean = mu)) # escalar</span></span>
<span id="cb157-8"><a href="AR.html#cb157-8" aria-hidden="true" tabindex="-1"></a>lik <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(mu) <span class="fu">prod</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu))) <span class="co"># vectorial</span></span>
<span id="cb157-9"><a href="AR.html#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Cota óptima</span></span>
<span id="cb157-10"><a href="AR.html#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimación por máxima verosimilitud</span></span>
<span id="cb157-11"><a href="AR.html#cb157-11" aria-hidden="true" tabindex="-1"></a>emv <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f =</span> lik, <span class="at">int =</span> <span class="fu">range</span>(x), <span class="at">maximum =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-12"><a href="AR.html#cb157-12" aria-hidden="true" tabindex="-1"></a>emv</span></code></pre></div>
<pre><code>## $maximum
## [1] 0.73538
## 
## $objective
## [1] 3.3036e-08</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="AR.html#cb159-1" aria-hidden="true" tabindex="-1"></a>c.cuasi <span class="ot">&lt;-</span> emv<span class="sc">$</span>objective</span></code></pre></div>
<p>En este caso concreto, ya sabríamos que el estimador máximo verosímil es la media muestral:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="AR.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] 0.7354</code></pre>
<p>y por tanto:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="AR.html#cb162-1" aria-hidden="true" tabindex="-1"></a>c.cuasi <span class="ot">&lt;-</span> <span class="fu">lik</span>(<span class="fu">mean</span>(x))</span>
<span id="cb162-2"><a href="AR.html#cb162-2" aria-hidden="true" tabindex="-1"></a>c.cuasi   </span></code></pre></div>
<pre><code>## [1] 3.3036e-08</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="AR.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># f.cuasi &lt;- function(mu) sapply(mu, lik1)*dcauchy(mu)</span></span>
<span id="cb164-2"><a href="AR.html#cb164-2" aria-hidden="true" tabindex="-1"></a>f.cuasi <span class="ot">&lt;-</span> <span class="cf">function</span>(mu) <span class="fu">lik</span>(mu)<span class="sc">*</span><span class="fu">dcauchy</span>(mu)    </span>
<span id="cb164-3"><a href="AR.html#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(c.cuasi <span class="sc">*</span> <span class="fu">dcauchy</span>(x), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, c.cuasi<span class="sc">/</span>pi), <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb164-4"><a href="AR.html#cb164-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;mu&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;cuasi-densidad&quot;</span>)</span>
<span id="cb164-5"><a href="AR.html#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(f.cuasi, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:post-pri-plot"></span>
<img src="04-Metodos_generales_continuas_files/figure-html/post-pri-plot-1.png" alt="Comparación de la cuasi-densidad a posteriori (línea contínua) con la densidad a priori reescalada (línea discontinua)." width="75%" />
<p class="caption">
Figura 4.10: Comparación de la cuasi-densidad a posteriori (línea contínua) con la densidad a priori reescalada (línea discontinua).
</p>
</div>
<p>Por ejemplo, podríamos emplear el siguiente código para generar simulaciones de la distribución a posteriori mediante aceptación-rechazo a partir de la distribución de Cauchy:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="AR.html#cb165-1" aria-hidden="true" tabindex="-1"></a>ngen <span class="ot">&lt;-</span> nsim</span>
<span id="cb165-2"><a href="AR.html#cb165-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(nsim)</span>
<span id="cb165-3"><a href="AR.html#cb165-3" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> c.cuasi<span class="sc">*</span><span class="fu">runif</span>(nsim) <span class="sc">&gt;</span> <span class="fu">lik</span>(mu) <span class="co"># TRUE si no verifica condición</span></span>
<span id="cb165-4"><a href="AR.html#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Volver a generar si no verifica condición</span></span>
<span id="cb165-5"><a href="AR.html#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">sum</span>(ind)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb165-6"><a href="AR.html#cb165-6" aria-hidden="true" tabindex="-1"></a>  le <span class="ot">&lt;-</span> <span class="fu">sum</span>(ind)</span>
<span id="cb165-7"><a href="AR.html#cb165-7" aria-hidden="true" tabindex="-1"></a>  ngen <span class="ot">&lt;-</span> ngen <span class="sc">+</span> le</span>
<span id="cb165-8"><a href="AR.html#cb165-8" aria-hidden="true" tabindex="-1"></a>  mu[ind] <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(le)</span>
<span id="cb165-9"><a href="AR.html#cb165-9" aria-hidden="true" tabindex="-1"></a>  ind[ind] <span class="ot">&lt;-</span> c.cuasi<span class="sc">*</span><span class="fu">runif</span>(le) <span class="sc">&gt;</span> <span class="fu">lik</span>(mu[ind]) <span class="co"># TRUE si no verifica condición</span></span>
<span id="cb165-10"><a href="AR.html#cb165-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb165-11"><a href="AR.html#cb165-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-12"><a href="AR.html#cb165-12" aria-hidden="true" tabindex="-1"></a>{ <span class="co"># Número generaciones</span></span>
<span id="cb165-13"><a href="AR.html#cb165-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Número de generaciones = &quot;</span>, ngen)</span>
<span id="cb165-14"><a href="AR.html#cb165-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Número medio de generaciones = &quot;</span>, ngen<span class="sc">/</span>nsim)</span>
<span id="cb165-15"><a href="AR.html#cb165-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Proporción de rechazos = &quot;</span>, <span class="dv">1</span><span class="sc">-</span>nsim<span class="sc">/</span>ngen,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb165-16"><a href="AR.html#cb165-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Número de generaciones =  59422
## Número medio de generaciones =  5.9422
## Proporción de rechazos =  0.83171</code></pre>
<!-- 
include = FALSE
hist(mu, freq=FALSE, breaks = "FD", main = "")
curve(f.cuasi, col = "blue", add = TRUE)
-->
<p>A partir de la aproximación del número medio de generaciones podemos aproximar la constante normalizadora:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="AR.html#cb167-1" aria-hidden="true" tabindex="-1"></a>c.sim <span class="ot">&lt;-</span> ngen<span class="sc">/</span>nsim</span>
<span id="cb167-2"><a href="AR.html#cb167-2" aria-hidden="true" tabindex="-1"></a>cte.sim <span class="ot">&lt;-</span> c.cuasi<span class="sc">/</span>c.sim</span>
<span id="cb167-3"><a href="AR.html#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="co"># integrate(f.cuasi, -Inf, Inf)</span></span>
<span id="cb167-4"><a href="AR.html#cb167-4" aria-hidden="true" tabindex="-1"></a>f.aprox <span class="ot">&lt;-</span> <span class="cf">function</span>(mu) <span class="fu">f.cuasi</span>(mu)<span class="sc">/</span>cte.sim</span></code></pre></div>
<p>Finalmente, a partir de los valores generados podemos aproximar el intervalo de probabilidad al 95% (intervalo de credibilidad bayesiano):</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="AR.html#cb168-1" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(mu, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb168-2"><a href="AR.html#cb168-2" aria-hidden="true" tabindex="-1"></a>q</span></code></pre></div>
<pre><code>##     2.5%    97.5% 
## 0.050011 1.260262</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="AR.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Representar estimador e IC Bayes</span></span>
<span id="cb170-2"><a href="AR.html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mu, <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">&quot;FD&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb170-3"><a href="AR.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co"># abline(v = mean(x), lty = 3) # Estimación frecuentista</span></span>
<span id="cb170-4"><a href="AR.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(mu), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># Estimación Bayesiana</span></span>
<span id="cb170-5"><a href="AR.html#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> q, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb170-6"><a href="AR.html#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(f.aprox, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ic-bayes"></span>
<img src="04-Metodos_generales_continuas_files/figure-html/ic-bayes-1.png" alt="Distribución de los valores generados y aproximación del intervalo de credibilidad." width="75%" />
<p class="caption">
Figura 4.11: Distribución de los valores generados y aproximación del intervalo de credibilidad.
</p>
</div></li>
<li><p>Repetir el apartado anterior con <span class="math inline">\(n=100\)</span>.</p></li>
</ol>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="16">
<li id="fn16"><p>Una cuasi-densidad es cualquier función no negativa <span class="math inline">\(f^{\ast}(x) \geq 0\)</span> integrable. Por tanto, si <span class="math inline">\(k = \int_{-\infty}^{+\infty}f^{\ast}(x)dx\)</span> es el área bajo esta curva, denominada <em>constante normalizadora</em>, entonces <span class="math inline">\(f(x) = \frac{1}{k}f^{\ast}(x)\)</span> es una densidad.
En ocasiones no interesa especialmente esta constante <span class="math inline">\(k\)</span> (no es necesario calcularla o simplemente se quieren simplificar las expresiones) y se denota por <span class="math inline">\(f(x) \propto f^{\ast}(x)\)</span> que la función de densidad es proporcional a la cuasi-densidad.
Por ejemplo, a partir de la densidad conjunta <span class="math inline">\(f(x, y)\)</span> de una variable aleatoria bidimensional <span class="math inline">\((X, Y)\)</span>, podemos obtener la densidad de la distribución condicionada <span class="math inline">\(X|Y=y_0\)</span>:
<span class="math display">\[f(x | y_0) = \frac{f(x, y_0)}{f_Y(y_0)}\]</span>
siendo <span class="math inline">\(f_Y(y_0) = \int_{-\infty}^{+\infty}f(x, y_0)dx\)</span> la densidad marginal de <span class="math inline">\(Y\)</span> evaluada en <span class="math inline">\(y_0\)</span>. Por tanto <span class="math inline">\(f(x | y_0) \propto f(x, y_0)\)</span>.
De la expresión anterior también se deduce que:
<span class="math display">\[f(x, y) = f(x | y)f_Y(y) = f(y | x)f_X(x)\]</span>
y podríamos escribir que:
<span class="math display">\[f(y | x) \propto f(x | y)f_Y(y)\]</span>
que sería una expresión del <em>teorema de Bayes</em> aplicado a densidades.<a href="AR.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>Si <span class="math inline">\(\alpha\)</span> o <span class="math inline">\(\beta\)</span> son iguales a 1 puede simularse fácilmente por el método de inversión y si alguno es menor que 1 esta densidad no está acotada.<a href="AR.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p>La condición <span class="math inline">\(\tilde{c} \cdot U \cdot g(T) \leq f^{\ast}(T)\)</span> del algoritmo general, se puede reescribir como <span class="math inline">\(\tilde{c} \cdot U \leq f^{\ast}(T) / g(T)\)</span>.<a href="AR.html#fnref18" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inversion.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modAR.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/rubenfcasal/simbook/edit/master/04-Metodos_generales_continuas.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Simulacion.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
