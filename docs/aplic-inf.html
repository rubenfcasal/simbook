<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.4 Métodos Monte Carlo en Inferencia Estadística | Técnicas de Simulación y Remuestreo</title>
  <meta name="description" content="Apuntes de Simulación Estadística y Remuestreo." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="7.4 Métodos Monte Carlo en Inferencia Estadística | Técnicas de Simulación y Remuestreo" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Apuntes de Simulación Estadística y Remuestreo." />
  <meta name="github-repo" content="rubenfcasal/simbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.4 Métodos Monte Carlo en Inferencia Estadística | Técnicas de Simulación y Remuestreo" />
  
  <meta name="twitter:description" content="Apuntes de Simulación Estadística y Remuestreo." />
  

<meta name="author" content="Rubén Fernández Casal (ruben.fcasal@udc.es)" />
<meta name="author" content="Ricardo Cao (rcao@udc.es)" />
<meta name="author" content="Julián Costa (julian.costa@udc.es)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="opt-MC.html"/>
<link rel="next" href="técnicas-de-reducción-de-la-varianza.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Técnicas de Simulación y Remuestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a>
<ul>
<li class="chapter" data-level="1.1" data-path="conceptos.html"><a href="conceptos.html"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="conceptos.html"><a href="conceptos.html#ealbum"><i class="fa fa-check"></i><b>1.1.1</b> Ejemplo</a></li>
<li class="chapter" data-level="1.1.2" data-path="conceptos.html"><a href="conceptos.html#ventajas-e-inconvenientes-de-la-simulación"><i class="fa fa-check"></i><b>1.1.2</b> Ventajas e inconvenientes de la simulación</a></li>
<li class="chapter" data-level="1.1.3" data-path="conceptos.html"><a href="conceptos.html#aplicaciones-de-la-simulación"><i class="fa fa-check"></i><b>1.1.3</b> Aplicaciones de la simulación</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html"><i class="fa fa-check"></i><b>1.2</b> Tipos de números aleatorios</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html#números-aleatorios-puros"><i class="fa fa-check"></i><b>1.2.1</b> Números aleatorios puros</a></li>
<li class="chapter" data-level="1.2.2" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html#números-cuasi-aleatorios"><i class="fa fa-check"></i><b>1.2.2</b> Números cuasi-aleatorios</a></li>
<li class="chapter" data-level="1.2.3" data-path="tipos-de-números-aleatorios.html"><a href="tipos-de-números-aleatorios.html#números-pseudo-aleatorios"><i class="fa fa-check"></i><b>1.2.3</b> Números pseudo-aleatorios</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rrng.html"><a href="rrng.html"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios en R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="rrng.html"><a href="rrng.html#oprrng"><i class="fa fa-check"></i><b>1.3.1</b> Opciones</a></li>
<li class="chapter" data-level="1.3.2" data-path="rrng.html"><a href="rrng.html#paquetes-de-r"><i class="fa fa-check"></i><b>1.3.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="1.3.3" data-path="rrng.html"><a href="rrng.html#tiempo-de-cpu"><i class="fa fa-check"></i><b>1.3.3</b> Tiempo de CPU</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>1.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="gen-pseudo.html"><a href="gen-pseudo.html"><i class="fa fa-check"></i><b>2</b> Generación de números pseudoaleatorios</a>
<ul>
<li class="chapter" data-level="2.1" data-path="gen-cong.html"><a href="gen-cong.html"><i class="fa fa-check"></i><b>2.1</b> Generadores congruenciales lineales</a></li>
<li class="chapter" data-level="2.2" data-path="ext-cong.html"><a href="ext-cong.html"><i class="fa fa-check"></i><b>2.2</b> Extensiones</a></li>
<li class="chapter" data-level="2.3" data-path="calgen.html"><a href="calgen.html"><i class="fa fa-check"></i><b>2.3</b> Análisis de la calidad de un generador</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="calgen.html"><a href="calgen.html#repetición-de-contrastes"><i class="fa fa-check"></i><b>2.3.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="2.3.2" data-path="calgen.html"><a href="calgen.html#baterias"><i class="fa fa-check"></i><b>2.3.2</b> Baterías de contrastes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="resultados.html"><a href="resultados.html"><i class="fa fa-check"></i><b>3</b> Análisis de resultados de simulación</a>
<ul>
<li class="chapter" data-level="3.1" data-path="convergencia.html"><a href="convergencia.html"><i class="fa fa-check"></i><b>3.1</b> Convergencia</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="convergencia.html"><a href="convergencia.html#detección-de-problemas-de-convergencia"><i class="fa fa-check"></i><b>3.1.1</b> Detección de problemas de convergencia</a></li>
<li class="chapter" data-level="3.1.2" data-path="convergencia.html"><a href="convergencia.html#precisión"><i class="fa fa-check"></i><b>3.1.2</b> Precisión</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="num-gen.html"><a href="num-gen.html"><i class="fa fa-check"></i><b>3.2</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="3.3" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html"><i class="fa fa-check"></i><b>3.3</b> El problema de la dependencia</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>3.3.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="observaciones.html"><a href="observaciones.html"><i class="fa fa-check"></i><b>3.4</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="continuas.html"><a href="continuas.html"><i class="fa fa-check"></i><b>4</b> Simulación de variables continuas</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inversion.html"><a href="inversion.html"><i class="fa fa-check"></i><b>4.1</b> Método de inversión</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="inversion.html"><a href="inversion.html#algunas-distribuciones-que-pueden-simularse-por-el-método-de-inversión"><i class="fa fa-check"></i><b>4.1.1</b> Algunas distribuciones que pueden simularse por el método de inversión</a></li>
<li class="chapter" data-level="4.1.2" data-path="inversion.html"><a href="inversion.html#ventajas-e-inconvenientes"><i class="fa fa-check"></i><b>4.1.2</b> Ventajas e inconvenientes</a></li>
<li class="chapter" data-level="4.1.3" data-path="inversion.html"><a href="inversion.html#inversión-aproximada"><i class="fa fa-check"></i><b>4.1.3</b> Inversión aproximada</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>4.2</b> Método de aceptación rechazo</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="AR.html"><a href="AR.html#algoritmo"><i class="fa fa-check"></i><b>4.2.1</b> Algoritmo</a></li>
<li class="chapter" data-level="4.2.2" data-path="AR.html"><a href="AR.html#densidades-acotadas-en-un-intervalo-cerrado"><i class="fa fa-check"></i><b>4.2.2</b> Densidades acotadas en un intervalo cerrado</a></li>
<li class="chapter" data-level="4.2.3" data-path="AR.html"><a href="AR.html#eficiencia-del-algoritmo"><i class="fa fa-check"></i><b>4.2.3</b> Eficiencia del algoritmo</a></li>
<li class="chapter" data-level="4.2.4" data-path="AR.html"><a href="AR.html#elección-de-la-densidad-auxiliar"><i class="fa fa-check"></i><b>4.2.4</b> Elección de la densidad auxiliar</a></li>
<li class="chapter" data-level="4.2.5" data-path="AR.html"><a href="AR.html#bayes-ar"><i class="fa fa-check"></i><b>4.2.5</b> Ejemplo: inferencia bayesiana</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modAR.html"><a href="modAR.html"><i class="fa fa-check"></i><b>4.3</b> Modificaciones del método de aceptación-rechazo</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="modAR.html"><a href="modAR.html#ars"><i class="fa fa-check"></i><b>4.3.1</b> Muestreo por rechazo adaptativo (ARS)</a></li>
<li class="chapter" data-level="4.3.2" data-path="modAR.html"><a href="modAR.html#método-del-cociente-de-uniformes"><i class="fa fa-check"></i><b>4.3.2</b> Método del cociente de uniformes</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="composicion.html"><a href="composicion.html"><i class="fa fa-check"></i><b>4.4</b> Método de composición (o de simulación condicional)</a></li>
<li class="chapter" data-level="4.5" data-path="notables-cont.html"><a href="notables-cont.html"><i class="fa fa-check"></i><b>4.5</b> Métodos específicos para la generación de algunas distribuciones notables</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="notables-cont.html"><a href="notables-cont.html#método-de-box-müller"><i class="fa fa-check"></i><b>4.5.1</b> Método de Box-Müller</a></li>
<li class="chapter" data-level="4.5.2" data-path="notables-cont.html"><a href="notables-cont.html#simulación-de-la-distribución-beta"><i class="fa fa-check"></i><b>4.5.2</b> Simulación de la distribución beta</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="discretas.html"><a href="discretas.html"><i class="fa fa-check"></i><b>5</b> Simulación de variables discretas</a>
<ul>
<li class="chapter" data-level="5.1" data-path="transcuant.html"><a href="transcuant.html"><i class="fa fa-check"></i><b>5.1</b> Método de la transformación cuantil</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="transcuant.html"><a href="transcuant.html#eficiencia-del-algoritmo-1"><i class="fa fa-check"></i><b>5.1.1</b> Eficiencia del algoritmo</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="método-de-la-tabla-guía.html"><a href="método-de-la-tabla-guía.html"><i class="fa fa-check"></i><b>5.2</b> Método de la tabla guía</a></li>
<li class="chapter" data-level="5.3" data-path="alias.html"><a href="alias.html"><i class="fa fa-check"></i><b>5.3</b> Método de Alias</a></li>
<li class="chapter" data-level="5.4" data-path="simulación-de-una-variable-discreta-con-dominio-infinito.html"><a href="simulación-de-una-variable-discreta-con-dominio-infinito.html"><i class="fa fa-check"></i><b>5.4</b> Simulación de una variable discreta con dominio infinito</a></li>
<li class="chapter" data-level="5.5" data-path="otros-métodos.html"><a href="otros-métodos.html"><i class="fa fa-check"></i><b>5.5</b> Otros métodos</a></li>
<li class="chapter" data-level="5.6" data-path="notables-disc.html"><a href="notables-disc.html"><i class="fa fa-check"></i><b>5.6</b> Métodos específicos para generación de distribuciones notables</a></li>
<li class="chapter" data-level="5.7" data-path="ejercicios-discretas.html"><a href="ejercicios-discretas.html"><i class="fa fa-check"></i><b>5.7</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariante.html"><a href="multivariante.html"><i class="fa fa-check"></i><b>6</b> Simulación de distribuciones multivariantes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="simulación-de-componentes-independientes.html"><a href="simulación-de-componentes-independientes.html"><i class="fa fa-check"></i><b>6.1</b> Simulación de componentes independientes</a></li>
<li class="chapter" data-level="6.2" data-path="el-método-de-aceptaciónrechazo.html"><a href="el-método-de-aceptaciónrechazo.html"><i class="fa fa-check"></i><b>6.2</b> El método de aceptación/rechazo</a></li>
<li class="chapter" data-level="6.3" data-path="fact-cov.html"><a href="fact-cov.html"><i class="fa fa-check"></i><b>6.3</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="6.4" data-path="distrcond.html"><a href="distrcond.html"><i class="fa fa-check"></i><b>6.4</b> Método de las distribuciones condicionadas</a></li>
<li class="chapter" data-level="6.5" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html"><i class="fa fa-check"></i><b>6.5</b> Simulación condicional e incondicional</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#condnormal"><i class="fa fa-check"></i><b>6.5.1</b> Simulación condicional de una normal multivariante</a></li>
<li class="chapter" data-level="6.5.2" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#simulación-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>6.5.2</b> Simulación condicional a partir de un modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html"><i class="fa fa-check"></i><b>6.6</b> Simulación basada en cópulas</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#cópulas-arquimedianas"><i class="fa fa-check"></i><b>6.6.1</b> Cópulas Arquimedianas</a></li>
<li class="chapter" data-level="6.6.2" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#simulación"><i class="fa fa-check"></i><b>6.6.2</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="mult-discr.html"><a href="mult-discr.html"><i class="fa fa-check"></i><b>6.7</b> Simulación de distribuciones multivariantes discretas</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="mult-discr.html"><a href="mult-discr.html#simulación-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>6.7.1</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="6.7.2" data-path="mult-discr.html"><a href="mult-discr.html#simconting"><i class="fa fa-check"></i><b>6.7.2</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="monte-carlo.html"><a href="monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Métodos Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1" data-path="int-MC.html"><a href="int-MC.html"><i class="fa fa-check"></i><b>7.1</b> Integración Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="int-MC.html"><a href="int-MC.html#integración-monte-carlo-clásica"><i class="fa fa-check"></i><b>7.1.1</b> Integración Monte Carlo clásica</a></li>
<li class="chapter" data-level="7.1.2" data-path="int-MC.html"><a href="int-MC.html#caso-general"><i class="fa fa-check"></i><b>7.1.2</b> Caso general</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html"><i class="fa fa-check"></i><b>7.2</b> Muestreo por importancia</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>7.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="opt-MC.html"><a href="opt-MC.html"><i class="fa fa-check"></i><b>7.3</b> Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="opt-MC.html"><a href="opt-MC.html#algoritmos-de-optimización-monte-carlo"><i class="fa fa-check"></i><b>7.3.1</b> Algoritmos de optimización Monte Carlo</a></li>
<li class="chapter" data-level="7.3.2" data-path="opt-MC.html"><a href="opt-MC.html#temple-simulado"><i class="fa fa-check"></i><b>7.3.2</b> Temple simulado</a></li>
<li class="chapter" data-level="7.3.3" data-path="opt-MC.html"><a href="opt-MC.html#algoritmos-genéticos"><i class="fa fa-check"></i><b>7.3.3</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="aplic-inf.html"><a href="aplic-inf.html"><i class="fa fa-check"></i><b>7.4</b> Métodos Monte Carlo en Inferencia Estadística</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="aplic-inf.html"><a href="aplic-inf.html#distribución-en-el-muestreo"><i class="fa fa-check"></i><b>7.4.1</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="7.4.2" data-path="aplic-inf.html"><a href="aplic-inf.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>7.4.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="7.4.3" data-path="aplic-inf.html"><a href="aplic-inf.html#contrastes"><i class="fa fa-check"></i><b>7.4.3</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="7.4.4" data-path="aplic-inf.html"><a href="aplic-inf.html#comparación-de-estimadores"><i class="fa fa-check"></i><b>7.4.4</b> Comparación de estimadores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="técnicas-de-reducción-de-la-varianza.html"><a href="técnicas-de-reducción-de-la-varianza.html"><i class="fa fa-check"></i><b>8</b> Técnicas de reducción de la varianza</a>
<ul>
<li class="chapter" data-level="8.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html"><i class="fa fa-check"></i><b>8.1</b> Variables antitéticas</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#ejemplo-integración-monte-carlo"><i class="fa fa-check"></i><b>8.1.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="8.1.2" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#generación-de-variables-antitéticas"><i class="fa fa-check"></i><b>8.1.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="estratificación.html"><a href="estratificación.html"><i class="fa fa-check"></i><b>8.2</b> Estratificación</a></li>
<li class="chapter" data-level="8.3" data-path="variables-de-control.html"><a href="variables-de-control.html"><i class="fa fa-check"></i><b>8.3</b> Variables de control</a></li>
<li class="chapter" data-level="8.4" data-path="números-aleatorios-comunes.html"><a href="números-aleatorios-comunes.html"><i class="fa fa-check"></i><b>8.4</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="8.5" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>8.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>9</b> Métodos de remuestreo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="boot-intro.html"><a href="boot-intro.html"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="boot-unif.html"><a href="boot-unif.html"><i class="fa fa-check"></i><b>9.2</b> El Bootstrap uniforme</a></li>
<li class="chapter" data-level="9.3" data-path="intro-paquetes.html"><a href="intro-paquetes.html"><i class="fa fa-check"></i><b>9.3</b> Herramientas disponibles en R sobre bootstrap</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="intro-paquetes.html"><a href="intro-paquetes.html#intro-pkgboot"><i class="fa fa-check"></i><b>9.3.1</b> El paquete <code>boot</code></a></li>
<li class="chapter" data-level="9.3.2" data-path="intro-paquetes.html"><a href="intro-paquetes.html#extensiones-del-bootstrap-uniforme-con-el-paquete-boot"><i class="fa fa-check"></i><b>9.3.2</b> Extensiones del bootstrap uniforme con el paquete <code>boot</code></a></li>
<li class="chapter" data-level="9.3.3" data-path="intro-paquetes.html"><a href="intro-paquetes.html#boot-unif-multi"><i class="fa fa-check"></i><b>9.3.3</b> Ejemplo: Bootstrap uniforme multidimensional</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modunif.html"><a href="modunif.html"><i class="fa fa-check"></i><b>10</b> Extensiones del bootstrap uniforme</a>
<ul>
<li class="chapter" data-level="10.1" data-path="deficien-unif.html"><a href="deficien-unif.html"><i class="fa fa-check"></i><b>10.1</b> Deficiencias del bootstrap uniforme</a></li>
<li class="chapter" data-level="10.2" data-path="modunif-boot-par.html"><a href="modunif-boot-par.html"><i class="fa fa-check"></i><b>10.2</b> Bootstrap paramétrico</a></li>
<li class="chapter" data-level="10.3" data-path="modunif-boot-suav.html"><a href="modunif-boot-suav.html"><i class="fa fa-check"></i><b>10.3</b> Bootstrap suavizado</a></li>
<li class="chapter" data-level="10.4" data-path="boot-reg.html"><a href="boot-reg.html"><i class="fa fa-check"></i><b>10.4</b> Bootstrap basado en modelos</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="boot-reg.html"><a href="boot-reg.html#boot-unif-reg"><i class="fa fa-check"></i><b>10.4.1</b> Remuestreo de las observaciones</a></li>
<li class="chapter" data-level="10.4.2" data-path="boot-reg.html"><a href="boot-reg.html#boot-residual"><i class="fa fa-check"></i><b>10.4.2</b> Bootstrap residual</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="boot-aplic.html"><a href="boot-aplic.html"><i class="fa fa-check"></i><b>11</b> Aplicaciones del remuestreo</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sesgo-prec.html"><a href="sesgo-prec.html"><i class="fa fa-check"></i><b>11.1</b> Estimación del sesgo y la precisión de un estimador</a></li>
<li class="chapter" data-level="11.2" data-path="boot-ic.html"><a href="boot-ic.html"><i class="fa fa-check"></i><b>11.2</b> Intervalos de confianza bootstrap</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-norm"><i class="fa fa-check"></i><b>11.2.1</b> Aproximación normal</a></li>
<li class="chapter" data-level="11.2.2" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-perc"><i class="fa fa-check"></i><b>11.2.2</b> Método percentil directo</a></li>
<li class="chapter" data-level="11.2.3" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-basic"><i class="fa fa-check"></i><b>11.2.3</b> Método percentil básico</a></li>
<li class="chapter" data-level="11.2.4" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-stud"><i class="fa fa-check"></i><b>11.2.4</b> Método percentil-<em>t</em></a></li>
<li class="chapter" data-level="11.2.5" data-path="boot-ic.html"><a href="boot-ic.html#boot-ic-bca"><i class="fa fa-check"></i><b>11.2.5</b> Método BCa</a></li>
<li class="chapter" data-level="11.2.6" data-path="boot-ic.html"><a href="boot-ic.html#icboot-trans"><i class="fa fa-check"></i><b>11.2.6</b> Ejemplo: IC bootstrap para el coeficiente de correlación</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="boot-test.html"><a href="boot-test.html"><i class="fa fa-check"></i><b>11.3</b> Contrastes de hipótesis bootstrap</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="boot-test.html"><a href="boot-test.html#contrastes-parametricos"><i class="fa fa-check"></i><b>11.3.1</b> Contrastes bootstrap paramétricos</a></li>
<li class="chapter" data-level="11.3.2" data-path="boot-test.html"><a href="boot-test.html#contrastes-de-permutaciones"><i class="fa fa-check"></i><b>11.3.2</b> Contrastes de permutaciones</a></li>
<li class="chapter" data-level="11.3.3" data-path="boot-test.html"><a href="boot-test.html#contrastes-semiparametricos"><i class="fa fa-check"></i><b>11.3.3</b> Contrastes bootstrap semiparamétricos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#appendix-apendices"><i class="fa fa-check"></i>(APPENDIX) Apendices</a>
<ul>
<li class="chapter" data-level="11.4" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i><b>11.4</b> Métodos de bondad de ajuste</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="gof.html"><a href="gof.html#histograma"><i class="fa fa-check"></i><b>11.4.1</b> Histograma</a></li>
<li class="chapter" data-level="11.4.2" data-path="gof.html"><a href="gof.html#empdistr"><i class="fa fa-check"></i><b>11.4.2</b> Función de distribución empírica</a></li>
<li class="chapter" data-level="11.4.3" data-path="gof.html"><a href="gof.html#gráficos-p-p-y-q-q"><i class="fa fa-check"></i><b>11.4.3</b> Gráficos P-P y Q-Q</a></li>
<li class="chapter" data-level="11.4.4" data-path="gof.html"><a href="gof.html#chi2test"><i class="fa fa-check"></i><b>11.4.4</b> Contraste chi-cuadrado de Pearson</a></li>
<li class="chapter" data-level="11.4.5" data-path="gof.html"><a href="gof.html#ks-test"><i class="fa fa-check"></i><b>11.4.5</b> Contraste de Kolmogorov-Smirnov</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="diag-aleat.html"><a href="diag-aleat.html"><i class="fa fa-check"></i><b>11.5</b> Diagnosis de la independencia</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="diag-aleat.html"><a href="diag-aleat.html#métodos-para-detectar-dependencia"><i class="fa fa-check"></i><b>11.5.1</b> Métodos para detectar dependencia</a></li>
<li class="chapter" data-level="11.5.2" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-secuencial"><i class="fa fa-check"></i><b>11.5.2</b> Gráfico secuencial</a></li>
<li class="chapter" data-level="11.5.3" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-de-dispersion-retardado"><i class="fa fa-check"></i><b>11.5.3</b> Gráfico de dispersion retardado</a></li>
<li class="chapter" data-level="11.5.4" data-path="diag-aleat.html"><a href="diag-aleat.html#el-correlograma"><i class="fa fa-check"></i><b>11.5.4</b> El correlograma</a></li>
<li class="chapter" data-level="11.5.5" data-path="diag-aleat.html"><a href="diag-aleat.html#test-de-rachas"><i class="fa fa-check"></i><b>11.5.5</b> Test de rachas</a></li>
<li class="chapter" data-level="11.5.6" data-path="diag-aleat.html"><a href="diag-aleat.html#el-contraste-de-ljung-box"><i class="fa fa-check"></i><b>11.5.6</b> El contraste de Ljung-Box</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html"><i class="fa fa-check"></i><b>11.6</b> Contrastes específicos para generadores aleatorios</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#freq-test"><i class="fa fa-check"></i><b>11.6.1</b> Contraste de frecuencias</a></li>
<li class="chapter" data-level="11.6.2" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-series"><i class="fa fa-check"></i><b>11.6.2</b> Contraste de series</a></li>
<li class="chapter" data-level="11.6.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-poker"><i class="fa fa-check"></i><b>11.6.3</b> El contraste del poker</a></li>
<li class="chapter" data-level="11.6.4" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-coleccionista"><i class="fa fa-check"></i><b>11.6.4</b> El contraste del coleccionista</a></li>
<li class="chapter" data-level="11.6.5" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contrastes-de-salto"><i class="fa fa-check"></i><b>11.6.5</b> Contrastes de salto</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="int-num.html"><a href="int-num.html"><i class="fa fa-check"></i><b>12</b> Integración numérica</a>
<ul>
<li class="chapter" data-level="12.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html"><i class="fa fa-check"></i><b>12.1</b> Integración numérica unidimensional</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#método-del-trapezoide"><i class="fa fa-check"></i><b>12.1.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="12.1.2" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#regla-de-simpson"><i class="fa fa-check"></i><b>12.1.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="12.1.3" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>12.1.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="12.1.4" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#comandos-de-r"><i class="fa fa-check"></i><b>12.1.4</b> Comandos de R</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html"><i class="fa fa-check"></i><b>12.2</b> Integración numérica bidimensional</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#representación-gráfica"><i class="fa fa-check"></i><b>12.2.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="12.2.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#método-del-trapezoide-1"><i class="fa fa-check"></i><b>12.2.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="12.2.3" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#comandos-de-r-1"><i class="fa fa-check"></i><b>12.2.3</b> Comandos de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="intro-hpc.html"><a href="intro-hpc.html"><i class="fa fa-check"></i><b>13</b> Introducción al procesamiento en paralelo en R</a>
<ul>
<li class="chapter" data-level="13.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>13.1</b> Introducción</a></li>
<li class="chapter" data-level="13.2" data-path="paquetes-en-r.html"><a href="paquetes-en-r.html"><i class="fa fa-check"></i><b>13.2</b> Paquetes en R</a></li>
<li class="chapter" data-level="13.3" data-path="ejemplos.html"><a href="ejemplos.html"><i class="fa fa-check"></i><b>13.3</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ejemplos.html"><a href="ejemplos.html#procesamiento-en-paralelo-con-la-función-boot"><i class="fa fa-check"></i><b>13.3.1</b> Procesamiento en paralelo con la función <code>boot()</code></a></li>
<li class="chapter" data-level="13.3.2" data-path="ejemplos.html"><a href="ejemplos.html#estudio-sim-boot"><i class="fa fa-check"></i><b>13.3.2</b> Estudio de simulación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="soluciones.html"><a href="soluciones.html"><i class="fa fa-check"></i><b>14</b> Soluciones ejercicios</a>
<ul>
<li class="chapter" data-level="14.1" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html"><i class="fa fa-check"></i><b>14.1</b> Capítulo 1 Introducción a la simulación</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-simpi"><i class="fa fa-check"></i><b>14.1.1</b> Ejercicio 1.1</a></li>
<li class="chapter" data-level="14.1.2" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-bernoulli"><i class="fa fa-check"></i><b>14.1.2</b> Ejercicio 1.2</a></li>
<li class="chapter" data-level="14.1.3" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-circuito"><i class="fa fa-check"></i><b>14.1.3</b> Ejercicio 1.3</a></li>
<li class="chapter" data-level="14.1.4" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-mere"><i class="fa fa-check"></i><b>14.1.4</b> Ejercicio 1.4</a></li>
<li class="chapter" data-level="14.1.5" data-path="capítulo-1-introducción-a-la-simulación.html"><a href="capítulo-1-introducción-a-la-simulación.html#sol-album"><i class="fa fa-check"></i><b>14.1.5</b> Ejercicio 1.5</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="capítulo-2-generación-de-números-pseudoaleatorios.html"><a href="capítulo-2-generación-de-números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>14.2</b> Capítulo 2 Generación de números pseudoaleatorios</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="capítulo-2-generación-de-números-pseudoaleatorios.html"><a href="capítulo-2-generación-de-números-pseudoaleatorios.html#sol-RANDVN"><i class="fa fa-check"></i><b>14.2.1</b> Ejercicio 2.1</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="capítulo-5-simulación-de-variables-discretas.html"><a href="capítulo-5-simulación-de-variables-discretas.html"><i class="fa fa-check"></i><b>14.3</b> Capítulo 5 Simulación de variables discretas</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="capítulo-5-simulación-de-variables-discretas.html"><a href="capítulo-5-simulación-de-variables-discretas.html#sol-mixta-cuantil"><i class="fa fa-check"></i><b>14.3.1</b> Ejercicio 5.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a>
<ul>
<li class="chapter" data-level="" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i>Enlaces</a></li>
<li class="chapter" data-level="" data-path="bibliografía-completa.html"><a href="bibliografía-completa.html"><i class="fa fa-check"></i>Bibliografía completa</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Técnicas de Simulación y Remuestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aplic-inf" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Métodos Monte Carlo en Inferencia Estadística<a href="aplic-inf.html#aplic-inf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>*** Work in progress ***: Esta sección es muy preliminar y variará en siguientes versiones</p>
<!-- 
Pendiente: 
  Mejorar redacción.
  Incluir leyendas de las figuras.
  Añadir distribución muestreo multidimensional, 
    media y varianza muestrales.
    regresión simple: estimaciones coeficientes y varianza.
-->
<p>Como ya se comentó en la introducción muchas de las aplicaciones de la simulación serían de utilidad en Estadística:</p>
<ul>
<li><p>Distribución de estimadores puntuales/estadísticos:</p>
<ul>
<li><p>Aproximación de la distribución.</p>
<ul>
<li><p>Aproximación de características de la distribución.</p></li>
<li><p>Valided de la distribución asintótica.</p></li>
</ul></li>
<li><p>Comparación de estimadores.</p></li>
</ul></li>
<li><p>Estimación por intervalo de confianza:</p>
<ul>
<li><p>Obtención de intervalos/bandas de confianza (probabilidad).</p></li>
<li><p>Análisis de un estimador por intervalo de confianza.</p></li>
</ul></li>
<li><p>Contrastes de hipótesis:</p>
<ul>
<li><p>Aproximación del <span class="math inline">\(p\)</span>-valor.</p></li>
<li><p>Análisis de un contraste de hipótesis.</p></li>
<li><p>Validación teoría.</p></li>
</ul></li>
<li><p>Métodos de remuestro bootstrap.</p></li>
<li><p>Inferencia Bayesiana</p></li>
<li><p>…</p></li>
</ul>
<p>En esta sección nos centraremos en estudios de simulación Monte Carlo en algunas de estas aplicaciones y daremos algún ejemplo de métodos Monte Carlo para inferencia estadística.
La mayoría de los métodos Monte Carlo los podríamos clasificar como métodos de remuestreo y se tratarán con mayor profundidad en capítulos siguientes.</p>
<p>Observación:
En esta sección se obtendrán simulaciones de estadísticos a partir de muestras (podemos pensar que se parte de generaciones de una variable multivariante).
En la mayoría de los ejemplos se generan todas las muestras de una vez, se guardan y se procesan vectorialmente (normalmente empleando la función <code>apply</code>).
Como ya se comentó en el Capítulo <a href="rrng.html#rrng">1.3</a>, en problemas mas complejos, en los que no es necesario almacenar todas las muestras, puede ser preferible emplear un bucle para generar y procesar las muestras iterativamente.</p>
<div id="distribución-en-el-muestreo" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Distribución en el muestreo<a href="aplic-inf.html#distribución-en-el-muestreo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="exercise">
<p><span id="exr:distr-media" class="exercise"><strong>Ejercicio 7.2  (Distribución de la media muestral) </strong></span><br></p>
<p>Si <span class="math inline">\(X_{1},\ldots,X_{n}\)</span> es una muestra aleatoria simple de una
variable aleatoria <span class="math inline">\(X \sim N\left( \mu, \sigma \right)\)</span>, la
distribución en el muestreo de:
<span class="math display">\[\hat{\mu}=\overline{X}=\dfrac{1}{n}\sum_{i=1}^{n}X_{i}\]</span>
es:
<span class="math display">\[\overline{X} \sim N\left(  \mu,\dfrac{\sigma}{\sqrt{n}}\right)\]</span>
Confirmar este resultado mediante simulación, para ello:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Crear un conjunto de datos <code>muestras</code> con 500 muestras de tamaño
<span class="math inline">\(n=10\)</span> de una <span class="math inline">\(N(1,2)\)</span>. Añadir al conjunto de datos las
estimaciones de la media y desviación típica obtenidas con cada
una de las muestras.</p>
<p>Valores iniciales:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="aplic-inf.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>) <span class="co"># Fijar semilla para reproducibilidad</span></span>
<span id="cb63-2"><a href="aplic-inf.html#cb63-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb63-3"><a href="aplic-inf.html#cb63-3" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">10</span></span></code></pre></div>
<p>Valores teóricos:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="aplic-inf.html#cb64-1" aria-hidden="true" tabindex="-1"></a>mux <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-2"><a href="aplic-inf.html#cb64-2" aria-hidden="true" tabindex="-1"></a>sdx <span class="ot">&lt;-</span> <span class="dv">2</span></span></code></pre></div>
<p>Simulación de las muestras (al estilo <code>Rcmdr</code>):</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="aplic-inf.html#cb65-1" aria-hidden="true" tabindex="-1"></a>muestras <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(nsim<span class="sc">*</span>nx, <span class="at">mean=</span>mux, <span class="at">sd=</span>sdx), <span class="at">ncol=</span>nx))</span>
<span id="cb65-2"><a href="aplic-inf.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(muestras) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;muestra&quot;</span>, <span class="dv">1</span><span class="sc">:</span>nsim, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb65-3"><a href="aplic-inf.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(muestras) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;obs&quot;</span>, <span class="dv">1</span><span class="sc">:</span>nx, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb65-4"><a href="aplic-inf.html#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(muestras)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    500 obs. of  10 variables:
##  $ obs1 : num  0.642 -0.856 -0.568 -2.301 0.184 ...
##  $ obs2 : num  3.483 2.216 1.1 4.305 0.677 ...
##  $ obs3 : num  1.24 -1.51 -3.98 2.29 2.46 ...
##  $ obs4 : num  3.286 0.947 0.953 -1.663 2.623 ...
##  $ obs5 : num  3.77 -1.34 1.61 -2.46 1.11 ...
##  $ obs6 : num  -2.044 0.32 3.046 0.136 3.555 ...
##  $ obs7 : num  0.6186 -1.8614 4.3386 0.0996 0.8334 ...
##  $ obs8 : num  -0.829 2.202 -1.688 1.534 -0.114 ...
##  $ obs9 : num  0.4904 -0.6713 0.5451 -0.6517 0.0168 ...
##  $ obs10: num  2.79 2.84 1.27 3.93 2.17 ...</code></pre>
<p>Estimaciones:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="aplic-inf.html#cb67-1" aria-hidden="true" tabindex="-1"></a>muestras<span class="sc">$</span>mean <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(muestras[,<span class="dv">1</span><span class="sc">:</span>nx])</span>
<span id="cb67-2"><a href="aplic-inf.html#cb67-2" aria-hidden="true" tabindex="-1"></a>muestras<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">apply</span>(muestras[,<span class="dv">1</span><span class="sc">:</span>nx], <span class="dv">1</span>, sd)</span></code></pre></div>
<p>La fila <code>muestras[i,]</code> contiene las observaciones de la i-ésima muestra y
la correspondiente media y desviación típica.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="aplic-inf.html#cb68-1" aria-hidden="true" tabindex="-1"></a>muestras[<span class="dv">1</span>,]</span></code></pre></div>
<pre><code>##               obs1     obs2     obs3    obs4     obs5     obs6      obs7
## muestra1 0.6421985 3.482661 1.242483 3.28559 3.766896 -2.04443 0.6186323
##                obs8      obs9    obs10     mean       sd
## muestra1 -0.8293636 0.4903819 2.790091 1.344514 1.951292</code></pre></li>
</ol>
<p>Normalmente emplearemos sin embargo una ordenación por columnas (cada fila se corresponderá con una generación).</p>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Generar el histograma (en escala de densidades) de las medias
muestrales y compararlo con la densidad teórica.</p>
<p>Distribución de la media muestral:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="aplic-inf.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(muestras<span class="sc">$</span>mean, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">&quot;FD&quot;</span>, </span>
<span id="cb70-2"><a href="aplic-inf.html#cb70-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Medias&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Densidad&quot;</span>)</span>
<span id="cb70-3"><a href="aplic-inf.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Densidad observada (estimación)</span></span>
<span id="cb70-4"><a href="aplic-inf.html#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(muestras<span class="sc">$</span>mean)) </span>
<span id="cb70-5"><a href="aplic-inf.html#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Densidad teórica (bajo normalidad)</span></span>
<span id="cb70-6"><a href="aplic-inf.html#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, mux, sdx<span class="sc">/</span><span class="fu">sqrt</span>(nx)), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>) </span>
<span id="cb70-7"><a href="aplic-inf.html#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Aproximación del valor esperado de la media muestral mediante simulación</span></span>
<span id="cb70-8"><a href="aplic-inf.html#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(muestras<span class="sc">$</span>mean), <span class="at">lty =</span> <span class="dv">2</span>)  </span>
<span id="cb70-9"><a href="aplic-inf.html#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor esperado de la media muestral (teórico)</span></span>
<span id="cb70-10"><a href="aplic-inf.html#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> mux, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mednorm"></span>
<img src="07-Monte_Carlo_files/figure-html/mednorm-1.png" alt="Distribución de la media muestral de una distribución normal." width="70%" />
<p class="caption">
Figura 7.9: Distribución de la media muestral de una distribución normal.
</p>
</div></li>
</ol>
</div>
<p><br> </p>
<div class="exercise">
<p><span id="exr:distr-mediab" class="exercise"><strong>Ejercicio 7.3  (Distribución de la media muestral continuación) </strong></span><br></p>
<p>Si <span class="math inline">\(X_{1},\ldots,X_{n}\)</span> es una m.a.s. de una variable aleatoria
<span class="math inline">\(X\)</span> (cualquiera) con <span class="math inline">\(E\left( X \right) = \mu\)</span> y
<span class="math inline">\(Var\left( X \right) = \sigma^{2}\)</span>, por el Teorema Central del Límite,
la distribución en el muestreo de <span class="math inline">\(\hat{\mu}=\overline{X}\)</span> se aproxima a la
normalidad:
<span class="math display">\[\overline{X}\underset{n\rightarrow\infty}{\longrightarrow}
N\left( \mu, \dfrac{\sigma}{\sqrt{n}}\right)\]</span>
Típicamente se suele considerar que esta aproximación es buena
para tamaños muestrales <span class="math inline">\(n&gt;30\)</span>,
aunque dependerá de las características de la distribución de <span class="math inline">\(X\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Repetir el Ejercicio <a href="aplic-inf.html#exr:distr-media">7.2</a> anterior considerando muestras de una <span class="math inline">\(Exp(1)\)</span> (tener en cuenta que <span class="math inline">\(X\sim Exp(\lambda)\Rightarrow\mu_{X}=\sigma_{X}=1/\lambda\)</span>).
¿Qué ocurre con la distribución de la media muestral?</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="aplic-inf.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>) <span class="co"># Fijar semilla para reproducibilidad</span></span>
<span id="cb71-2"><a href="aplic-inf.html#cb71-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb71-3"><a href="aplic-inf.html#cb71-3" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">10</span>    </span>
<span id="cb71-4"><a href="aplic-inf.html#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nx &lt;- 50</span></span></code></pre></div>
<p>Valores teóricos:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="aplic-inf.html#cb72-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb72-2"><a href="aplic-inf.html#cb72-2" aria-hidden="true" tabindex="-1"></a>muexp <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>lambda</span>
<span id="cb72-3"><a href="aplic-inf.html#cb72-3" aria-hidden="true" tabindex="-1"></a>sdexp <span class="ot">&lt;-</span> muexp</span></code></pre></div>
<p>Simulación de las muestras:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="aplic-inf.html#cb73-1" aria-hidden="true" tabindex="-1"></a>muestras2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">rexp</span>(nsim<span class="sc">*</span>nx, <span class="at">rate=</span>lambda), <span class="at">ncol=</span>nx))</span>
<span id="cb73-2"><a href="aplic-inf.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(muestras2) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;muestra&quot;</span>, <span class="dv">1</span><span class="sc">:</span>nsim, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb73-3"><a href="aplic-inf.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(muestras2) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;obs&quot;</span>, <span class="dv">1</span><span class="sc">:</span>nx, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>Estimaciones:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="aplic-inf.html#cb74-1" aria-hidden="true" tabindex="-1"></a>muestras2<span class="sc">$</span>mean <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(muestras2[,<span class="dv">1</span><span class="sc">:</span>nx])</span>
<span id="cb74-2"><a href="aplic-inf.html#cb74-2" aria-hidden="true" tabindex="-1"></a>muestras2<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">apply</span>(muestras2[,<span class="dv">1</span><span class="sc">:</span>nx], <span class="dv">1</span>, sd)</span></code></pre></div>
<p>Distribución de la media muestral:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="aplic-inf.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(muestras2<span class="sc">$</span>mean, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">2.5</span>), <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">&quot;FD&quot;</span>, </span>
<span id="cb75-2"><a href="aplic-inf.html#cb75-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Medias&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Densidad&quot;</span>)</span>
<span id="cb75-3"><a href="aplic-inf.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Densidad observada (estimación)</span></span>
<span id="cb75-4"><a href="aplic-inf.html#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(muestras2<span class="sc">$</span>mean)) </span>
<span id="cb75-5"><a href="aplic-inf.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución asintótica (TCL)</span></span>
<span id="cb75-6"><a href="aplic-inf.html#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,muexp,sdexp<span class="sc">/</span><span class="fu">sqrt</span>(nx)), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>) </span>
<span id="cb75-7"><a href="aplic-inf.html#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Aproximación del valor esperado de la media muestral mediante simulación</span></span>
<span id="cb75-8"><a href="aplic-inf.html#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(muestras2<span class="sc">$</span>mean),<span class="at">lty=</span><span class="dv">2</span>)  </span>
<span id="cb75-9"><a href="aplic-inf.html#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor esperado de la media muestral (teórico)</span></span>
<span id="cb75-10"><a href="aplic-inf.html#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>muexp, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:medexp"></span>
<img src="07-Monte_Carlo_files/figure-html/medexp-1.png" alt="Distribución de la media muestral de una distribución exponencial y distribución asintótica." width="70%" />
<p class="caption">
Figura 7.10: Distribución de la media muestral de una distribución exponencial y distribución asintótica.
</p>
</div></li>
<li><p>Aumentar el tamaño muestral a 50. ¿Se aproxima más la
distribución de las medias muestrales a la teórica bajo
normalidad?</p>
<p>Ejecutar el código del apartado anterior fijando <code>nx &lt;- 50</code>.</p></li>
</ol>
</div>
</div>
<div id="intervalos-de-confianza" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Intervalos de confianza<a href="aplic-inf.html#intervalos-de-confianza" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="exercise">
<p><span id="exr:ic-media" class="exercise"><strong>Ejercicio 7.4  (Intervalo de confianza para la media) </strong></span><br></p>
<p>A partir del enunciado del Ejercicio <a href="aplic-inf.html#exr:distr-media">7.2</a>, se deduce que el intervalo de confianza (de nivel <span class="math inline">\(1-\alpha\)</span>) para la media <span class="math inline">\(\mu\)</span> de una población normal con varianza conocida es:
<span class="math display">\[IC_{1-\alpha}\left(  \mu\right)  =
\left(  \overline{X}-z_{1-\alpha/2}\dfrac{\sigma}{\sqrt{n}},\ \overline{X}
+ z_{1-\alpha/2}\dfrac{\sigma}{\sqrt{n}} \right).\]</span>
La idea es que el <span class="math inline">\(100(1-\alpha)\%\)</span> de los intervalos así construidos contentrán el verdadero valor del parámetro.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Utilizando el conjunto de datos <code>muestras</code> del ejercicio 1 (500
muestras de tamaño <span class="math inline">\(n=10\)</span> de una <span class="math inline">\(N(1,2)\)</span>), añadir en dos nuevas
variables los extremos del intervalo de confianza para la media
con varianza conocida al conjunto de datos. Analizar la
cobertura de estas estimaciones por IC.</p>
<p>IC para la media con varianza conocida (bajo normalidad):</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="aplic-inf.html#cb76-1" aria-hidden="true" tabindex="-1"></a>alfa <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb76-2"><a href="aplic-inf.html#cb76-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alfa<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb76-3"><a href="aplic-inf.html#cb76-3" aria-hidden="true" tabindex="-1"></a>muestras<span class="sc">$</span>ici <span class="ot">&lt;-</span> muestras<span class="sc">$</span>mean <span class="sc">-</span> z<span class="sc">*</span>sdx<span class="sc">/</span><span class="fu">sqrt</span>(nx)</span>
<span id="cb76-4"><a href="aplic-inf.html#cb76-4" aria-hidden="true" tabindex="-1"></a>muestras<span class="sc">$</span>ics <span class="ot">&lt;-</span> muestras<span class="sc">$</span>mean <span class="sc">+</span> z<span class="sc">*</span>sdx<span class="sc">/</span><span class="fu">sqrt</span>(nx)</span></code></pre></div>
<p>Cobertura de las estimaciones por IC:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="aplic-inf.html#cb77-1" aria-hidden="true" tabindex="-1"></a>muestras<span class="sc">$</span>cob <span class="ot">&lt;-</span> (muestras<span class="sc">$</span>ici <span class="sc">&lt;</span> mux) <span class="sc">&amp;</span> (mux <span class="sc">&lt;</span> muestras<span class="sc">$</span>ics) </span>
<span id="cb77-2"><a href="aplic-inf.html#cb77-2" aria-hidden="true" tabindex="-1"></a>ncob <span class="ot">&lt;-</span> <span class="fu">sum</span>(muestras<span class="sc">$</span>cob) <span class="co"># Nº de intervalos que contienen la verdadera media</span></span>
<span id="cb77-3"><a href="aplic-inf.html#cb77-3" aria-hidden="true" tabindex="-1"></a>ncob</span></code></pre></div>
<pre><code>## [1] 480</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="aplic-inf.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>ncob<span class="sc">/</span>nsim     <span class="co"># Proporción de intervalos</span></span></code></pre></div>
<pre><code>## [1] 96</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="aplic-inf.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> alfa)    <span class="co"># Proporción teórica bajo normalidad</span></span></code></pre></div>
<pre><code>## [1] 95</code></pre>
<p>Como ejemplo ilustrativo, generamos el gráfico de los primeros 50 intervalos:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="aplic-inf.html#cb83-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb83-2"><a href="aplic-inf.html#cb83-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> muestras[<span class="dv">1</span><span class="sc">:</span>m,]</span>
<span id="cb83-3"><a href="aplic-inf.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(tmp)</span>
<span id="cb83-4"><a href="aplic-inf.html#cb83-4" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(cob,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>)</span>
<span id="cb83-5"><a href="aplic-inf.html#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>m, mean, <span class="at">col =</span> color, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(ici),<span class="fu">max</span>(ics)), </span>
<span id="cb83-6"><a href="aplic-inf.html#cb83-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Muestra&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;IC&quot;</span>)</span>
<span id="cb83-7"><a href="aplic-inf.html#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">1</span><span class="sc">:</span>m, ici, <span class="dv">1</span><span class="sc">:</span>m, ics, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">length =</span> <span class="fl">0.05</span>, <span class="at">code =</span> <span class="dv">3</span>, <span class="at">col =</span> color)</span>
<span id="cb83-8"><a href="aplic-inf.html#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> mux, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cobicnorm"></span>
<img src="07-Monte_Carlo_files/figure-html/cobicnorm-1.png" alt="Cobertura de las estimaciones por IC." width="70%" />
<p class="caption">
Figura 7.11: Cobertura de las estimaciones por IC.
</p>
</div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="aplic-inf.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(tmp)</span></code></pre></div></li>
<li><p>Repetir el apartado anterior considerando muestras de una
<span class="math inline">\(Exp(1)\)</span>. ¿Qué ocurre con la cobertura del intervalo de
confianza obtenido bajo normalidad?</p>
<p>Ejecutar el código del apartado a) del ejercicio 2.</p>
<p>IC para la media con varianza conocida (bajo normalidad)</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="aplic-inf.html#cb85-1" aria-hidden="true" tabindex="-1"></a>alfa <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb85-2"><a href="aplic-inf.html#cb85-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alfa<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb85-3"><a href="aplic-inf.html#cb85-3" aria-hidden="true" tabindex="-1"></a>muestras2<span class="sc">$</span>ici <span class="ot">&lt;-</span> muestras2<span class="sc">$</span>mean <span class="sc">-</span> z<span class="sc">*</span>sdexp<span class="sc">/</span><span class="fu">sqrt</span>(nx)</span>
<span id="cb85-4"><a href="aplic-inf.html#cb85-4" aria-hidden="true" tabindex="-1"></a>muestras2<span class="sc">$</span>ics <span class="ot">&lt;-</span> muestras2<span class="sc">$</span>mean <span class="sc">+</span> z<span class="sc">*</span>sdexp<span class="sc">/</span><span class="fu">sqrt</span>(nx)</span></code></pre></div>
<p>Cobertura de las estimaciones por IC:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="aplic-inf.html#cb86-1" aria-hidden="true" tabindex="-1"></a>muestras2<span class="sc">$</span>cob <span class="ot">&lt;-</span> (muestras2<span class="sc">$</span>ici <span class="sc">&lt;</span> muexp) <span class="sc">&amp;</span> (muexp <span class="sc">&lt;</span> muestras2<span class="sc">$</span>ics) </span>
<span id="cb86-2"><a href="aplic-inf.html#cb86-2" aria-hidden="true" tabindex="-1"></a>ncob <span class="ot">&lt;-</span> <span class="fu">sum</span>(muestras2<span class="sc">$</span>cob) <span class="co"># Nº de intervalos que contienen la verdadera media</span></span>
<span id="cb86-3"><a href="aplic-inf.html#cb86-3" aria-hidden="true" tabindex="-1"></a>ncob</span></code></pre></div>
<pre><code>## [1] 469</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="aplic-inf.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>ncob<span class="sc">/</span>nsim     <span class="co"># Proporción de intervalos</span></span></code></pre></div>
<pre><code>## [1] 93.8</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="aplic-inf.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> alfa)    <span class="co"># Proporción teórica bajo normalidad</span></span></code></pre></div>
<pre><code>## [1] 95</code></pre>
<p>Como ejemplo ilustrativo, generamos el gráfico de los primeros 100 intervalos:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="aplic-inf.html#cb92-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb92-2"><a href="aplic-inf.html#cb92-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> muestras2[<span class="dv">1</span><span class="sc">:</span>m,]</span>
<span id="cb92-3"><a href="aplic-inf.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(tmp)</span>
<span id="cb92-4"><a href="aplic-inf.html#cb92-4" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(cob,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>)</span>
<span id="cb92-5"><a href="aplic-inf.html#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>m, mean, <span class="at">col =</span> color, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(ici),<span class="fu">max</span>(ics)), </span>
<span id="cb92-6"><a href="aplic-inf.html#cb92-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Muestra&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;IC&quot;</span>)</span>
<span id="cb92-7"><a href="aplic-inf.html#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">1</span><span class="sc">:</span>m, ici, <span class="dv">1</span><span class="sc">:</span>m, ics, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">length =</span> <span class="fl">0.05</span>, <span class="at">code =</span> <span class="dv">3</span>, <span class="at">col =</span> color)</span>
<span id="cb92-8"><a href="aplic-inf.html#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> muexp, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cobicexp"></span>
<img src="07-Monte_Carlo_files/figure-html/cobicexp-1.png" alt="Cobertura de las estimaciones por IC (bajo normalidad)." width="70%" />
<p class="caption">
Figura 7.12: Cobertura de las estimaciones por IC (bajo normalidad).
</p>
</div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="aplic-inf.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(tmp)</span></code></pre></div></li>
<li><p>¿Qué ocurre si aumentamos el tamaño muestral a 50?</p>
<p>Ejecutar el código del ejercicio anterior fijando <code>nx &lt;- 50</code>
y el del apartado anterior.</p></li>
</ol>
</div>
<p>En los apartados b) y c) podíamos considerar bootstrap descrito en siguientes capítulos.</p>
<p>Podemos aproximar por simulación los intervalos de probabilidad de la media muestral (tendríamos una idea del valor esperado de lo que obtendríamos
con el bootstrap percentil; en este caso el estimador es insesgado…):</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="aplic-inf.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución de la media muestral</span></span>
<span id="cb94-2"><a href="aplic-inf.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(muestras2<span class="sc">$</span>mean, <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">breaks=</span><span class="st">&quot;FD&quot;</span>, </span>
<span id="cb94-3"><a href="aplic-inf.html#cb94-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Distribución de la media muestral&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Medias&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Densidad&quot;</span>)</span>
<span id="cb94-4"><a href="aplic-inf.html#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Densidad observada (estimación)</span></span>
<span id="cb94-5"><a href="aplic-inf.html#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(muestras2<span class="sc">$</span>mean), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>) </span>
<span id="cb94-6"><a href="aplic-inf.html#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Densidad teórica (bajo normalidad)</span></span>
<span id="cb94-7"><a href="aplic-inf.html#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,muexp,sdexp<span class="sc">/</span><span class="fu">sqrt</span>(nx)), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>) </span>
<span id="cb94-8"><a href="aplic-inf.html#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Aproximación por simulación del valor esperado de la media muestral</span></span>
<span id="cb94-9"><a href="aplic-inf.html#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(muestras2<span class="sc">$</span>mean), <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb94-10"><a href="aplic-inf.html#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor esperado de la media muestral (teórico)</span></span>
<span id="cb94-11"><a href="aplic-inf.html#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>muexp, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>) </span>
<span id="cb94-12"><a href="aplic-inf.html#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="co"># IP bajo normalidad</span></span>
<span id="cb94-13"><a href="aplic-inf.html#cb94-13" aria-hidden="true" tabindex="-1"></a>ic.aprox <span class="ot">&lt;-</span> <span class="fu">apply</span>(muestras2[ ,<span class="fu">c</span>(<span class="st">&#39;ici&#39;</span>,<span class="st">&#39;ics&#39;</span>)], <span class="dv">2</span>, mean)</span>
<span id="cb94-14"><a href="aplic-inf.html#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ic.aprox </span></span>
<span id="cb94-15"><a href="aplic-inf.html#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="do">##       ici       ics </span></span>
<span id="cb94-16"><a href="aplic-inf.html#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.3865199 1.6261099</span></span>
<span id="cb94-17"><a href="aplic-inf.html#cb94-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de probabilidad para la media muestral aproximado bajo normalidad</span></span>
<span id="cb94-18"><a href="aplic-inf.html#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ic.aprox, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb94-19"><a href="aplic-inf.html#cb94-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-20"><a href="aplic-inf.html#cb94-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de probabilidad para la media muestral (aproximado por simulación)</span></span>
<span id="cb94-21"><a href="aplic-inf.html#cb94-21" aria-hidden="true" tabindex="-1"></a>ic.sim <span class="ot">&lt;-</span> <span class="fu">quantile</span>(muestras2<span class="sc">$</span>mean, <span class="fu">c</span>(alfa<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> alfa<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb94-22"><a href="aplic-inf.html#cb94-22" aria-hidden="true" tabindex="-1"></a><span class="do">## ic.sim</span></span>
<span id="cb94-23"><a href="aplic-inf.html#cb94-23" aria-hidden="true" tabindex="-1"></a><span class="do">##      2.5%     97.5% </span></span>
<span id="cb94-24"><a href="aplic-inf.html#cb94-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.4714233 1.8059094</span></span>
<span id="cb94-25"><a href="aplic-inf.html#cb94-25" aria-hidden="true" tabindex="-1"></a><span class="co"># IP (aprox.) </span></span>
<span id="cb94-26"><a href="aplic-inf.html#cb94-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>ic.sim, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>) </span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-35-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="remark">
<p><span id="unlabeled-div-1" class="remark"><em>Nota:</em>. </span>Estimaciones puntuales, por intervalo de confianza y contrastes de hipótesis
para la media con varianza desconocida bajo normalidad
se pueden obtener con la función <code>t.test</code>.</p>
</div>
<p><br> </p>
<div class="exercise">
<p><span id="exr:ic-agresti-coull" class="exercise"><strong>Ejercicio 7.5  (Intervalo de confianza Agresti-Coull para una proporción) </strong></span><br></p>
<p>El Intervalo de confianza para una proporción construido usando la
aproximación normal tiene un mal comportamiento cuando el tamaño de
la muestra es pequeño. Una simple y efectiva mejora consiste en
añadir a la muestra <span class="math inline">\(2a\)</span> elementos, <span class="math inline">\(a\)</span> exitos y <span class="math inline">\(a\)</span> fracasos. Así
el intervalo de confianza al <span class="math inline">\(\left( 1-\alpha\right) 100\%\)</span> para
una proporción mejorado es:
<span class="math display">\[\begin{aligned}
IC_{1-\alpha}^{a}\left(  p\right)   
&amp; =\left(  \tilde{p}-z_{1-\alpha/2}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{\tilde{n}}} \text{ , }
\tilde{p}+z_{1-\alpha/2}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{\tilde{n}}}\right)  ,\\
\text{siendo }\tilde{n} &amp; = n+2a \text{, } \tilde{p} = \frac{np+a}{\tilde{n}}.
\end{aligned}\]</span>
En el caso de <span class="math inline">\(a=2\)</span> se denomina IC Agresti-Coull.</p>
<p>(Los apartados a) y b) están basados en los ejemplos 1.5 y 1.6 de <a href="http://www.springer.com/gp/book/9780387402734">Suess y Trumbo</a>, 2010)</p>
<ol style="list-style-type: lower-alpha">
<li><p>Teniendo en cuenta que la variable aleatoria <span class="math inline">\(X=n\hat{p}\sim\mathcal{B}(n,p)\)</span>,
obtener y representar gráficamente la cobertura teórica del
intervalo de confianza estándar (<span class="math inline">\(a=0\)</span>) de una proporción para
una muestra de tamaño <span class="math inline">\(n=30\)</span>, <span class="math inline">\(\alpha=0.05\)</span> y distintos valores
de <span class="math inline">\(p\)</span> (<code>p.teor &lt;- seq(1/n, 1 - 1/n, length = 1000)</code>).</p>
<p>Parámetros:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="aplic-inf.html#cb95-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb95-2"><a href="aplic-inf.html#cb95-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb95-3"><a href="aplic-inf.html#cb95-3" aria-hidden="true" tabindex="-1"></a>adj <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># (adj &lt;- 2 para Agresti-Coull)</span></span></code></pre></div>
<p>Probabilidades teóricas:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="aplic-inf.html#cb96-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb96-2"><a href="aplic-inf.html#cb96-2" aria-hidden="true" tabindex="-1"></a>p.teor <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">/</span>n, <span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>n, <span class="at">length =</span> m) </span></code></pre></div>
<p>Posibles resultados:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="aplic-inf.html#cb97-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n</span>
<span id="cb97-2"><a href="aplic-inf.html#cb97-2" aria-hidden="true" tabindex="-1"></a>p.est <span class="ot">&lt;-</span> (x <span class="sc">+</span> adj)<span class="sc">/</span>(n <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> adj) </span>
<span id="cb97-3"><a href="aplic-inf.html#cb97-3" aria-hidden="true" tabindex="-1"></a>ic.err <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(p.est <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.est)<span class="sc">/</span>(n <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> adj))  </span>
<span id="cb97-4"><a href="aplic-inf.html#cb97-4" aria-hidden="true" tabindex="-1"></a>lcl <span class="ot">&lt;-</span> p.est <span class="sc">-</span> ic.err </span>
<span id="cb97-5"><a href="aplic-inf.html#cb97-5" aria-hidden="true" tabindex="-1"></a>ucl <span class="ot">&lt;-</span> p.est <span class="sc">+</span> ic.err </span></code></pre></div>
<p>Recorrer prob. teóricas:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="aplic-inf.html#cb98-1" aria-hidden="true" tabindex="-1"></a>p.cov <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb98-2"><a href="aplic-inf.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb98-3"><a href="aplic-inf.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cobertura de los posibles intervalos</span></span>
<span id="cb98-4"><a href="aplic-inf.html#cb98-4" aria-hidden="true" tabindex="-1"></a>  cover <span class="ot">&lt;-</span> (p.teor[i] <span class="sc">&gt;=</span> lcl) <span class="sc">&amp;</span> (p.teor[i] <span class="sc">&lt;=</span> ucl)  </span>
<span id="cb98-5"><a href="aplic-inf.html#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prob. de los posibles intervalos</span></span>
<span id="cb98-6"><a href="aplic-inf.html#cb98-6" aria-hidden="true" tabindex="-1"></a>  p.rel <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x[cover], n, p.teor[i])           </span>
<span id="cb98-7"><a href="aplic-inf.html#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prob. total de cobertura</span></span>
<span id="cb98-8"><a href="aplic-inf.html#cb98-8" aria-hidden="true" tabindex="-1"></a>  p.cov[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.rel)                            </span>
<span id="cb98-9"><a href="aplic-inf.html#cb98-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Gráfico coberturas:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="aplic-inf.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p.teor, p.cov, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> alpha, <span class="dv">1</span>))</span>
<span id="cb99-2"><a href="aplic-inf.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">lty =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-40-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Fuente <a href="http://www.springer.com/gp/book/9780387402734">Suess y Trumbo (2010)</a>.</p></li>
<li><p>Repetir el apartado anterior considerando intervalos de
confianza Agresti-Coull (<span class="math inline">\(a=2\)</span>).</p>
<p>Parámetros:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="aplic-inf.html#cb100-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb100-2"><a href="aplic-inf.html#cb100-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb100-3"><a href="aplic-inf.html#cb100-3" aria-hidden="true" tabindex="-1"></a>adj <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># Agresti-Coull</span></span>
<span id="cb100-4"><a href="aplic-inf.html#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="aplic-inf.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades teóricas:</span></span>
<span id="cb100-6"><a href="aplic-inf.html#cb100-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb100-7"><a href="aplic-inf.html#cb100-7" aria-hidden="true" tabindex="-1"></a>p.teor <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">/</span>n, <span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>n, <span class="at">length =</span> m) </span>
<span id="cb100-8"><a href="aplic-inf.html#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Posibles resultados:</span></span>
<span id="cb100-9"><a href="aplic-inf.html#cb100-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n</span>
<span id="cb100-10"><a href="aplic-inf.html#cb100-10" aria-hidden="true" tabindex="-1"></a>p.est <span class="ot">&lt;-</span> (x <span class="sc">+</span> adj)<span class="sc">/</span>(n <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> adj) </span>
<span id="cb100-11"><a href="aplic-inf.html#cb100-11" aria-hidden="true" tabindex="-1"></a>ic.err <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(p.est <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.est)<span class="sc">/</span>(n <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> adj))  </span>
<span id="cb100-12"><a href="aplic-inf.html#cb100-12" aria-hidden="true" tabindex="-1"></a>lcl <span class="ot">&lt;-</span> p.est <span class="sc">-</span> ic.err </span>
<span id="cb100-13"><a href="aplic-inf.html#cb100-13" aria-hidden="true" tabindex="-1"></a>ucl <span class="ot">&lt;-</span> p.est <span class="sc">+</span> ic.err </span>
<span id="cb100-14"><a href="aplic-inf.html#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Recorrer prob. teóricas:</span></span>
<span id="cb100-15"><a href="aplic-inf.html#cb100-15" aria-hidden="true" tabindex="-1"></a>p.cov <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb100-16"><a href="aplic-inf.html#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb100-17"><a href="aplic-inf.html#cb100-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cobertura de los posibles intervalos</span></span>
<span id="cb100-18"><a href="aplic-inf.html#cb100-18" aria-hidden="true" tabindex="-1"></a>  cover <span class="ot">&lt;-</span> (p.teor[i] <span class="sc">&gt;=</span> lcl) <span class="sc">&amp;</span> (p.teor[i] <span class="sc">&lt;=</span> ucl)  </span>
<span id="cb100-19"><a href="aplic-inf.html#cb100-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prob. de los posibles intervalos</span></span>
<span id="cb100-20"><a href="aplic-inf.html#cb100-20" aria-hidden="true" tabindex="-1"></a>  p.rel <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x[cover], n, p.teor[i])           </span>
<span id="cb100-21"><a href="aplic-inf.html#cb100-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prob. total de cobertura</span></span>
<span id="cb100-22"><a href="aplic-inf.html#cb100-22" aria-hidden="true" tabindex="-1"></a>  p.cov[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.rel)                            </span>
<span id="cb100-23"><a href="aplic-inf.html#cb100-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-24"><a href="aplic-inf.html#cb100-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico coberturas:</span></span>
<span id="cb100-25"><a href="aplic-inf.html#cb100-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p.teor, p.cov, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> alpha, <span class="dv">1</span>))</span>
<span id="cb100-26"><a href="aplic-inf.html#cb100-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">lty =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-41-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Repetir el apartado anterior empleando simulación para aproximar
la cobertura.</p>
<p>Parámetros:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="aplic-inf.html#cb101-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb101-2"><a href="aplic-inf.html#cb101-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb101-3"><a href="aplic-inf.html#cb101-3" aria-hidden="true" tabindex="-1"></a>adj <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co">#&#39; (2 para Agresti-Coull)</span></span>
<span id="cb101-4"><a href="aplic-inf.html#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="aplic-inf.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb101-6"><a href="aplic-inf.html#cb101-6" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">500</span> </span>
<span id="cb101-7"><a href="aplic-inf.html#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades teóricas:</span></span>
<span id="cb101-8"><a href="aplic-inf.html#cb101-8" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb101-9"><a href="aplic-inf.html#cb101-9" aria-hidden="true" tabindex="-1"></a>p.teor <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">/</span>n, <span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>n, <span class="at">length =</span> m) </span></code></pre></div>
<p>Recorrer prob. teóricas:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="aplic-inf.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m &lt;- length(p.teor)</span></span>
<span id="cb102-2"><a href="aplic-inf.html#cb102-2" aria-hidden="true" tabindex="-1"></a>p.cov <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb102-3"><a href="aplic-inf.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb102-4"><a href="aplic-inf.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Equivalente a simular nsim muestras de tamaño n</span></span>
<span id="cb102-5"><a href="aplic-inf.html#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ry &lt;- matrix(rbinom(n*nsim, 1, p.teor[i]), ncol=n)</span></span>
<span id="cb102-6"><a href="aplic-inf.html#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rx &lt;- apply(ry, 1, sum)</span></span>
<span id="cb102-7"><a href="aplic-inf.html#cb102-7" aria-hidden="true" tabindex="-1"></a>  rx <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(nsim, n, p.teor[i])</span>
<span id="cb102-8"><a href="aplic-inf.html#cb102-8" aria-hidden="true" tabindex="-1"></a>  p.est <span class="ot">&lt;-</span> (rx <span class="sc">+</span> adj)<span class="sc">/</span>(n <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> adj)  </span>
<span id="cb102-9"><a href="aplic-inf.html#cb102-9" aria-hidden="true" tabindex="-1"></a>  ic.err <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(p.est <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.est)<span class="sc">/</span>(n <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> adj))</span>
<span id="cb102-10"><a href="aplic-inf.html#cb102-10" aria-hidden="true" tabindex="-1"></a>  p.cov[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>( <span class="fu">abs</span>(p.est <span class="sc">-</span> p.teor[i]) <span class="sc">&lt;</span> ic.err )</span>
<span id="cb102-11"><a href="aplic-inf.html#cb102-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Representar:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="aplic-inf.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p.teor, p.cov, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> alpha, <span class="dv">1</span>))</span>
<span id="cb103-2"><a href="aplic-inf.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">lty =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-44-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<p>Como ya se comentó, el caso de ajustar un modelo a los datos y realizar simulaciones a partir de ese modelo ajustado para aproximar las características de interés de un estadístico, se denomina también bootstrap paramétrico.
Para más detalles ver por ejemplo la <a href="https://rubenfcasal.github.io/book_remuestreo/modunif-boot-par.html">Sección 3.1</a> de Cao y Fernández-Casal (2020).
En este libro, en las secciones <a href="https://rubenfcasal.github.io/book_remuestreo/icboot-ejem.html#estudio-sim-exp">4.6.2</a> y <a href="https://rubenfcasal.github.io/book_remuestreo/ejemplos-3.html#estudio-sim-boot">B.3.2</a>, se incluyen ejemplos adicionales de estudios de simulación.</p>
</div>
<div id="contrastes" class="section level3 hasAnchor" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Contrastes de hipótesis<a href="aplic-inf.html#contrastes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ver <a href="https://rubenfcasal.github.io/book_remuestreo/contrastes.html">Capítulo 5</a> de Cao y Fernández-Casal (2020).</p>
<div class="exercise">
<p><span id="exr:ks-test-sim" class="exercise"><strong>Ejercicio 7.6  (Test de Kolmogorov-Smirnov) </strong></span><br></p>
<p>En la Sección <a href="calgen.html#calgen">2.3</a> del Tema <a href="gen-pseudo.html#gen-pseudo">2</a> se propuso el análisis de la bondad de ajuste de un generador de números pseudo-aleatorios mediante el test de Kolmogorov-Smirnov (ver Sección <a href="gof.html#ks-test">4.5</a>).
Sin embargo, si <span class="math inline">\(H_{0}\)</span> es compuesta (los parámetros desconocidos se estiman por máxima verosimilitud y se trabaja con <span class="math inline">\(\hat{F}_{0}\)</span>) los cuantiles de la distribución (asintótica) de <span class="math inline">\(D_{n}\)</span> pueden ser demasiado conservativos y sería preferible utilizar la distribución exacta.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Analizar el comportamiento del contraste de Kolmogorov-Smirnov
para contrastar normalidad empleando repetidamente este test,
considerando 1000 pruebas con muestras de tamaño 30 de
una <span class="math inline">\(\mathcal{N}(0,1)\)</span>. Comparar gráficamente el ajuste
de la distribución del <span class="math inline">\(p\)</span>-valor a la de referencia
(estudiar el tamaño del contraste).</p>
<p>Valores iniciales:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="aplic-inf.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb104-2"><a href="aplic-inf.html#cb104-2" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb104-3"><a href="aplic-inf.html#cb104-3" aria-hidden="true" tabindex="-1"></a>mx <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb104-4"><a href="aplic-inf.html#cb104-4" aria-hidden="true" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb104-5"><a href="aplic-inf.html#cb104-5" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb104-6"><a href="aplic-inf.html#cb104-6" aria-hidden="true" tabindex="-1"></a>estadistico <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span>
<span id="cb104-7"><a href="aplic-inf.html#cb104-7" aria-hidden="true" tabindex="-1"></a>pvalor <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span></code></pre></div>
<p>Realizar contrastes</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="aplic-inf.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(isim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb105-2"><a href="aplic-inf.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  rx <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nx, mx, sx)</span>
<span id="cb105-3"><a href="aplic-inf.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(rx, <span class="st">&quot;pnorm&quot;</span>, <span class="fu">mean</span>(rx), <span class="fu">sd</span>(rx))</span>
<span id="cb105-4"><a href="aplic-inf.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  estadistico[isim] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>statistic</span>
<span id="cb105-5"><a href="aplic-inf.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  pvalor[isim] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>p.value</span>
<span id="cb105-6"><a href="aplic-inf.html#cb105-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Proporción de rechazos:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="aplic-inf.html#cb106-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb106-2"><a href="aplic-inf.html#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Proporción de rechazos al 1% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.01</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb106-3"><a href="aplic-inf.html#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.05</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb106-4"><a href="aplic-inf.html#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb106-5"><a href="aplic-inf.html#cb106-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Proporción de rechazos al 1% = 0 
## Proporción de rechazos al 5% = 0 
## Proporción de rechazos al 10% = 0.001</code></pre>
<p>Análisis de los p-valores:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="aplic-inf.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pvalor, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb108-2"><a href="aplic-inf.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)   <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-47-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="aplic-inf.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución empírica</span></span>
<span id="cb109-2"><a href="aplic-inf.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ecdf</span>(pvalor)(x), <span class="at">type =</span> <span class="st">&quot;s&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb109-3"><a href="aplic-inf.html#cb109-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&#39;Tamaño del contraste&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Proporción de rechazos&#39;</span>, </span>
<span id="cb109-4"><a href="aplic-inf.html#cb109-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&#39;Nivel de significación&#39;</span>)</span>
<span id="cb109-5"><a href="aplic-inf.html#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)   <span class="co"># curve(punif(x, 0, 1), add = TRUE)</span></span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-47-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Repetir el apartado anterior considerando el test de Lilliefors
(rutina <code>lillie.test</code> del paquete <code>nortest</code>).</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="aplic-inf.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Valores iniciales:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="aplic-inf.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb111-2"><a href="aplic-inf.html#cb111-2" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb111-3"><a href="aplic-inf.html#cb111-3" aria-hidden="true" tabindex="-1"></a>mx <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb111-4"><a href="aplic-inf.html#cb111-4" aria-hidden="true" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb111-5"><a href="aplic-inf.html#cb111-5" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb111-6"><a href="aplic-inf.html#cb111-6" aria-hidden="true" tabindex="-1"></a>estadistico <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span>
<span id="cb111-7"><a href="aplic-inf.html#cb111-7" aria-hidden="true" tabindex="-1"></a>pvalor <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span></code></pre></div>
<p>Realizar contrastes</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="aplic-inf.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(isim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb112-2"><a href="aplic-inf.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  rx <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nx, mx, sx)</span>
<span id="cb112-3"><a href="aplic-inf.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tmp &lt;- ks.test(rx, &quot;pnorm&quot;, mean(rx), sd(rx))</span></span>
<span id="cb112-4"><a href="aplic-inf.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">lillie.test</span>(rx)</span>
<span id="cb112-5"><a href="aplic-inf.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  estadistico[isim] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>statistic</span>
<span id="cb112-6"><a href="aplic-inf.html#cb112-6" aria-hidden="true" tabindex="-1"></a>  pvalor[isim] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>p.value</span>
<span id="cb112-7"><a href="aplic-inf.html#cb112-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Proporción de rechazos:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="aplic-inf.html#cb113-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb113-2"><a href="aplic-inf.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Proporción de rechazos al 1% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.01</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb113-3"><a href="aplic-inf.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.05</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb113-4"><a href="aplic-inf.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb113-5"><a href="aplic-inf.html#cb113-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Proporción de rechazos al 1% = 0.01 
## Proporción de rechazos al 5% = 0.044 
## Proporción de rechazos al 10% = 0.089</code></pre>
<p>Análisis de los p-valores:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="aplic-inf.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pvalor, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb115-2"><a href="aplic-inf.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)   <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-52-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="aplic-inf.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución empírica</span></span>
<span id="cb116-2"><a href="aplic-inf.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ecdf</span>(pvalor)(x), <span class="at">type =</span> <span class="st">&quot;s&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">&#39;Tamaño del contraste&#39;</span>, </span>
<span id="cb116-3"><a href="aplic-inf.html#cb116-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&#39;Proporción de rechazos&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;Nivel de significación&#39;</span>)</span>
<span id="cb116-4"><a href="aplic-inf.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)   <span class="co"># curve(punif(x, 0, 1), add = TRUE)</span></span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-52-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Repetir el apartado a) contrastando una distribución exponencial
y considerando 500 pruebas con muestras de tamaño 30 de una <span class="math inline">\(Exp(1)\)</span>.</p>
<p>Valores iniciales:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="aplic-inf.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb117-2"><a href="aplic-inf.html#cb117-2" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb117-3"><a href="aplic-inf.html#cb117-3" aria-hidden="true" tabindex="-1"></a>ratex <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb117-4"><a href="aplic-inf.html#cb117-4" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb117-5"><a href="aplic-inf.html#cb117-5" aria-hidden="true" tabindex="-1"></a>estadistico <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span>
<span id="cb117-6"><a href="aplic-inf.html#cb117-6" aria-hidden="true" tabindex="-1"></a>pvalor <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span></code></pre></div>
<p>Realizar contrastes</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="aplic-inf.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(isim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb118-2"><a href="aplic-inf.html#cb118-2" aria-hidden="true" tabindex="-1"></a>  rx <span class="ot">&lt;-</span> <span class="fu">rexp</span>(nx, ratex)</span>
<span id="cb118-3"><a href="aplic-inf.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">ks.test</span>(rx, <span class="st">&quot;pexp&quot;</span>, <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(rx))</span>
<span id="cb118-4"><a href="aplic-inf.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  estadistico[isim] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>statistic</span>
<span id="cb118-5"><a href="aplic-inf.html#cb118-5" aria-hidden="true" tabindex="-1"></a>  pvalor[isim] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>p.value</span>
<span id="cb118-6"><a href="aplic-inf.html#cb118-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Proporción de rechazos:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="aplic-inf.html#cb119-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb119-2"><a href="aplic-inf.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Proporción de rechazos al 1% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.01</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb119-3"><a href="aplic-inf.html#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.05</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb119-4"><a href="aplic-inf.html#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb119-5"><a href="aplic-inf.html#cb119-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Proporción de rechazos al 1% = 0 
## Proporción de rechazos al 5% = 0.004 
## Proporción de rechazos al 10% = 0.008</code></pre>
<p>Análisis de los p-valores:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="aplic-inf.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pvalor, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb121-2"><a href="aplic-inf.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)   <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-56-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="aplic-inf.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución empírica</span></span>
<span id="cb122-2"><a href="aplic-inf.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ecdf</span>(pvalor)(x), <span class="at">type =</span> <span class="st">&quot;s&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb122-3"><a href="aplic-inf.html#cb122-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&#39;Tamaño del contraste&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Proporción de rechazos&#39;</span>, </span>
<span id="cb122-4"><a href="aplic-inf.html#cb122-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&#39;Nivel de significación&#39;</span>)</span>
<span id="cb122-5"><a href="aplic-inf.html#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)   <span class="co"># curve(punif(x, 0, 1), add = TRUE) </span></span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-56-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Diseñar una rutina que permita realizar el contraste KS de
bondad de ajuste de una variable exponencial aproximando el
<span class="math inline">\(p\)</span>-valor por simulación y repetir el apartado anterior
empleando esta rutina.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="aplic-inf.html#cb123-1" aria-hidden="true" tabindex="-1"></a>ks.exp.sim <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">nsim =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>) {</span>
<span id="cb123-2"><a href="aplic-inf.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  DNAME <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(x))</span>
<span id="cb123-3"><a href="aplic-inf.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  METHOD <span class="ot">&lt;-</span> <span class="st">&quot;Kolmogorov-Smirnov Test of pexp by simulation&quot;</span> </span>
<span id="cb123-4"><a href="aplic-inf.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb123-5"><a href="aplic-inf.html#cb123-5" aria-hidden="true" tabindex="-1"></a>  RATE <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb123-6"><a href="aplic-inf.html#cb123-6" aria-hidden="true" tabindex="-1"></a>  ks.exp.stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">rate=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)) {</span>
<span id="cb123-7"><a href="aplic-inf.html#cb123-7" aria-hidden="true" tabindex="-1"></a>    DMinus <span class="ot">&lt;-</span> <span class="fu">pexp</span>(<span class="fu">sort</span>(x), <span class="at">rate=</span>rate) <span class="sc">-</span> (<span class="dv">0</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">/</span>n</span>
<span id="cb123-8"><a href="aplic-inf.html#cb123-8" aria-hidden="true" tabindex="-1"></a>    DPlus <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">-</span> DMinus</span>
<span id="cb123-9"><a href="aplic-inf.html#cb123-9" aria-hidden="true" tabindex="-1"></a>    Dn <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">c</span>(DMinus, DPlus))</span>
<span id="cb123-10"><a href="aplic-inf.html#cb123-10" aria-hidden="true" tabindex="-1"></a>  }  </span>
<span id="cb123-11"><a href="aplic-inf.html#cb123-11" aria-hidden="true" tabindex="-1"></a>  STATISTIC <span class="ot">&lt;-</span> <span class="fu">ks.exp.stat</span>(x, <span class="at">rate =</span> RATE) </span>
<span id="cb123-12"><a href="aplic-inf.html#cb123-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(STATISTIC) <span class="ot">&lt;-</span> <span class="st">&quot;Dn&quot;</span></span>
<span id="cb123-13"><a href="aplic-inf.html#cb123-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PVAL &lt;- 0</span></span>
<span id="cb123-14"><a href="aplic-inf.html#cb123-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for(i in 1:nsim) {</span></span>
<span id="cb123-15"><a href="aplic-inf.html#cb123-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   rx &lt;- rexp(n, rate = RATE)</span></span>
<span id="cb123-16"><a href="aplic-inf.html#cb123-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   if (STATISTIC &lt;= ks.exp.stat(rx)) PVAL &lt;- PVAL+1</span></span>
<span id="cb123-17"><a href="aplic-inf.html#cb123-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb123-18"><a href="aplic-inf.html#cb123-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PVAL &lt;- PVAL/nsim</span></span>
<span id="cb123-19"><a href="aplic-inf.html#cb123-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PVAL &lt;- PVAL/(nsim + 1)</span></span>
<span id="cb123-20"><a href="aplic-inf.html#cb123-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PVAL &lt;- (PVAL + 1)/(nsim + 2)</span></span>
<span id="cb123-21"><a href="aplic-inf.html#cb123-21" aria-hidden="true" tabindex="-1"></a>  rx <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rexp</span>(n<span class="sc">*</span>nsim, <span class="at">rate =</span> RATE), <span class="at">ncol=</span>n)</span>
<span id="cb123-22"><a href="aplic-inf.html#cb123-22" aria-hidden="true" tabindex="-1"></a>  PVAL <span class="ot">&lt;-</span> <span class="fu">mean</span>(STATISTIC <span class="sc">&lt;=</span> <span class="fu">apply</span>(rx, <span class="dv">1</span>, ks.exp.stat))</span>
<span id="cb123-23"><a href="aplic-inf.html#cb123-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">structure</span>(<span class="fu">list</span>(<span class="at">statistic =</span> STATISTIC, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, </span>
<span id="cb123-24"><a href="aplic-inf.html#cb123-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p.value =</span> PVAL, <span class="at">method =</span> METHOD, <span class="at">data.name =</span> DNAME), </span>
<span id="cb123-25"><a href="aplic-inf.html#cb123-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">class =</span> <span class="st">&quot;htest&quot;</span>))</span>
<span id="cb123-26"><a href="aplic-inf.html#cb123-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Simulación:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="aplic-inf.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb124-2"><a href="aplic-inf.html#cb124-2" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb124-3"><a href="aplic-inf.html#cb124-3" aria-hidden="true" tabindex="-1"></a>ratex <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb124-4"><a href="aplic-inf.html#cb124-4" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb124-5"><a href="aplic-inf.html#cb124-5" aria-hidden="true" tabindex="-1"></a>estadistico <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span>
<span id="cb124-6"><a href="aplic-inf.html#cb124-6" aria-hidden="true" tabindex="-1"></a>pvalor <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span></code></pre></div>
<p>Realizar contrastes</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="aplic-inf.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(isim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb125-2"><a href="aplic-inf.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  rx <span class="ot">&lt;-</span> <span class="fu">rexp</span>(nx, ratex)</span>
<span id="cb125-3"><a href="aplic-inf.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tmp &lt;- ks.test(rx, &quot;pexp&quot;, 1/mean(rx))</span></span>
<span id="cb125-4"><a href="aplic-inf.html#cb125-4" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">ks.exp.sim</span>(rx, <span class="at">nsim =</span> <span class="dv">200</span>)</span>
<span id="cb125-5"><a href="aplic-inf.html#cb125-5" aria-hidden="true" tabindex="-1"></a>  estadistico[isim] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>statistic</span>
<span id="cb125-6"><a href="aplic-inf.html#cb125-6" aria-hidden="true" tabindex="-1"></a>  pvalor[isim] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>p.value</span>
<span id="cb125-7"><a href="aplic-inf.html#cb125-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Proporción de rechazos:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="aplic-inf.html#cb126-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb126-2"><a href="aplic-inf.html#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Proporción de rechazos al 1% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.01</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb126-3"><a href="aplic-inf.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.05</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb126-4"><a href="aplic-inf.html#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="fu">mean</span>(pvalor <span class="sc">&lt;</span> <span class="fl">0.1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb126-5"><a href="aplic-inf.html#cb126-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Proporción de rechazos al 1% = 0.008 
## Proporción de rechazos al 5% = 0.058 
## Proporción de rechazos al 10% = 0.106</code></pre>
<p>Análisis de los p-valores:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="aplic-inf.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pvalor, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb128-2"><a href="aplic-inf.html#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)   <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-60-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="aplic-inf.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución empírica</span></span>
<span id="cb129-2"><a href="aplic-inf.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ecdf</span>(pvalor)(x), <span class="at">type =</span> <span class="st">&quot;s&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb129-3"><a href="aplic-inf.html#cb129-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">&#39;Tamaño del contraste&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Proporción de rechazos&#39;</span>, </span>
<span id="cb129-4"><a href="aplic-inf.html#cb129-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&#39;Nivel de significación&#39;</span>)</span>
<span id="cb129-5"><a href="aplic-inf.html#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)   <span class="co"># curve(punif(x, 0, 1), add = TRUE) </span></span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-60-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Estudiar la potencia de los contrastes de los apartados c) y d),
considerando como alternativa una distribución Weibull.</p>
<p>La distribución exponencial es un caso particular de la Weibull:
<code>dexp(x, ratex) == dweibull(x, 1, 1/ratex)</code>.
Estudiamos lo que ocurre al desplazar <code>dweibull(x, shape, 1/ratex)</code> con <code>0 &lt; shape &lt; 2</code>.</p>
<p>CUIDADO: las simulaciones pueden requerir de mucho tiempo de computación
(consideramos valores pequeños de <code>nx</code> y <code>nsim</code> en datos y en <code>ks.exp.sim</code>).</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="aplic-inf.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb130-2"><a href="aplic-inf.html#cb130-2" aria-hidden="true" tabindex="-1"></a>nx <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb130-3"><a href="aplic-inf.html#cb130-3" aria-hidden="true" tabindex="-1"></a>ratex <span class="ot">&lt;-</span> <span class="dv">1</span>    <span class="co"># Puede ser interesante representarlo variando rate</span></span>
<span id="cb130-4"><a href="aplic-inf.html#cb130-4" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb130-5"><a href="aplic-inf.html#cb130-5" aria-hidden="true" tabindex="-1"></a>alfa <span class="ot">&lt;-</span> <span class="fl">0.1</span>   <span class="co"># Puede ser interesante representarlo variando alfa</span></span>
<span id="cb130-6"><a href="aplic-inf.html#cb130-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-7"><a href="aplic-inf.html#cb130-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-8"><a href="aplic-inf.html#cb130-8" aria-hidden="true" tabindex="-1"></a>shapex <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.25</span>, <span class="fl">1.75</span>, <span class="at">len=</span><span class="dv">21</span>)</span>
<span id="cb130-9"><a href="aplic-inf.html#cb130-9" aria-hidden="true" tabindex="-1"></a>preject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(shapex)) <span class="co"># Porporciones de rechazos con ks.test</span></span>
<span id="cb130-10"><a href="aplic-inf.html#cb130-10" aria-hidden="true" tabindex="-1"></a>ks.test.p <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">ks.test</span>(x, <span class="st">&quot;pexp&quot;</span>, <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x))<span class="sc">$</span>p.value</span>
<span id="cb130-11"><a href="aplic-inf.html#cb130-11" aria-hidden="true" tabindex="-1"></a>preject2 <span class="ot">&lt;-</span> preject <span class="co"># Porporciones de rechazos con ks.exp.sim</span></span>
<span id="cb130-12"><a href="aplic-inf.html#cb130-12" aria-hidden="true" tabindex="-1"></a>ks.exp.sim.p <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">ks.exp.sim</span>(x, <span class="dv">200</span>)<span class="sc">$</span>p.value</span>
<span id="cb130-13"><a href="aplic-inf.html#cb130-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-14"><a href="aplic-inf.html#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(shapex)) { </span>
<span id="cb130-15"><a href="aplic-inf.html#cb130-15" aria-hidden="true" tabindex="-1"></a>  rx <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rweibull</span>(nx<span class="sc">*</span>nsim, <span class="at">shape =</span> shapex[i], <span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span>ratex), <span class="at">ncol=</span>nx)</span>
<span id="cb130-16"><a href="aplic-inf.html#cb130-16" aria-hidden="true" tabindex="-1"></a>  preject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>( <span class="fu">apply</span>(rx, <span class="dv">1</span>, ks.test.p) <span class="sc">&lt;=</span> alfa )</span>
<span id="cb130-17"><a href="aplic-inf.html#cb130-17" aria-hidden="true" tabindex="-1"></a>  preject2[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>( <span class="fu">apply</span>(rx, <span class="dv">1</span>, ks.exp.sim.p) <span class="sc">&lt;=</span> alfa )</span>
<span id="cb130-18"><a href="aplic-inf.html#cb130-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-19"><a href="aplic-inf.html#cb130-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-20"><a href="aplic-inf.html#cb130-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shapex, preject, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Potencia del contraste ( alfa =&quot;</span>, alfa, <span class="st">&quot;)&quot;</span>), </span>
<span id="cb130-21"><a href="aplic-inf.html#cb130-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;shape&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Proporción de rechazos&quot;</span>)</span>
<span id="cb130-22"><a href="aplic-inf.html#cb130-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(shapex, preject2, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb130-23"><a href="aplic-inf.html#cb130-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> alfa, <span class="at">v =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/potencia-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
<p>El estadístico de Kolmogorov-Smirnov <code>Dn = max(c(DMinus, DPlus))</code> tiene ventajas desde el
punto de vista teórico, pero puede no ser muy potente para detectar diferencias entre la
distribución bajo la hipótesis nula y la distribución de los datos.
La ventaja de la aproximación por simulación es que no estamos atados a resultados teóricos
y podemos emplear el estadístico que se considere oportuno
(la principal desventaja es el tiempo de computación).
Por ejemplo, podríamos pensar en utilizar como estadístico la suma de los errores en
valor absoluto del correspondiente gráfico PP, y solo habría que cambiar el estadístico
<code>Dn</code> en la función <code>ks.exp.sim</code> por <code>Dn = sum(abs( (1:n - 0.5)/n -  pexp(sort(x), rate=rate) ))</code>.</p>
</div>
<div id="comparación-de-estimadores" class="section level3 hasAnchor" number="7.4.4">
<h3><span class="header-section-number">7.4.4</span> Comparación de estimadores<a href="aplic-inf.html#comparación-de-estimadores" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="exercise">
<p><span id="exr:media-median" class="exercise"><strong>Ejercicio 7.7  (Comparación de la eficiencia de la media muestral y de la mediana bajo contaminación) </strong></span><br></p>
<p>Supongamos que estamos interesados en estudiar el efecto de datos atípicos en la estimación de la media teórica mediante la media y la mediana muestrales.
Consideramos una variable aleatoria con distribución normal contaminada, en la que una observación procede de una <span class="math inline">\(N(0,1)\)</span> con probabilidad 0.95 y de una <span class="math inline">\(N(3,3^2)\)</span> con probabilidad 0.05 (mixtura).
Se puede generar una muestra de esta variable (mixtura) mediante el método de composición descrito en la Sección <a href="composicion.html#composicion">4.4</a>, por ejemplo empleando el siguiente código:</p>
<pre><code>p.sim &lt;- rbinom(n, 1, 0.05)
dat.sim &lt;- rnorm(n, 3*p.sim, 1+2*p.sim)</code></pre>
<p>Podemos comparar la densidad objetivo con la de los valores contaminados:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="aplic-inf.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="sc">-</span><span class="dv">3</span>, <span class="dv">12</span>, <span class="at">ylab =</span> <span class="st">&#39;densidad&#39;</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb132-2"><a href="aplic-inf.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fl">0.95</span><span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.05</span><span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/contaminada-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div class="remark">
<p><span id="unlabeled-div-2" class="remark"><em>Nota:</em>. </span>Como se comentó en la Sección <a href="composicion.html#composicion">4.4</a>, también es habitual simular este tipo de datos generando un porcentaje alto de valores (en este caso un 95%) de la distribución base (<span class="math inline">\(N(0,1)\)</span>) y el resto (5%) de la distibución “contaminadora” (<span class="math inline">\(N(3,3^2)\)</span>), aunque se suele considerar un porcentaje de contaminación del 1% o inferior (además, como en este caso concreto no va importar el orden, no sería necesario combinar aleatoriamente los valores).</p>
</div>
<p><br> </p>
<ol style="list-style-type: lower-alpha">
<li><p>Aproximar mediante simulación (500 generaciones) el sesgo y
error estándar de la media y la mediana en el caso de una
muestra de tamaño <span class="math inline">\(n=100\)</span> (suponiendo que se pretende estimar la
media no contaminada 0).</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="aplic-inf.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># media y mediana</span></span>
<span id="cb133-2"><a href="aplic-inf.html#cb133-2" aria-hidden="true" tabindex="-1"></a>xsd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb133-3"><a href="aplic-inf.html#cb133-3" aria-hidden="true" tabindex="-1"></a>xmed <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb133-4"><a href="aplic-inf.html#cb133-4" aria-hidden="true" tabindex="-1"></a>ndat <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb133-5"><a href="aplic-inf.html#cb133-5" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb133-6"><a href="aplic-inf.html#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="aplic-inf.html#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="co"># for (isim in 1:nsim) # evitar matrix y apply</span></span>
<span id="cb133-8"><a href="aplic-inf.html#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb133-9"><a href="aplic-inf.html#cb133-9" aria-hidden="true" tabindex="-1"></a>ntsim <span class="ot">&lt;-</span> ndat<span class="sc">*</span>nsim</span>
<span id="cb133-10"><a href="aplic-inf.html#cb133-10" aria-hidden="true" tabindex="-1"></a>p.sim <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(ntsim, <span class="dv">1</span>, <span class="fl">0.05</span>)</span>
<span id="cb133-11"><a href="aplic-inf.html#cb133-11" aria-hidden="true" tabindex="-1"></a>dat.sim <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(ntsim, <span class="dv">3</span><span class="sc">*</span>p.sim, <span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>p.sim)</span>
<span id="cb133-12"><a href="aplic-inf.html#cb133-12" aria-hidden="true" tabindex="-1"></a>dat.sim <span class="ot">&lt;-</span> <span class="fu">matrix</span>(dat.sim, <span class="at">ncol=</span>nsim)</span></code></pre></div>
<p>Cada columna es una muestra</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="aplic-inf.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dat.sim[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>##  num [1:100] 0.197 -0.42 1.163 -0.406 0.744 ...</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="aplic-inf.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat.sim[,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-62-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Calculamos los estimadores:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="aplic-inf.html#cb137-1" aria-hidden="true" tabindex="-1"></a>mean.sim <span class="ot">&lt;-</span> <span class="fu">apply</span>(dat.sim, <span class="dv">2</span>, mean)</span>
<span id="cb137-2"><a href="aplic-inf.html#cb137-2" aria-hidden="true" tabindex="-1"></a>median.sim <span class="ot">&lt;-</span> <span class="fu">apply</span>(dat.sim, <span class="dv">2</span>, median)</span></code></pre></div>
<p>Estimamos sus características:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="aplic-inf.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mean.sim) <span class="co"># Coincide con el sesgo (media teórica es 0)</span></span></code></pre></div>
<pre><code>## [1] 0.1459986</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="aplic-inf.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(mean.sim)</span></code></pre></div>
<pre><code>## [1] 0.1349537</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="aplic-inf.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(median.sim) <span class="co"># Coincide con el sesgo (media teórica es 0)</span></span></code></pre></div>
<pre><code>## [1] 0.04453509</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="aplic-inf.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(median.sim)</span></code></pre></div>
<pre><code>## [1] 0.1300611</code></pre>
<p>Sesgo:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="aplic-inf.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(mean.sim<span class="sc">-</span>xmed, median.sim<span class="sc">-</span>xmed, </span>
<span id="cb146-2"><a href="aplic-inf.html#cb146-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;Media&quot;</span>,<span class="st">&quot;Mediana&quot;</span>), <span class="at">ylab=</span><span class="st">&quot;Sesgo&quot;</span>)</span>
<span id="cb146-3"><a href="aplic-inf.html#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-65-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Error cuadrático:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="aplic-inf.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>((mean.sim<span class="sc">-</span>xmed)<span class="sc">^</span><span class="dv">2</span>, (median.sim<span class="sc">-</span>xmed)<span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb147-2"><a href="aplic-inf.html#cb147-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;Media&quot;</span>,<span class="st">&quot;Mediana&quot;</span>), <span class="at">ylab=</span><span class="st">&quot;Error cuadrático&quot;</span>)</span></code></pre></div>
<p><img src="07-Monte_Carlo_files/figure-html/unnamed-chunk-66-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Estadísticos error cuadrático:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="aplic-inf.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SE media</span></span>
<span id="cb148-2"><a href="aplic-inf.html#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>((mean.sim<span class="sc">-</span>xmed)<span class="sc">^</span><span class="dv">2</span>) </span></code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.0000005 0.0045072 0.0206272 0.0394917 0.0591531 0.3619587</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="aplic-inf.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SE mediana</span></span>
<span id="cb150-2"><a href="aplic-inf.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>((median.sim<span class="sc">-</span>xmed)<span class="sc">^</span><span class="dv">2</span>) </span></code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.0000001 0.0016481 0.0070625 0.0188654 0.0243903 0.2618368</code></pre></li>
</ol>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="opt-MC.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="técnicas-de-reducción-de-la-varianza.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/simbook/edit/master/07-Monte_Carlo.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Simulacion.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
