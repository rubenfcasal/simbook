<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>C.1 Integración numérica unidimensional | Simulación Estadística</title>
  <meta name="description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="C.1 Integración numérica unidimensional | Simulación Estadística" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rubenfcasal/simbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="C.1 Integración numérica unidimensional | Simulación Estadística" />
  
  <meta name="twitter:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén Fernández Casal (ruben.fcasal@udc.es), Ricardo Cao (rcao@udc.es)" />


<meta name="date" content="2022-03-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="int-num.html"/>
<link rel="next" href="integración-numérica-bidimensional.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simulación Estadística</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="cap1.html"><a href="cap1.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a>
<ul>
<li class="chapter" data-level="1.1" data-path="conceptos-básicos.html"><a href="conceptos-básicos.html"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="conceptos-básicos.html"><a href="conceptos-básicos.html#ventajas-e-inconvenientes-de-la-simulación"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas e inconvenientes de la simulación</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="aplicaciones-de-la-simulación.html"><a href="aplicaciones-de-la-simulación.html"><i class="fa fa-check"></i><b>1.2</b> Aplicaciones de la simulación</a></li>
<li class="chapter" data-level="1.3" data-path="números-aleatorios-puros.html"><a href="números-aleatorios-puros.html"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a></li>
<li class="chapter" data-level="1.4" data-path="generación-de-números-aleatorios-mediante-software.html"><a href="generación-de-números-aleatorios-mediante-software.html"><i class="fa fa-check"></i><b>1.4</b> Generación de números “aleatorios” mediante software</a></li>
<li class="chapter" data-level="1.5" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>1.5</b> Números pseudoaleatorios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rrng.html"><a href="rrng.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="opciones.html"><a href="opciones.html"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="paquetes-de-r.html"><a href="paquetes-de-r.html"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cap3.html"><a href="cap3.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gen-cong.html"><a href="gen-cong.html"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales lineales</a></li>
<li class="chapter" data-level="3.2" data-path="extensiones.html"><a href="extensiones.html"><i class="fa fa-check"></i><b>3.2</b> Extensiones</a></li>
<li class="chapter" data-level="3.3" data-path="calgen.html"><a href="calgen.html"><i class="fa fa-check"></i><b>3.3</b> Análisis de la calidad de un generador</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="calgen.html"><a href="calgen.html#repetición-de-contrastes"><i class="fa fa-check"></i><b>3.3.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.3.2" data-path="calgen.html"><a href="calgen.html#baterias"><i class="fa fa-check"></i><b>3.3.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>3.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cap4.html"><a href="cap4.html"><i class="fa fa-check"></i><b>4</b> Análisis de resultados de simulación</a>
<ul>
<li class="chapter" data-level="4.1" data-path="convergencia.html"><a href="convergencia.html"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="convergencia.html"><a href="convergencia.html#detección-de-problemas-de-convergencia"><i class="fa fa-check"></i><b>4.1.1</b> Detección de problemas de convergencia</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="estimación-de-la-precisión.html"><a href="estimación-de-la-precisión.html"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="teorema-central-del-límite.html"><a href="teorema-central-del-límite.html"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="determinación-del-número-de-generaciones.html"><a href="determinación-del-número-de-generaciones.html"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="observaciones.html"><a href="observaciones.html"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sim-con.html"><a href="sim-con.html"><i class="fa fa-check"></i><b>5</b> Simulación de variables continuas</a>
<ul>
<li class="chapter" data-level="5.1" data-path="método-de-inversión.html"><a href="método-de-inversión.html"><i class="fa fa-check"></i><b>5.1</b> Método de inversión</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="método-de-inversión.html"><a href="método-de-inversión.html#algunas-distribuciones-que-pueden-simularse-por-el-método-de-inversión"><i class="fa fa-check"></i><b>5.1.1</b> Algunas distribuciones que pueden simularse por el método de inversión</a></li>
<li class="chapter" data-level="5.1.2" data-path="método-de-inversión.html"><a href="método-de-inversión.html#ventajas-e-inconvenientes"><i class="fa fa-check"></i><b>5.1.2</b> Ventajas e inconvenientes</a></li>
<li class="chapter" data-level="5.1.3" data-path="método-de-inversión.html"><a href="método-de-inversión.html#inversión-aproximada"><i class="fa fa-check"></i><b>5.1.3</b> Inversión aproximada</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>5.2</b> Método de aceptación rechazo</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="AR.html"><a href="AR.html#algoritmo"><i class="fa fa-check"></i><b>5.2.1</b> Algoritmo</a></li>
<li class="chapter" data-level="5.2.2" data-path="AR.html"><a href="AR.html#densidades-acotadas-en-un-intervalo-cerrado"><i class="fa fa-check"></i><b>5.2.2</b> Densidades acotadas en un intervalo cerrado</a></li>
<li class="chapter" data-level="5.2.3" data-path="AR.html"><a href="AR.html#eficiencia-del-algoritmo"><i class="fa fa-check"></i><b>5.2.3</b> Eficiencia del algoritmo</a></li>
<li class="chapter" data-level="5.2.4" data-path="AR.html"><a href="AR.html#ejemplo-inferencia-bayesiana"><i class="fa fa-check"></i><b>5.2.4</b> Ejemplo: Inferencia Bayesiana</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html"><i class="fa fa-check"></i><b>5.3</b> Modificaciones del método de aceptación rechazo</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html#muestreo-por-rechazo-adaptativo-ars"><i class="fa fa-check"></i><b>5.3.1</b> Muestreo por rechazo adaptativo (ARS)</a></li>
<li class="chapter" data-level="5.3.2" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html#método-del-cociente-de-uniformes"><i class="fa fa-check"></i><b>5.3.2</b> Método del cociente de uniformes</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="composicion.html"><a href="composicion.html"><i class="fa fa-check"></i><b>5.4</b> Método de composición (o de simulación condicional)</a></li>
<li class="chapter" data-level="5.5" data-path="notables-cont.html"><a href="notables-cont.html"><i class="fa fa-check"></i><b>5.5</b> Métodos específicos para la generación de algunas distribuciones notables</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="notables-cont.html"><a href="notables-cont.html#método-de-box-müller"><i class="fa fa-check"></i><b>5.5.1</b> Método de Box-Müller</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="discretas.html"><a href="discretas.html"><i class="fa fa-check"></i><b>6</b> Simulación de variables discretas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="método-de-la-transformación-cuantil.html"><a href="método-de-la-transformación-cuantil.html"><i class="fa fa-check"></i><b>6.1</b> Método de la transformación cuantil</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="método-de-la-transformación-cuantil.html"><a href="método-de-la-transformación-cuantil.html#eficiencia-del-algoritmo-1"><i class="fa fa-check"></i><b>6.1.1</b> Eficiencia del algoritmo</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="método-de-la-tabla-guía.html"><a href="método-de-la-tabla-guía.html"><i class="fa fa-check"></i><b>6.2</b> Método de la tabla guía</a></li>
<li class="chapter" data-level="6.3" data-path="alias.html"><a href="alias.html"><i class="fa fa-check"></i><b>6.3</b> Método de Alias</a></li>
<li class="chapter" data-level="6.4" data-path="simulación-de-una-variable-discreta-con-dominio-infinito.html"><a href="simulación-de-una-variable-discreta-con-dominio-infinito.html"><i class="fa fa-check"></i><b>6.4</b> Simulación de una variable discreta con dominio infinito</a></li>
<li class="chapter" data-level="6.5" data-path="cálculo-directo-de-la-función-cuantil.html"><a href="cálculo-directo-de-la-función-cuantil.html"><i class="fa fa-check"></i><b>6.5</b> Cálculo directo de la función cuantil</a></li>
<li class="chapter" data-level="6.6" data-path="otros-métodos.html"><a href="otros-métodos.html"><i class="fa fa-check"></i><b>6.6</b> Otros métodos</a></li>
<li class="chapter" data-level="6.7" data-path="notables-disc.html"><a href="notables-disc.html"><i class="fa fa-check"></i><b>6.7</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulación-de-distribuciones-multivariantes.html"><a href="simulación-de-distribuciones-multivariantes.html"><i class="fa fa-check"></i><b>7</b> Simulación de distribuciones multivariantes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulación-de-componentes-independientes.html"><a href="simulación-de-componentes-independientes.html"><i class="fa fa-check"></i><b>7.1</b> Simulación de componentes independientes</a></li>
<li class="chapter" data-level="7.2" data-path="el-método-de-aceptaciónrechazo.html"><a href="el-método-de-aceptaciónrechazo.html"><i class="fa fa-check"></i><b>7.2</b> El método de aceptación/rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="fact-cov.html"><a href="fact-cov.html"><i class="fa fa-check"></i><b>7.3</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="7.4" data-path="distrcond.html"><a href="distrcond.html"><i class="fa fa-check"></i><b>7.4</b> Método de las distribuciones condicionadas</a></li>
<li class="chapter" data-level="7.5" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html"><i class="fa fa-check"></i><b>7.5</b> Simulación condicional e incondicional</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#condnormal"><i class="fa fa-check"></i><b>7.5.1</b> Simulación condicional de una normal multivariante</a></li>
<li class="chapter" data-level="7.5.2" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#simulación-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>7.5.2</b> Simulación condicional a partir de un modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html"><i class="fa fa-check"></i><b>7.6</b> Simulación basada en cópulas</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#cópulas-arquimedianas"><i class="fa fa-check"></i><b>7.6.1</b> Cópulas Arquimedianas</a></li>
<li class="chapter" data-level="7.6.2" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#simulación"><i class="fa fa-check"></i><b>7.6.2</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="mult-discr.html"><a href="mult-discr.html"><i class="fa fa-check"></i><b>7.7</b> Simulación de distribuciones multivariantes discretas</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="mult-discr.html"><a href="mult-discr.html#métodos-de-codificación-o-etiquetado-para-variables-discretas"><i class="fa fa-check"></i><b>7.7.1</b> Métodos de codificación o etiquetado para variables discretas</a></li>
<li class="chapter" data-level="7.7.2" data-path="mult-discr.html"><a href="mult-discr.html#simulación-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>7.7.2</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="7.7.3" data-path="mult-discr.html"><a href="mult-discr.html#simconting"><i class="fa fa-check"></i><b>7.7.3</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cap8.html"><a href="cap8.html"><i class="fa fa-check"></i><b>8</b> Aplicaciones en Inferencia Estadística</a>
<ul>
<li class="chapter" data-level="8.1" data-path="distribución-en-el-muestreo.html"><a href="distribución-en-el-muestreo.html"><i class="fa fa-check"></i><b>8.1</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="8.2" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>8.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="8.3" data-path="contrastes.html"><a href="contrastes.html"><i class="fa fa-check"></i><b>8.3</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="8.4" data-path="comparación-de-estimadores.html"><a href="comparación-de-estimadores.html"><i class="fa fa-check"></i><b>8.4</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="8.5" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>8.5</b> Remuestreo Bootstrap</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="bootstrap.html"><a href="bootstrap.html#idea"><i class="fa fa-check"></i><b>8.5.1</b> Idea:</a></li>
<li class="chapter" data-level="8.5.2" data-path="bootstrap.html"><a href="bootstrap.html#métodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>8.5.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="8.5.3" data-path="bootstrap.html"><a href="bootstrap.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>8.5.3</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="8.5.4" data-path="bootstrap.html"><a href="bootstrap.html#gráficos"><i class="fa fa-check"></i><b>8.5.4</b> Gráficos</a></li>
<li class="chapter" data-level="8.5.5" data-path="bootstrap.html"><a href="bootstrap.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>8.5.5</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cap9.html"><a href="cap9.html"><i class="fa fa-check"></i><b>9</b> Integración y Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="integración-monte-carlo-clásica.html"><a href="integración-monte-carlo-clásica.html"><i class="fa fa-check"></i><b>9.1</b> Integración Monte Carlo (clásica)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="integración-monte-carlo-clásica.html"><a href="integración-monte-carlo-clásica.html#caso-general"><i class="fa fa-check"></i><b>9.1.1</b> Caso general</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html"><i class="fa fa-check"></i><b>9.2</b> Muestreo por importancia</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="muestreo-importancia.html"><a href="muestreo-importancia.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>9.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="optimización-monte-carlo.html"><a href="optimización-monte-carlo.html"><i class="fa fa-check"></i><b>9.3</b> Optimización Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="optimización-monte-carlo.html"><a href="optimización-monte-carlo.html#algoritmos-de-optimización-monte-carlo"><i class="fa fa-check"></i><b>9.3.1</b> Algoritmos de optimización Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="temple-simulado.html"><a href="temple-simulado.html"><i class="fa fa-check"></i><b>9.4</b> Temple simulado</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="temple-simulado.html"><a href="temple-simulado.html#algoritmo-1"><i class="fa fa-check"></i><b>9.4.1</b> Algoritmo:</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="algoritmos-genéticos.html"><a href="algoritmos-genéticos.html"><i class="fa fa-check"></i><b>9.5</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="técnicas-de-reducción-de-la-varianza.html"><a href="técnicas-de-reducción-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a>
<ul>
<li class="chapter" data-level="10.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html"><i class="fa fa-check"></i><b>10.1</b> Variables antitéticas</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#ejemplo-integración-monte-carlo"><i class="fa fa-check"></i><b>10.1.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.1.2" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#generación-de-variables-antitéticas"><i class="fa fa-check"></i><b>10.1.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="estratificación.html"><a href="estratificación.html"><i class="fa fa-check"></i><b>10.2</b> Estratificación</a></li>
<li class="chapter" data-level="10.3" data-path="variables-de-control.html"><a href="variables-de-control.html"><i class="fa fa-check"></i><b>10.3</b> Variables de control</a></li>
<li class="chapter" data-level="10.4" data-path="números-aleatorios-comunes.html"><a href="números-aleatorios-comunes.html"><i class="fa fa-check"></i><b>10.4</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.5" data-path="ejercicios-2.html"><a href="ejercicios-2.html"><i class="fa fa-check"></i><b>10.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-básica.html"><a href="bibliografía-básica.html"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html"><i class="fa fa-check"></i>Bibliografía complementaria</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html#libros"><i class="fa fa-check"></i>Libros</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html#artículos"><i class="fa fa-check"></i>Artículos</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>A</b> Enlaces</a></li>
<li class="chapter" data-level="B" data-path="gof-aleat.html"><a href="gof-aleat.html"><i class="fa fa-check"></i><b>B</b> Bondad de Ajuste y Aleatoriedad</a>
<ul>
<li class="chapter" data-level="B.1" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i><b>B.1</b> Métodos de bondad de ajuste</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="gof.html"><a href="gof.html#histograma"><i class="fa fa-check"></i><b>B.1.1</b> Histograma</a></li>
<li class="chapter" data-level="B.1.2" data-path="gof.html"><a href="gof.html#empdistr"><i class="fa fa-check"></i><b>B.1.2</b> Función de distribución empírica</a></li>
<li class="chapter" data-level="B.1.3" data-path="gof.html"><a href="gof.html#gráficos-p-p-y-q-q"><i class="fa fa-check"></i><b>B.1.3</b> Gráficos P-P y Q-Q</a></li>
<li class="chapter" data-level="B.1.4" data-path="gof.html"><a href="gof.html#chi2test"><i class="fa fa-check"></i><b>B.1.4</b> Contraste chi-cuadrado de Pearson</a></li>
<li class="chapter" data-level="B.1.5" data-path="gof.html"><a href="gof.html#ks-test"><i class="fa fa-check"></i><b>B.1.5</b> Contraste de Kolmogorov-Smirnov</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="diag-aleat.html"><a href="diag-aleat.html"><i class="fa fa-check"></i><b>B.2</b> Diagnosis de la independencia</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="diag-aleat.html"><a href="diag-aleat.html#métodos-para-detectar-dependencia"><i class="fa fa-check"></i><b>B.2.1</b> Métodos para detectar dependencia</a></li>
<li class="chapter" data-level="B.2.2" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-secuencial"><i class="fa fa-check"></i><b>B.2.2</b> Gráfico secuencial</a></li>
<li class="chapter" data-level="B.2.3" data-path="diag-aleat.html"><a href="diag-aleat.html#gráfico-de-dispersion-retardado"><i class="fa fa-check"></i><b>B.2.3</b> Gráfico de dispersion retardado</a></li>
<li class="chapter" data-level="B.2.4" data-path="diag-aleat.html"><a href="diag-aleat.html#el-correlograma"><i class="fa fa-check"></i><b>B.2.4</b> El correlograma</a></li>
<li class="chapter" data-level="B.2.5" data-path="diag-aleat.html"><a href="diag-aleat.html#test-de-rachas"><i class="fa fa-check"></i><b>B.2.5</b> Test de rachas</a></li>
<li class="chapter" data-level="B.2.6" data-path="diag-aleat.html"><a href="diag-aleat.html#el-contraste-de-ljung-box"><i class="fa fa-check"></i><b>B.2.6</b> El contraste de Ljung-Box</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html"><i class="fa fa-check"></i><b>B.3</b> Contrastes específicos para generadores aleatorios</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-frecuencias"><i class="fa fa-check"></i><b>B.3.1</b> Contraste de frecuencias</a></li>
<li class="chapter" data-level="B.3.2" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-series"><i class="fa fa-check"></i><b>B.3.2</b> Contraste de series</a></li>
<li class="chapter" data-level="B.3.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-poker"><i class="fa fa-check"></i><b>B.3.3</b> El contraste del poker</a></li>
<li class="chapter" data-level="B.3.4" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-coleccionista"><i class="fa fa-check"></i><b>B.3.4</b> El contraste del coleccionista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="int-num.html"><a href="int-num.html"><i class="fa fa-check"></i><b>C</b> Integración numérica</a>
<ul>
<li class="chapter" data-level="C.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html"><i class="fa fa-check"></i><b>C.1</b> Integración numérica unidimensional</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#método-del-trapezoide"><i class="fa fa-check"></i><b>C.1.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="C.1.2" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#regla-de-simpson"><i class="fa fa-check"></i><b>C.1.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="C.1.3" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>C.1.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="C.1.4" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#comandos-de-r"><i class="fa fa-check"></i><b>C.1.4</b> Comandos de R</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html"><i class="fa fa-check"></i><b>C.2</b> Integración numérica bidimensional</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#representación-gráfica"><i class="fa fa-check"></i><b>C.2.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="C.2.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#método-del-trapezoide-1"><i class="fa fa-check"></i><b>C.2.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="C.2.3" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#comandos-de-r-1"><i class="fa fa-check"></i><b>C.2.3</b> Comandos de R</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulación Estadística</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="integración-numérica-unidimensional" class="section level2" number="13.1">
<h2><span class="header-section-number">C.1</span> Integración numérica unidimensional</h2>
<p>Supongamos que nos interesa aproximar una integral de la forma:
<span class="math display">\[I = \int_a^b h(x)  dx.\]</span>.</p>
<p>Consideraremos como ejemplo:
<span class="math display">\[\int_0^1 4x^4 dx = \frac{4}{5}\]</span>.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="integración-numérica-unidimensional.html#cb585-1" aria-hidden="true" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="dv">4</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb585-2"><a href="integración-numérica-unidimensional.html#cb585-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(fun, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb585-3"><a href="integración-numérica-unidimensional.html#cb585-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb585-4"><a href="integración-numérica-unidimensional.html#cb585-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="23-Integracion_numerica_files/figure-html/unnamed-chunk-2-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div id="método-del-trapezoide" class="section level3" number="13.1.1">
<h3><span class="header-section-number">C.1.1</span> Método del trapezoide</h3>
<p>La regla de los trapecios es una forma de aproximar la integral utilizando <span class="math inline">\(n\)</span> trapecios.
Si se consideran <span class="math inline">\(n\)</span> subintervalos en <span class="math inline">\([a,b]\)</span> de longitud <span class="math inline">\(h= \frac{b-a}{n}\)</span>
(i.e. <span class="math inline">\(n + 1\)</span> puntos regularmente espaciados cubriendo el dominio), y
se aproxima linealmente la función en cada subintervalo, se obtiene que:
<span class="math display">\[\int_a^b f(x)\, dx \approx \frac{h}{2} [f(a)+2f(a+h)+2f(a+2h)+...+f(b)]\]</span></p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="integración-numérica-unidimensional.html#cb586-1" aria-hidden="true" tabindex="-1"></a>trapezoid.vec <span class="ot">&lt;-</span> <span class="cf">function</span>(f.vec, <span class="at">h =</span> <span class="fl">0.01</span>) {</span>
<span id="cb586-2"><a href="integración-numérica-unidimensional.html#cb586-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Integración numérica unidimensional entre a y b</span></span>
<span id="cb586-3"><a href="integración-numérica-unidimensional.html#cb586-3" aria-hidden="true" tabindex="-1"></a><span class="co"># utilizando el método del trapezoide </span></span>
<span id="cb586-4"><a href="integración-numérica-unidimensional.html#cb586-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (se aproxima f linealmente en cada intervalo)</span></span>
<span id="cb586-5"><a href="integración-numérica-unidimensional.html#cb586-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(f.vec) </span>
<span id="cb586-6"><a href="integración-numérica-unidimensional.html#cb586-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(h<span class="sc">*</span>(f.vec[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sum</span>(f.vec[<span class="dv">2</span><span class="sc">:</span>(n<span class="dv">-1</span>)]) <span class="sc">+</span> f.vec[n]<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb586-7"><a href="integración-numérica-unidimensional.html#cb586-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb586-8"><a href="integración-numérica-unidimensional.html#cb586-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb586-9"><a href="integración-numérica-unidimensional.html#cb586-9" aria-hidden="true" tabindex="-1"></a>trapezoid <span class="ot">&lt;-</span> <span class="cf">function</span>(fun, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">n =</span> <span class="dv">100</span>) {</span>
<span id="cb586-10"><a href="integración-numérica-unidimensional.html#cb586-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Integración numérica de fun (función unidimensional) entre a y b</span></span>
<span id="cb586-11"><a href="integración-numérica-unidimensional.html#cb586-11" aria-hidden="true" tabindex="-1"></a><span class="co"># utilizando el método del trapezoide con n subdivisiones</span></span>
<span id="cb586-12"><a href="integración-numérica-unidimensional.html#cb586-12" aria-hidden="true" tabindex="-1"></a><span class="co"># (se aproxima f linealmente en cada intervalo)</span></span>
<span id="cb586-13"><a href="integración-numérica-unidimensional.html#cb586-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Se asume a &lt; b y n entero positivo </span></span>
<span id="cb586-14"><a href="integración-numérica-unidimensional.html#cb586-14" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> (b<span class="sc">-</span>a)<span class="sc">/</span>n</span>
<span id="cb586-15"><a href="integración-numérica-unidimensional.html#cb586-15" aria-hidden="true" tabindex="-1"></a>  x.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(a, b, <span class="at">by =</span> h)</span>
<span id="cb586-16"><a href="integración-numérica-unidimensional.html#cb586-16" aria-hidden="true" tabindex="-1"></a>  f.vec <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x.vec, fun)</span>
<span id="cb586-17"><a href="integración-numérica-unidimensional.html#cb586-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">trapezoid.vec</span>(f.vec, h))</span>
<span id="cb586-18"><a href="integración-numérica-unidimensional.html#cb586-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb586-19"><a href="integración-numérica-unidimensional.html#cb586-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb586-20"><a href="integración-numérica-unidimensional.html#cb586-20" aria-hidden="true" tabindex="-1"></a><span class="fu">trapezoid</span>(fun, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 0.8033325</code></pre>
<p>El error en esta aproximación se corresponde con:
<span class="math display">\[ \frac{(b-a)^3}{12n^2}\,f&#39;&#39;(\xi), \]</span>
para algún <span class="math inline">\(a\leq \xi \leq b\)</span> (dependiendo del signo de la segunda derivada,
i.e. de si la función es cóncava o convexa, el error será negativo ó positivo). El error
máximo absoluto es <span class="math inline">\(\frac{(b-a)^3}{12n^2}\max_{a\leq \xi \leq b}\left|f&#39;&#39;(\xi)\right|\)</span>.
En el caso general multidimensional sería <span class="math inline">\(O(n^{-\frac{2}{d}})\)</span>.</p>
</div>
<div id="regla-de-simpson" class="section level3" number="13.1.2">
<h3><span class="header-section-number">C.1.2</span> Regla de Simpson</h3>
<p>Se divide el intervalo <span class="math inline">\(n\)</span> subintervalos de longitud <span class="math inline">\(h= \frac{b-a}{n}\)</span> (con <span class="math inline">\(n\)</span> par),
considerando <span class="math inline">\(n + 1\)</span> puntos regularmente espaciados <span class="math inline">\(x_i = a + ih\)</span>, para <span class="math inline">\(i = 0, 1, ..., n\)</span>.
Aproximando de forma cuadrática la función en cada subintervalo <span class="math inline">\([x_{j-1},x_{j+1}]\)</span>
(considerando 3 puntos), se obtiene que:
<span class="math display">\[ \int_a^b f(x) \, dx \approx \frac{h}{3} \bigg[ 
f(x_0)+2\sum_{j=1}^{(n/2)-1}f(x_{2j})+ 4\sum_{j=1}^{n/2}f(x_{2j-1})+f(x_n) \bigg],\]</span></p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="integración-numérica-unidimensional.html#cb588-1" aria-hidden="true" tabindex="-1"></a>simpson <span class="ot">&lt;-</span> <span class="cf">function</span>(fun, a, b, <span class="at">n =</span> <span class="dv">100</span>) { </span>
<span id="cb588-2"><a href="integración-numérica-unidimensional.html#cb588-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Integración numérica de fnt entre a y b</span></span>
<span id="cb588-3"><a href="integración-numérica-unidimensional.html#cb588-3" aria-hidden="true" tabindex="-1"></a><span class="co"># utilizando la regla de Simpson con n subdivisiones</span></span>
<span id="cb588-4"><a href="integración-numérica-unidimensional.html#cb588-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (se aproxima fun de forma cuadrática en cada par de intervalos)  </span></span>
<span id="cb588-5"><a href="integración-numérica-unidimensional.html#cb588-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fnt es una función de una sola variable</span></span>
<span id="cb588-6"><a href="integración-numérica-unidimensional.html#cb588-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Se asume a &lt; b y n entero positivo par </span></span>
<span id="cb588-7"><a href="integración-numérica-unidimensional.html#cb588-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>(n <span class="sc">%/%</span> <span class="dv">2</span>), <span class="dv">4</span>))</span>
<span id="cb588-8"><a href="integración-numérica-unidimensional.html#cb588-8" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> (b<span class="sc">-</span>a)<span class="sc">/</span>n</span>
<span id="cb588-9"><a href="integración-numérica-unidimensional.html#cb588-9" aria-hidden="true" tabindex="-1"></a>  x.vec1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(a<span class="sc">+</span>h, b<span class="sc">-</span>h, <span class="at">by =</span> <span class="dv">2</span><span class="sc">*</span>h)</span>
<span id="cb588-10"><a href="integración-numérica-unidimensional.html#cb588-10" aria-hidden="true" tabindex="-1"></a>  x.vec2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(a<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>h, b<span class="dv">-2</span><span class="sc">*</span>h, <span class="at">by =</span> <span class="dv">2</span><span class="sc">*</span>h)</span>
<span id="cb588-11"><a href="integración-numérica-unidimensional.html#cb588-11" aria-hidden="true" tabindex="-1"></a>  f.vec1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x.vec1, fun)</span>
<span id="cb588-12"><a href="integración-numérica-unidimensional.html#cb588-12" aria-hidden="true" tabindex="-1"></a>  f.vec2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x.vec2, fun)</span>
<span id="cb588-13"><a href="integración-numérica-unidimensional.html#cb588-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(h<span class="sc">/</span><span class="dv">3</span><span class="sc">*</span>(<span class="fu">fun</span>(a) <span class="sc">+</span> <span class="fu">fun</span>(b) <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span><span class="fu">sum</span>(f.vec1) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(f.vec2)))</span>
<span id="cb588-14"><a href="integración-numérica-unidimensional.html#cb588-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Una cota del error en valor absoluto es:</span></span>
<span id="cb588-15"><a href="integración-numérica-unidimensional.html#cb588-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># h^4*(b-a)*max(c(f.vec1, fvec.2))^4/180.</span></span>
<span id="cb588-16"><a href="integración-numérica-unidimensional.html#cb588-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb588-17"><a href="integración-numérica-unidimensional.html#cb588-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-18"><a href="integración-numérica-unidimensional.html#cb588-18" aria-hidden="true" tabindex="-1"></a><span class="fu">simpson</span>(fun, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 0.8000033</code></pre>
<p>El máximo error (en el caso unidimensional) viene dado por la expresión:
<span class="math display">\[\frac{(b-a)^5}{180n^4}\,\max_{a\leq \xi \leq b}\left| f^{(4)}(\xi) \right|.\]</span>
En el caso general multidimensional sería <span class="math inline">\(O(n^{-\frac{4}{d}})\)</span>.</p>
</div>
<div id="cuadratura-adaptativa" class="section level3" number="13.1.3">
<h3><span class="header-section-number">C.1.3</span> Cuadratura adaptativa</h3>
<p>En lugar de evaluar la función en una rejilla regular (muestrear por igual el dominio),
puede interesar ir añadiendo puntos sólo en los lugares donde se mejore la aproximación
(en principio donde hay mayor área).</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="integración-numérica-unidimensional.html#cb590-1" aria-hidden="true" tabindex="-1"></a>quadrature <span class="ot">&lt;-</span> <span class="cf">function</span>(fun, a, b, <span class="at">tol=</span><span class="fl">1e-8</span>) {</span>
<span id="cb590-2"><a href="integración-numérica-unidimensional.html#cb590-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># numerical integration using adaptive quadrature</span></span>
<span id="cb590-3"><a href="integración-numérica-unidimensional.html#cb590-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-4"><a href="integración-numérica-unidimensional.html#cb590-4" aria-hidden="true" tabindex="-1"></a>  simpson2 <span class="ot">&lt;-</span> <span class="cf">function</span>(fun, a, b) {</span>
<span id="cb590-5"><a href="integración-numérica-unidimensional.html#cb590-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># numerical integral using Simpson&#39;s rule</span></span>
<span id="cb590-6"><a href="integración-numérica-unidimensional.html#cb590-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># assume a &lt; b and n = 2</span></span>
<span id="cb590-7"><a href="integración-numérica-unidimensional.html#cb590-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>((b<span class="sc">-</span>a)<span class="sc">/</span><span class="dv">6</span> <span class="sc">*</span> (<span class="fu">fun</span>(a) <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span><span class="fu">fun</span>((a<span class="sc">+</span>b)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">fun</span>(b)))</span>
<span id="cb590-8"><a href="integración-numérica-unidimensional.html#cb590-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb590-9"><a href="integración-numérica-unidimensional.html#cb590-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb590-10"><a href="integración-numérica-unidimensional.html#cb590-10" aria-hidden="true" tabindex="-1"></a>    quadrature_internal <span class="ot">&lt;-</span> <span class="cf">function</span>(S.old, fun, a, m, b, tol, level) {</span>
<span id="cb590-11"><a href="integración-numérica-unidimensional.html#cb590-11" aria-hidden="true" tabindex="-1"></a>        level.max <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb590-12"><a href="integración-numérica-unidimensional.html#cb590-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (level <span class="sc">&gt;</span> level.max) {</span>
<span id="cb590-13"><a href="integración-numérica-unidimensional.html#cb590-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cat</span> (<span class="st">&quot;recursion limit reached: singularity likely</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb590-14"><a href="integración-numérica-unidimensional.html#cb590-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span> (<span class="cn">NULL</span>)</span>
<span id="cb590-15"><a href="integración-numérica-unidimensional.html#cb590-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb590-16"><a href="integración-numérica-unidimensional.html#cb590-16" aria-hidden="true" tabindex="-1"></a>        S.left <span class="ot">&lt;-</span> <span class="fu">simpson2</span>(fun, a, m) </span>
<span id="cb590-17"><a href="integración-numérica-unidimensional.html#cb590-17" aria-hidden="true" tabindex="-1"></a>        S.right <span class="ot">&lt;-</span> <span class="fu">simpson2</span>(fun, m, b)</span>
<span id="cb590-18"><a href="integración-numérica-unidimensional.html#cb590-18" aria-hidden="true" tabindex="-1"></a>        S.new <span class="ot">&lt;-</span> S.left <span class="sc">+</span> S.right</span>
<span id="cb590-19"><a href="integración-numérica-unidimensional.html#cb590-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">abs</span>(S.new<span class="sc">-</span>S.old) <span class="sc">&gt;</span> tol) {</span>
<span id="cb590-20"><a href="integración-numérica-unidimensional.html#cb590-20" aria-hidden="true" tabindex="-1"></a>            S.left <span class="ot">&lt;-</span> <span class="fu">quadrature_internal</span>(S.left, fun, </span>
<span id="cb590-21"><a href="integración-numérica-unidimensional.html#cb590-21" aria-hidden="true" tabindex="-1"></a>                                          a, (a<span class="sc">+</span>m)<span class="sc">/</span><span class="dv">2</span>, m, tol<span class="sc">/</span><span class="dv">2</span>, level<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb590-22"><a href="integración-numérica-unidimensional.html#cb590-22" aria-hidden="true" tabindex="-1"></a>            S.right <span class="ot">&lt;-</span> <span class="fu">quadrature_internal</span>(S.right, fun, </span>
<span id="cb590-23"><a href="integración-numérica-unidimensional.html#cb590-23" aria-hidden="true" tabindex="-1"></a>                                           m, (m<span class="sc">+</span>b)<span class="sc">/</span><span class="dv">2</span>, b, tol<span class="sc">/</span><span class="dv">2</span>, level<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb590-24"><a href="integración-numérica-unidimensional.html#cb590-24" aria-hidden="true" tabindex="-1"></a>            S.new <span class="ot">&lt;-</span> S.left <span class="sc">+</span> S.right</span>
<span id="cb590-25"><a href="integración-numérica-unidimensional.html#cb590-25" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb590-26"><a href="integración-numérica-unidimensional.html#cb590-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(S.new)</span>
<span id="cb590-27"><a href="integración-numérica-unidimensional.html#cb590-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb590-28"><a href="integración-numérica-unidimensional.html#cb590-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb590-29"><a href="integración-numérica-unidimensional.html#cb590-29" aria-hidden="true" tabindex="-1"></a>    level <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb590-30"><a href="integración-numérica-unidimensional.html#cb590-30" aria-hidden="true" tabindex="-1"></a>    S.old <span class="ot">&lt;-</span> (b<span class="sc">-</span>a) <span class="sc">*</span> (<span class="fu">fun</span>(a) <span class="sc">+</span> <span class="fu">fun</span>(b))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb590-31"><a href="integración-numérica-unidimensional.html#cb590-31" aria-hidden="true" tabindex="-1"></a>    S.new <span class="ot">&lt;-</span> <span class="fu">quadrature_internal</span>(S.old, fun, </span>
<span id="cb590-32"><a href="integración-numérica-unidimensional.html#cb590-32" aria-hidden="true" tabindex="-1"></a>                                 a, (a<span class="sc">+</span>b)<span class="sc">/</span><span class="dv">2</span>, b, tol, level<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb590-33"><a href="integración-numérica-unidimensional.html#cb590-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(S.new)</span>
<span id="cb590-34"><a href="integración-numérica-unidimensional.html#cb590-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb590-35"><a href="integración-numérica-unidimensional.html#cb590-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-36"><a href="integración-numérica-unidimensional.html#cb590-36" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrature</span>(fun, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8</code></pre>
<p>Fuente: <a href="https://www.r-bloggers.com/one-dimensional-integrals">r-blogger Guangchuang Yu</a></p>
</div>
<div id="comandos-de-r" class="section level3" number="13.1.4">
<h3><span class="header-section-number">C.1.4</span> Comandos de R</h3>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="integración-numérica-unidimensional.html#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(fun, <span class="dv">0</span>, <span class="dv">1</span>)   <span class="co"># Permite límites infinitos  </span></span></code></pre></div>
<pre><code>## 0.8 with absolute error &lt; 8.9e-15</code></pre>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="integración-numérica-unidimensional.html#cb594-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Cuidado: fun debe ser vectorial...</span></span>
<span id="cb594-2"><a href="integración-numérica-unidimensional.html#cb594-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-3"><a href="integración-numérica-unidimensional.html#cb594-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(MASS)</span>
<span id="cb594-4"><a href="integración-numérica-unidimensional.html#cb594-4" aria-hidden="true" tabindex="-1"></a><span class="fu">area</span>(fun, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.8000001</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="int-num.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="integración-numérica-bidimensional.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/simbook/edit/master/23-Integracion_numerica.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Simulacion.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
