<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.3 Contrastes de hipótesis | Simulación Estadística</title>
  <meta name="description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="8.3 Contrastes de hipótesis | Simulación Estadística" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rubenfcasal/simbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.3 Contrastes de hipótesis | Simulación Estadística" />
  
  <meta name="twitter:description" content="Apuntes de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén Fernández Casal (ruben.fcasal@udc.es), Ricardo Cao (rcao@udc.es)" />


<meta name="date" content="2020-05-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intervalos-de-confianza.html"/>
<link rel="next" href="comparación-de-estimadores.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simulación Estadística</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="cap1.html"><a href="cap1.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a><ul>
<li class="chapter" data-level="1.1" data-path="conceptos-básicos.html"><a href="conceptos-básicos.html"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos</a><ul>
<li class="chapter" data-level="1.1.1" data-path="conceptos-básicos.html"><a href="conceptos-básicos.html#ventajas-e-inconvenientes-de-la-simulación"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas e inconvenientes de la simulación</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="generación-de-números-pseudoaleatorios.html"><a href="generación-de-números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>1.2</b> Generación de números (pseudo)aleatorios</a></li>
<li class="chapter" data-level="1.3" data-path="números-aleatorios-puros.html"><a href="números-aleatorios-puros.html"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a><ul>
<li class="chapter" data-level="1.3.1" data-path="números-aleatorios-puros.html"><a href="números-aleatorios-puros.html#inconvenientes"><i class="fa fa-check"></i><b>1.3.1</b> Inconvenientes:</a></li>
<li class="chapter" data-level="1.3.2" data-path="números-aleatorios-puros.html"><a href="números-aleatorios-puros.html#alternativas"><i class="fa fa-check"></i><b>1.3.2</b> Alternativas:</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="números-pseudoaleatorios.html"><a href="números-pseudoaleatorios.html"><i class="fa fa-check"></i><b>1.4</b> Números pseudoaleatorios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cap2.html"><a href="cap2.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a><ul>
<li class="chapter" data-level="2.1" data-path="opciones.html"><a href="opciones.html"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="paquetes-de-r.html"><a href="paquetes-de-r.html"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a><ul>
<li class="chapter" data-level="2.4.1" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html#utilidades-tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4.1</b> Utilidades tiempo de CPU</a></li>
<li class="chapter" data-level="2.4.2" data-path="tiempo-de-cpu.html"><a href="tiempo-de-cpu.html#paquetes-de-r-1"><i class="fa fa-check"></i><b>2.4.2</b> Paquetes de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cap3.html"><a href="cap3.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a><ul>
<li class="chapter" data-level="3.1" data-path="gen-cong.html"><a href="gen-cong.html"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales</a><ul>
<li class="chapter" data-level="3.1.1" data-path="gen-cong.html"><a href="gen-cong.html#otros-generadores"><i class="fa fa-check"></i><b>3.1.1</b> Otros generadores</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="calgen.html"><a href="calgen.html"><i class="fa fa-check"></i><b>3.2</b> Análisis de la calidad de un generador</a><ul>
<li class="chapter" data-level="3.2.1" data-path="calgen.html"><a href="calgen.html#repetición-de-contrastes"><i class="fa fa-check"></i><b>3.2.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.2.2" data-path="calgen.html"><a href="calgen.html#baterias"><i class="fa fa-check"></i><b>3.2.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>3.3</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cap4.html"><a href="cap4.html"><i class="fa fa-check"></i><b>4</b> Análisis de resultados de simulación</a><ul>
<li class="chapter" data-level="4.1" data-path="convergencia.html"><a href="convergencia.html"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a><ul>
<li class="chapter" data-level="4.1.1" data-path="convergencia.html"><a href="convergencia.html#detección-de-problemas-de-convergencia"><i class="fa fa-check"></i><b>4.1.1</b> Detección de problemas de convergencia</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="estimación-de-la-precisión.html"><a href="estimación-de-la-precisión.html"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="teorema-central-del-límite.html"><a href="teorema-central-del-límite.html"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="determinación-del-número-de-generaciones.html"><a href="determinación-del-número-de-generaciones.html"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia</a><ul>
<li class="chapter" data-level="4.5.1" data-path="el-problema-de-la-dependencia.html"><a href="el-problema-de-la-dependencia.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="observaciones.html"><a href="observaciones.html"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulación-de-variables-continuas.html"><a href="simulación-de-variables-continuas.html"><i class="fa fa-check"></i><b>5</b> Simulación de variables continuas</a><ul>
<li class="chapter" data-level="5.1" data-path="método-de-inversión.html"><a href="método-de-inversión.html"><i class="fa fa-check"></i><b>5.1</b> Método de inversión</a><ul>
<li class="chapter" data-level="5.1.1" data-path="método-de-inversión.html"><a href="método-de-inversión.html#algunas-distribuciones-que-pueden-simularse-por-el-método-de-inversión"><i class="fa fa-check"></i><b>5.1.1</b> Algunas distribuciones que pueden simularse por el método de inversión</a></li>
<li class="chapter" data-level="5.1.2" data-path="método-de-inversión.html"><a href="método-de-inversión.html#ventajas-e-inconvenientes"><i class="fa fa-check"></i><b>5.1.2</b> Ventajas e inconvenientes</a></li>
<li class="chapter" data-level="5.1.3" data-path="método-de-inversión.html"><a href="método-de-inversión.html#inversión-aproximada"><i class="fa fa-check"></i><b>5.1.3</b> Inversión aproximada</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>5.2</b> Método de aceptación rechazo</a><ul>
<li class="chapter" data-level="5.2.1" data-path="AR.html"><a href="AR.html#algoritmo"><i class="fa fa-check"></i><b>5.2.1</b> Algoritmo</a></li>
<li class="chapter" data-level="5.2.2" data-path="AR.html"><a href="AR.html#densidades-acotadas-en-un-intervalo-cerrado"><i class="fa fa-check"></i><b>5.2.2</b> Densidades acotadas en un intervalo cerrado</a></li>
<li class="chapter" data-level="5.2.3" data-path="AR.html"><a href="AR.html#eficiencia-del-algoritmo"><i class="fa fa-check"></i><b>5.2.3</b> Eficiencia del algoritmo</a></li>
<li class="chapter" data-level="5.2.4" data-path="AR.html"><a href="AR.html#ejemplo-inferencia-bayesiana"><i class="fa fa-check"></i><b>5.2.4</b> Ejemplo: Inferencia Bayesiana</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html"><i class="fa fa-check"></i><b>5.3</b> Modificaciones del método de aceptación rechazo</a><ul>
<li class="chapter" data-level="5.3.1" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html#muestreo-por-rechazo-adaptativo-ars"><i class="fa fa-check"></i><b>5.3.1</b> Muestreo por rechazo adaptativo (ARS)</a></li>
<li class="chapter" data-level="5.3.2" data-path="modificaciones-del-método-de-aceptación-rechazo.html"><a href="modificaciones-del-método-de-aceptación-rechazo.html#método-del-cociente-de-uniformes"><i class="fa fa-check"></i><b>5.3.2</b> Método del cociente de uniformes</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="método-de-composición.html"><a href="método-de-composición.html"><i class="fa fa-check"></i><b>5.4</b> Método de composición</a></li>
<li class="chapter" data-level="5.5" data-path="métodos-específicos-para-la-generación-de-algunas-distribuciones-notables.html"><a href="métodos-específicos-para-la-generación-de-algunas-distribuciones-notables.html"><i class="fa fa-check"></i><b>5.5</b> Métodos específicos para la generación de algunas distribuciones notables</a><ul>
<li class="chapter" data-level="5.5.1" data-path="métodos-específicos-para-la-generación-de-algunas-distribuciones-notables.html"><a href="métodos-específicos-para-la-generación-de-algunas-distribuciones-notables.html#método-de-box-müller"><i class="fa fa-check"></i><b>5.5.1</b> Método de Box-Müller</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cap6.html"><a href="cap6.html"><i class="fa fa-check"></i><b>6</b> Simulación de variables discretas</a><ul>
<li class="chapter" data-level="6.1" data-path="método-de-la-transformación-cuantil.html"><a href="método-de-la-transformación-cuantil.html"><i class="fa fa-check"></i><b>6.1</b> Método de la transformación cuantil</a><ul>
<li class="chapter" data-level="6.1.1" data-path="método-de-la-transformación-cuantil.html"><a href="método-de-la-transformación-cuantil.html#eficiencia-del-algoritmo-1"><i class="fa fa-check"></i><b>6.1.1</b> Eficiencia del algoritmo</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="método-de-la-tabla-guía.html"><a href="método-de-la-tabla-guía.html"><i class="fa fa-check"></i><b>6.2</b> Método de la tabla guía</a></li>
<li class="chapter" data-level="6.3" data-path="alias.html"><a href="alias.html"><i class="fa fa-check"></i><b>6.3</b> Método de Alias</a></li>
<li class="chapter" data-level="6.4" data-path="simulación-de-una-variable-discreta-con-dominio-infinito.html"><a href="simulación-de-una-variable-discreta-con-dominio-infinito.html"><i class="fa fa-check"></i><b>6.4</b> Simulación de una variable discreta con dominio infinito</a></li>
<li class="chapter" data-level="6.5" data-path="cálculo-directo-de-la-función-cuantil.html"><a href="cálculo-directo-de-la-función-cuantil.html"><i class="fa fa-check"></i><b>6.5</b> Cálculo directo de la función cuantil</a></li>
<li class="chapter" data-level="6.6" data-path="otros-métodos.html"><a href="otros-métodos.html"><i class="fa fa-check"></i><b>6.6</b> Otros métodos</a></li>
<li class="chapter" data-level="6.7" data-path="métodos-específicos-para-generación-de-distribuciones-notables.html"><a href="métodos-específicos-para-generación-de-distribuciones-notables.html"><i class="fa fa-check"></i><b>6.7</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulación-de-distribuciones-multivariantes.html"><a href="simulación-de-distribuciones-multivariantes.html"><i class="fa fa-check"></i><b>7</b> Simulación de distribuciones multivariantes</a><ul>
<li class="chapter" data-level="7.1" data-path="simulación-de-componentes-independientes.html"><a href="simulación-de-componentes-independientes.html"><i class="fa fa-check"></i><b>7.1</b> Simulación de componentes independientes</a></li>
<li class="chapter" data-level="7.2" data-path="el-método-de-aceptaciónrechazo.html"><a href="el-método-de-aceptaciónrechazo.html"><i class="fa fa-check"></i><b>7.2</b> El método de aceptación/rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="fact-cov.html"><a href="fact-cov.html"><i class="fa fa-check"></i><b>7.3</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="7.4" data-path="distrcond.html"><a href="distrcond.html"><i class="fa fa-check"></i><b>7.4</b> Método de las distribuciones condicionadas</a></li>
<li class="chapter" data-level="7.5" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html"><i class="fa fa-check"></i><b>7.5</b> Simulación condicional e incondicional</a><ul>
<li class="chapter" data-level="7.5.1" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#condnormal"><i class="fa fa-check"></i><b>7.5.1</b> Simulación condicional de una normal multivariante</a></li>
<li class="chapter" data-level="7.5.2" data-path="simulación-condicional-e-incondicional.html"><a href="simulación-condicional-e-incondicional.html#simulación-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>7.5.2</b> Simulación condicional a partir de un modelo ajustado</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html"><i class="fa fa-check"></i><b>7.6</b> Simulación basada en cópulas</a><ul>
<li class="chapter" data-level="7.6.1" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#cópulas-arquimedianas"><i class="fa fa-check"></i><b>7.6.1</b> Cópulas Arquimedianas</a></li>
<li class="chapter" data-level="7.6.2" data-path="simulación-basada-en-cópulas.html"><a href="simulación-basada-en-cópulas.html#simulación"><i class="fa fa-check"></i><b>7.6.2</b> Simulación</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="mult-discr.html"><a href="mult-discr.html"><i class="fa fa-check"></i><b>7.7</b> Simulación de distribuciones multivariantes discretas</a><ul>
<li class="chapter" data-level="7.7.1" data-path="mult-discr.html"><a href="mult-discr.html#métodos-de-codificación-o-etiquetado-para-variables-discretas"><i class="fa fa-check"></i><b>7.7.1</b> Métodos de codificación o etiquetado para variables discretas</a></li>
<li class="chapter" data-level="7.7.2" data-path="mult-discr.html"><a href="mult-discr.html#simulación-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>7.7.2</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="7.7.3" data-path="mult-discr.html"><a href="mult-discr.html#simconting"><i class="fa fa-check"></i><b>7.7.3</b> Simulación de tablas de contingencia</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="ejercicios-propuestos.html"><a href="ejercicios-propuestos.html"><i class="fa fa-check"></i><b>7.8</b> Ejercicios propuestos</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cap8.html"><a href="cap8.html"><i class="fa fa-check"></i><b>8</b> Aplicaciones en Inferencia Estadística</a><ul>
<li class="chapter" data-level="8.1" data-path="distribución-en-el-muestreo.html"><a href="distribución-en-el-muestreo.html"><i class="fa fa-check"></i><b>8.1</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="8.2" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>8.2</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="8.3" data-path="contrastes.html"><a href="contrastes.html"><i class="fa fa-check"></i><b>8.3</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="8.4" data-path="comparación-de-estimadores.html"><a href="comparación-de-estimadores.html"><i class="fa fa-check"></i><b>8.4</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="8.5" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html"><i class="fa fa-check"></i><b>8.5</b> Remuestreo Bootstrap</a><ul>
<li class="chapter" data-level="8.5.1" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#idea"><i class="fa fa-check"></i><b>8.5.1</b> Idea:</a></li>
<li class="chapter" data-level="8.5.2" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#métodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>8.5.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="8.5.3" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>8.5.3</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="8.5.4" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#gráficos"><i class="fa fa-check"></i><b>8.5.4</b> Gráficos</a></li>
<li class="chapter" data-level="8.5.5" data-path="remuestreo-bootstrap.html"><a href="remuestreo-bootstrap.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>8.5.5</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cap9.html"><a href="cap9.html"><i class="fa fa-check"></i><b>9</b> Integración y Optimización Monte Carlo</a><ul>
<li class="chapter" data-level="9.1" data-path="integración-monte-carlo-clásica.html"><a href="integración-monte-carlo-clásica.html"><i class="fa fa-check"></i><b>9.1</b> Integración Monte Carlo (clásica)</a><ul>
<li class="chapter" data-level="9.1.1" data-path="integración-monte-carlo-clásica.html"><a href="integración-monte-carlo-clásica.html#caso-general"><i class="fa fa-check"></i><b>9.1.1</b> Caso general</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="muestreo-por-importancia.html"><a href="muestreo-por-importancia.html"><i class="fa fa-check"></i><b>9.2</b> Muestreo por importancia</a><ul>
<li class="chapter" data-level="9.2.1" data-path="muestreo-por-importancia.html"><a href="muestreo-por-importancia.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>9.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="optimización-monte-carlo.html"><a href="optimización-monte-carlo.html"><i class="fa fa-check"></i><b>9.3</b> Optimización Monte Carlo</a><ul>
<li class="chapter" data-level="9.3.1" data-path="optimización-monte-carlo.html"><a href="optimización-monte-carlo.html#algoritmos-de-optimización-monte-carlo"><i class="fa fa-check"></i><b>9.3.1</b> Algoritmos de optimización Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="temple-simulado.html"><a href="temple-simulado.html"><i class="fa fa-check"></i><b>9.4</b> Temple simulado</a><ul>
<li class="chapter" data-level="9.4.1" data-path="temple-simulado.html"><a href="temple-simulado.html#algoritmo-1"><i class="fa fa-check"></i><b>9.4.1</b> Algoritmo:</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="algoritmos-genéticos.html"><a href="algoritmos-genéticos.html"><i class="fa fa-check"></i><b>9.5</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="técnicas-de-reducción-de-la-varianza.html"><a href="técnicas-de-reducción-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a><ul>
<li class="chapter" data-level="10.1" data-path="reducción-de-la-varianza.html"><a href="reducción-de-la-varianza.html"><i class="fa fa-check"></i><b>10.1</b> Reducción de la varianza</a></li>
<li class="chapter" data-level="10.2" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html"><i class="fa fa-check"></i><b>10.2</b> Variables antitéticas</a><ul>
<li class="chapter" data-level="10.2.1" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#ejemplo-integración-monte-carlo"><i class="fa fa-check"></i><b>10.2.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.2.2" data-path="variables-antitéticas.html"><a href="variables-antitéticas.html#generación-de-variables-antitéticas"><i class="fa fa-check"></i><b>10.2.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="estratificación.html"><a href="estratificación.html"><i class="fa fa-check"></i><b>10.3</b> Estratificación</a></li>
<li class="chapter" data-level="10.4" data-path="variables-de-control.html"><a href="variables-de-control.html"><i class="fa fa-check"></i><b>10.4</b> Variables de control</a></li>
<li class="chapter" data-level="10.5" data-path="números-aleatorios-comunes.html"><a href="números-aleatorios-comunes.html"><i class="fa fa-check"></i><b>10.5</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.6" data-path="ejercicios-fin-de-práctica.html"><a href="ejercicios-fin-de-práctica.html"><i class="fa fa-check"></i><b>10.6</b> Ejercicios fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a><ul>
<li class="chapter" data-level="" data-path="bibliografía-básica.html"><a href="bibliografía-básica.html"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html"><i class="fa fa-check"></i>Bibliografía complementaria</a><ul>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html#libros"><i class="fa fa-check"></i>Libros</a></li>
<li class="chapter" data-level="" data-path="bibliografía-complementaria.html"><a href="bibliografía-complementaria.html#artículos"><i class="fa fa-check"></i>Artículos</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>A</b> Enlaces</a></li>
<li class="chapter" data-level="B" data-path="gof-aleat.html"><a href="gof-aleat.html"><i class="fa fa-check"></i><b>B</b> Bondad de Ajuste y Aleatoriedad</a><ul>
<li class="chapter" data-level="B.1" data-path="gof.html"><a href="gof.html"><i class="fa fa-check"></i><b>B.1</b> Métodos de bondad de ajuste</a><ul>
<li class="chapter" data-level="B.1.1" data-path="gof.html"><a href="gof.html#histograma"><i class="fa fa-check"></i><b>B.1.1</b> Histograma</a></li>
<li class="chapter" data-level="B.1.2" data-path="gof.html"><a href="gof.html#empdistr"><i class="fa fa-check"></i><b>B.1.2</b> Función de distribución empírica</a></li>
<li class="chapter" data-level="B.1.3" data-path="gof.html"><a href="gof.html#gráficos-p-p-y-q-q"><i class="fa fa-check"></i><b>B.1.3</b> Gráficos P-P y Q-Q</a></li>
<li class="chapter" data-level="B.1.4" data-path="gof.html"><a href="gof.html#chi2test"><i class="fa fa-check"></i><b>B.1.4</b> Contraste ji-cuadrado de Pearson</a></li>
<li class="chapter" data-level="B.1.5" data-path="gof.html"><a href="gof.html#ks-test"><i class="fa fa-check"></i><b>B.1.5</b> Contraste de Kolmogorov-Smirnov</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html"><i class="fa fa-check"></i><b>B.2</b> Diagnosis de la independencia</a><ul>
<li class="chapter" data-level="B.2.1" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#métodos-para-detectar-dependencia"><i class="fa fa-check"></i><b>B.2.1</b> Métodos para detectar dependencia</a></li>
<li class="chapter" data-level="B.2.2" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#gráfico-secuencial"><i class="fa fa-check"></i><b>B.2.2</b> Gráfico secuencial</a></li>
<li class="chapter" data-level="B.2.3" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#gráfico-de-dispersion-retardado"><i class="fa fa-check"></i><b>B.2.3</b> Gráfico de dispersion retardado</a></li>
<li class="chapter" data-level="B.2.4" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#el-correlograma"><i class="fa fa-check"></i><b>B.2.4</b> El correlograma</a></li>
<li class="chapter" data-level="B.2.5" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#test-de-rachas"><i class="fa fa-check"></i><b>B.2.5</b> Test de rachas</a></li>
<li class="chapter" data-level="B.2.6" data-path="diagnosis-de-la-independencia.html"><a href="diagnosis-de-la-independencia.html#el-contraste-de-ljung-box"><i class="fa fa-check"></i><b>B.2.6</b> El contraste de Ljung-Box</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html"><i class="fa fa-check"></i><b>B.3</b> Contrastes específicos para generadores aleatorios</a><ul>
<li class="chapter" data-level="B.3.1" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-frecuencias"><i class="fa fa-check"></i><b>B.3.1</b> Contraste de frecuencias</a></li>
<li class="chapter" data-level="B.3.2" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#contraste-de-series"><i class="fa fa-check"></i><b>B.3.2</b> Contraste de series</a></li>
<li class="chapter" data-level="B.3.3" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-poker"><i class="fa fa-check"></i><b>B.3.3</b> El contraste del poker</a></li>
<li class="chapter" data-level="B.3.4" data-path="contrastes-específicos-para-generadores-aleatorios.html"><a href="contrastes-específicos-para-generadores-aleatorios.html#el-contraste-del-coleccionista"><i class="fa fa-check"></i><b>B.3.4</b> El contraste del coleccionista</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="int-num.html"><a href="int-num.html"><i class="fa fa-check"></i><b>C</b> Integración numérica</a><ul>
<li class="chapter" data-level="C.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html"><i class="fa fa-check"></i><b>C.1</b> Integración numérica unidimensional</a><ul>
<li class="chapter" data-level="C.1.1" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#método-del-trapezoide"><i class="fa fa-check"></i><b>C.1.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="C.1.2" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#regla-de-simpson"><i class="fa fa-check"></i><b>C.1.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="C.1.3" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>C.1.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="C.1.4" data-path="integración-numérica-unidimensional.html"><a href="integración-numérica-unidimensional.html#comandos-de-r"><i class="fa fa-check"></i><b>C.1.4</b> Comandos de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html"><i class="fa fa-check"></i><b>C.2</b> Integración numérica bidimensional</a><ul>
<li class="chapter" data-level="C.2.1" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#representación-gráfica"><i class="fa fa-check"></i><b>C.2.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="C.2.2" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#método-del-trapezoide-1"><i class="fa fa-check"></i><b>C.2.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="C.2.3" data-path="integración-numérica-bidimensional.html"><a href="integración-numérica-bidimensional.html#comandos-de-r-1"><i class="fa fa-check"></i><b>C.2.3</b> Comandos de <code>R</code></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulación Estadística</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="contrastes" class="section level2">
<h2><span class="header-section-number">8.3</span> Contrastes de hipótesis</h2>
<p>Ver <a href="https://rubenfcasal.github.io/book_remuestreo/practica2.html">Apéncide A</a> de Cao y Fernández-Casal (2019).</p>

<div class="exercise">
<span id="exr:ks-test-sim" class="exercise"><strong>Ejercicio 8.5  (Test de Kolmogorov-Smirnov)  </strong></span>
</div>

<p>En la Sección <a href="calgen.html#calgen">3.2</a> del Tema <a href="cap3.html#cap3">3</a> se propuso el análisis de la bondad de ajuste de un generador de números pseudo-aleatorios mediante el test de Kolmogorov-Smirnov (ver Sección <a href="gof.html#ks-test">B.1.5</a>). Sin embargo, si <span class="math inline">\(H_{0}\)</span> es compuesta (los parámetros desconocidos se estiman por máxima verosimilitud y se trabaja con <span class="math inline">\(\hat{F}_{0}\)</span>) los cuantiles de la distribución (asintótica) de <span class="math inline">\(D_{n}\)</span> pueden ser demasiado conservativos y sería preferible utilizar la distribución exacta.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Analizar el comportamiento del contraste de Kolmogorov-Smirnov para contrastar normalidad empleando repetidamente este test, considerando 1000 pruebas con muestras de tamaño 30 de una <span class="math inline">\(\mathcal{N}(0,1)\)</span>. Comparar gráficamente el ajuste de la distribución del <span class="math inline">\(p\)</span>-valor a la de referencia (estudiar el tamaño del contraste).</p>
<p>Valores iniciales:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">54321</span>)
nx &lt;-<span class="st"> </span><span class="dv">30</span>
mx &lt;-<span class="st"> </span><span class="dv">0</span>
sx &lt;-<span class="st"> </span><span class="dv">1</span>
nsim &lt;-<span class="st"> </span><span class="dv">1000</span>
estadistico &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)
pvalor &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)</code></pre></div>
<p>Realizar contrastes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(isim <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsim) {
  rx &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nx, mx, sx)
  tmp &lt;-<span class="st"> </span><span class="kw">ks.test</span>(rx, <span class="st">&quot;pnorm&quot;</span>, <span class="kw">mean</span>(rx), <span class="kw">sd</span>(rx))
  estadistico[isim] &lt;-<span class="st"> </span>tmp<span class="op">$</span>statistic
  pvalor[isim] &lt;-<span class="st"> </span>tmp<span class="op">$</span>p.value
}</code></pre></div>
<p>Proporción de rechazos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">{
  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Proporción de rechazos al 1% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre></div>
<pre><code>## 
## Proporción de rechazos al 1% = 0 
## Proporción de rechazos al 5% = 0 
## Proporción de rechazos al 10% = 0.001</code></pre>
<p>Análisis de los p-valores:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(pvalor, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">2</span>)   <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-27-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Distribución empírica</span>
<span class="kw">curve</span>(<span class="kw">ecdf</span>(pvalor)(x), <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, 
      <span class="dt">main =</span> <span class="st">&#39;Tamaño del contraste&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Proporción de rechazos&#39;</span>, 
      <span class="dt">xlab =</span> <span class="st">&#39;Nivel de significación&#39;)</span>
<span class="st">abline(a=0, b=1, lty=2)   # curve(punif(x, 0, 1), add = TRUE)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-27-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Repetir el apartado anterior considerando el test de Lilliefors (rutina <code>lillie.test</code> del paquete <code>nortest</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nortest, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Valores iniciales:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">54321</span>)
nx &lt;-<span class="st"> </span><span class="dv">30</span>
mx &lt;-<span class="st"> </span><span class="dv">0</span>
sx &lt;-<span class="st"> </span><span class="dv">1</span>
nsim &lt;-<span class="st"> </span><span class="dv">1000</span>
estadistico &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)
pvalor &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)</code></pre></div>
<p>Realizar contrastes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(isim <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsim) {
  rx &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nx, mx, sx)
  <span class="co"># tmp &lt;- ks.test(rx, &quot;pnorm&quot;, mean(rx), sd(rx))</span>
  tmp &lt;-<span class="st"> </span><span class="kw">lillie.test</span>(rx)
  estadistico[isim] &lt;-<span class="st"> </span>tmp<span class="op">$</span>statistic
  pvalor[isim] &lt;-<span class="st"> </span>tmp<span class="op">$</span>p.value
}</code></pre></div>
<p>Proporción de rechazos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">{
  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Proporción de rechazos al 1% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre></div>
<pre><code>## 
## Proporción de rechazos al 1% = 0.01 
## Proporción de rechazos al 5% = 0.044 
## Proporción de rechazos al 10% = 0.089</code></pre>
<p>Análisis de los p-valores:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(pvalor, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">2</span>)   <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-32-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Distribución empírica</span>
<span class="kw">curve</span>(<span class="kw">ecdf</span>(pvalor)(x), <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">main =</span> <span class="st">&#39;Tamaño del contraste&#39;</span>, 
      <span class="dt">ylab =</span> <span class="st">&#39;Proporción de rechazos&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;Nivel de significación&#39;)</span>
<span class="st">abline(a=0, b=1, lty=2)   # curve(punif(x, 0, 1), add = TRUE)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-32-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Repetir el apartado a) contrastando una distribución exponencial y considerando 500 pruebas con muestras de tamaño 30 de una <span class="math inline">\(Exp(1)\)</span>.</p>
<p>Valores iniciales:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">54321</span>)
nx &lt;-<span class="st"> </span><span class="dv">30</span>
ratex &lt;-<span class="st"> </span><span class="dv">1</span>
nsim &lt;-<span class="st"> </span><span class="dv">500</span>
estadistico &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)
pvalor &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)</code></pre></div>
<p>Realizar contrastes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(isim <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsim) {
  rx &lt;-<span class="st"> </span><span class="kw">rexp</span>(nx, ratex)
  tmp &lt;-<span class="st"> </span><span class="kw">ks.test</span>(rx, <span class="st">&quot;pexp&quot;</span>, <span class="dv">1</span><span class="op">/</span><span class="kw">mean</span>(rx))
  estadistico[isim] &lt;-<span class="st"> </span>tmp<span class="op">$</span>statistic
  pvalor[isim] &lt;-<span class="st"> </span>tmp<span class="op">$</span>p.value
}</code></pre></div>
<p>Proporción de rechazos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">{
  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Proporción de rechazos al 1% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre></div>
<pre><code>## 
## Proporción de rechazos al 1% = 0 
## Proporción de rechazos al 5% = 0.004 
## Proporción de rechazos al 10% = 0.008</code></pre>
<p>Análisis de los p-valores:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(pvalor, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">2</span>)   <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-36-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Distribución empírica</span>
<span class="kw">curve</span>(<span class="kw">ecdf</span>(pvalor)(x), <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, 
      <span class="dt">main =</span> <span class="st">&#39;Tamaño del contraste&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Proporción de rechazos&#39;</span>, 
      <span class="dt">xlab =</span> <span class="st">&#39;Nivel de significación&#39;)</span>
<span class="st">abline(a=0, b=1, lty=2)   # curve(punif(x, 0, 1), add = TRUE) </span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-36-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Diseñar una rutina que permita realizar el contraste KS de bondad de ajuste de una variable exponencial aproximando el <span class="math inline">\(p\)</span>-valor por simulación y repetir el apartado anterior empleando esta rutina.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ks.exp.sim &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">nsim =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">3</span>) {
  DNAME &lt;-<span class="st"> </span><span class="kw">deparse</span>(<span class="kw">substitute</span>(x))
  METHOD &lt;-<span class="st"> &quot;Kolmogorov-Smirnov Test of pexp by simulation&quot;</span> 
  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)
  RATE &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="kw">mean</span>(x)
  ks.exp.stat &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">rate=</span><span class="dv">1</span><span class="op">/</span><span class="kw">mean</span>(x)) {
    DMinus &lt;-<span class="st"> </span><span class="kw">pexp</span>(<span class="kw">sort</span>(x), <span class="dt">rate=</span>rate) <span class="op">-</span><span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))<span class="op">/</span>n
    DPlus &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>n <span class="op">-</span><span class="st"> </span>DMinus
    Dn =<span class="st"> </span><span class="kw">max</span>(<span class="kw">c</span>(DMinus, DPlus))
  }  
  STATISTIC &lt;-<span class="st"> </span><span class="kw">ks.exp.stat</span>(x, <span class="dt">rate =</span> RATE) 
  <span class="kw">names</span>(STATISTIC) &lt;-<span class="st"> &quot;Dn&quot;</span>
  <span class="co"># PVAL &lt;- 0</span>
  <span class="co"># for(i in 1:nsim) {</span>
  <span class="co">#   rx &lt;- rexp(n, rate = RATE)</span>
  <span class="co">#   if (STATISTIC &lt;= ks.exp.stat(rx)) PVAL &lt;- PVAL+1</span>
  <span class="co"># }</span>
  <span class="co"># PVAL &lt;- PVAL/nsim</span>
  <span class="co"># PVAL &lt;- PVAL/(nsim + 1)</span>
  <span class="co"># PVAL &lt;- (PVAL + 1)/(nsim + 2)</span>
  rx &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rexp</span>(n<span class="op">*</span>nsim, <span class="dt">rate =</span> RATE), <span class="dt">ncol=</span>n)
  PVAL &lt;-<span class="st"> </span><span class="kw">mean</span>(STATISTIC <span class="op">&lt;=</span><span class="st"> </span><span class="kw">apply</span>(rx, <span class="dv">1</span>, ks.exp.stat))
  <span class="kw">return</span>(<span class="kw">structure</span>(<span class="kw">list</span>(<span class="dt">statistic =</span> STATISTIC, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, 
                   <span class="dt">p.value =</span> PVAL, <span class="dt">method =</span> METHOD, <span class="dt">data.name =</span> DNAME), 
                   <span class="dt">class =</span> <span class="st">&quot;htest&quot;</span>))
}</code></pre></div>
<p>Simulación:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">54321</span>)
nx &lt;-<span class="st"> </span><span class="dv">30</span>
ratex &lt;-<span class="st"> </span><span class="dv">1</span>
nsim &lt;-<span class="st"> </span><span class="dv">500</span>
estadistico &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)
pvalor &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)</code></pre></div>
<p>Realizar contrastes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(isim <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsim) {
  rx &lt;-<span class="st"> </span><span class="kw">rexp</span>(nx, ratex)
  <span class="co"># tmp &lt;- ks.test(rx, &quot;pexp&quot;, 1/mean(rx))</span>
  tmp &lt;-<span class="st"> </span><span class="kw">ks.exp.sim</span>(rx, <span class="dt">nsim =</span> <span class="dv">200</span>)
  estadistico[isim] &lt;-<span class="st"> </span>tmp<span class="op">$</span>statistic
  pvalor[isim] &lt;-<span class="st"> </span>tmp<span class="op">$</span>p.value
}</code></pre></div>
<p>Proporción de rechazos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">{
  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Proporción de rechazos al 1% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
  <span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="kw">mean</span>(pvalor <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre></div>
<pre><code>## 
## Proporción de rechazos al 1% = 0.008 
## Proporción de rechazos al 5% = 0.058 
## Proporción de rechazos al 10% = 0.106</code></pre>
<p>Análisis de los p-valores:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(pvalor, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">2</span>)   <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-40-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Distribución empírica</span>
<span class="kw">curve</span>(<span class="kw">ecdf</span>(pvalor)(x), <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, 
      <span class="dt">main =</span> <span class="st">&#39;Tamaño del contraste&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Proporción de rechazos&#39;</span>, 
      <span class="dt">xlab =</span> <span class="st">&#39;Nivel de significación&#39;)</span>
<span class="st">abline(a=0, b=1, lty=2)   # curve(punif(x, 0, 1), add = TRUE) </span></code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/unnamed-chunk-40-2.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Estudiar la potencia de los contrastes de los apartados c) y d), considerando como alternativa una distribución Weibull.</p>
<p>La distribución exponencial es un caso particular de la Weibull: <code>dexp(x, ratex) == dweibull(x, 1, 1/ratex)</code>. Estudiamos lo que ocurre al desplazar <code>dweibull(x, shape, 1/ratex)</code> con <code>0 &lt; shape &lt; 2</code>.</p>
<p>CUIDADO: las simulaciones pueden requerir de mucho tiempo de computación (consideramos valores pequeños de <code>nx</code> y <code>nsim</code> en datos y en <code>ks.exp.sim</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">54321</span>)
nx &lt;-<span class="st"> </span><span class="dv">20</span>
ratex &lt;-<span class="st"> </span><span class="dv">1</span>    <span class="co"># Puede ser interesante representarlo variando rate</span>
nsim &lt;-<span class="st"> </span><span class="dv">200</span>
alfa &lt;-<span class="st"> </span><span class="fl">0.1</span>   <span class="co"># Puede ser interesante representarlo variando alfa</span>


shapex &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.25</span>, <span class="fl">1.75</span>, <span class="dt">len=</span><span class="dv">21</span>)
preject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(shapex)) <span class="co"># Porporciones de rechazos con ks.test</span>
ks.test.p &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">ks.test</span>(x, <span class="st">&quot;pexp&quot;</span>, <span class="dv">1</span><span class="op">/</span><span class="kw">mean</span>(x))<span class="op">$</span>p.value
preject2 &lt;-<span class="st"> </span>preject <span class="co"># Porporciones de rechazos con ks.exp.sim</span>
ks.exp.sim.p &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">ks.exp.sim</span>(x, <span class="dv">200</span>)<span class="op">$</span>p.value

<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(shapex)) { 
  rx &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rweibull</span>(nx<span class="op">*</span>nsim, <span class="dt">shape =</span> shapex[i], <span class="dt">scale =</span> <span class="dv">1</span><span class="op">/</span>ratex), <span class="dt">ncol=</span>nx)
  preject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>( <span class="kw">apply</span>(rx, <span class="dv">1</span>, ks.test.p) <span class="op">&lt;=</span><span class="st"> </span>alfa )
  preject2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>( <span class="kw">apply</span>(rx, <span class="dv">1</span>, ks.exp.sim.p) <span class="op">&lt;=</span><span class="st"> </span>alfa )
}

<span class="kw">plot</span>(shapex, preject, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;Potencia del contraste ( alfa =&quot;</span>, alfa, <span class="st">&quot;)&quot;</span>), 
     <span class="dt">xlab =</span> <span class="st">&quot;shape&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Proporción de rechazos&quot;</span>)
<span class="kw">lines</span>(shapex, preject2, <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> alfa, <span class="dt">v =</span> <span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="08-Aplicaciones_Inferencia_files/figure-html/potencia-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
</ol>
<p>El estadístico de Kolmogorov-Smirnov <code>Dn = max(c(DMinus, DPlus))</code> tiene ventajas desde el punto de vista teórico, pero puede no ser muy potente para detectar diferencias entre la distribución bajo la hipótesis nula y la distribución de los datos. La ventaja de la aproximación por simulación es que no estamos atados a resultados teóricos y podemos emplear el estadístico que se considere oportuno (la principal desventaja es el tiempo de computación). Por ejemplo, podríamos pensar en utilizar como estadístico la suma de los errores en valor absoluto del correspondiente gráfico PP, y solo habría que cambiar el estadístico <code>Dn</code> en la función <code>ks.exp.sim</code> por <code>Dn = sum(abs( (1:n - 0.5)/n -  pexp(sort(x), rate=rate) ))</code>.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intervalos-de-confianza.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparación-de-estimadores.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/simbook/edit/master/08-Aplicaciones_Inferencia.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Simulacion.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
